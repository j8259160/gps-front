(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1368f4d2"],{"0595":function(t,e,i){"use strict";var a=function(){var t=this,e=t._self._c;return e("div",{staticClass:"quick-time-range"},[e("div",{staticClass:"quick-time-range-wrapper"},t._l(t.list,(function(i){return e("div",{key:i.type,style:{color:i.type==t.type?"#409EFF":""},on:{click:function(e){return t.selectDate(i.type)}}},[t._v(t._s(i.label))])})),0),e("div",{staticClass:"quick-time-range-space"}),e("div",{staticClass:"quick-time-range-btn",on:{click:function(e){t.isCollapse=!t.isCollapse}}},[t.isCollapse?e("i",{staticClass:"el-icon-arrow-right"}):e("i",{staticClass:"el-icon-arrow-left"})])])},r=[],s=i("5101"),o={name:"QuickTimeRange",props:{value:{type:Array,default:function(){return[]}},dateType:{type:String,default:"date"}},watch:{isCollapse:function(){this.setList()}},data:function(){return{isCollapse:!0,type:0,list:[]}},methods:{setList:function(){this.isCollapse?this.list=[{label:this.$t("reportForm.toDay"),type:0},{label:this.$t("reportForm.yesterDay"),type:1},{label:this.$t("reportForm.recent3Days"),type:3}]:this.list=[{label:this.$t("reportForm.recent7Days"),type:7},{label:this.$t("reportForm.recent10Days"),type:10},{label:this.$t("reportForm.recent30Days"),type:30}]},selectDate:function(t){var e="datetimerange"==this.dateType,i=[],a=new Date,r=new Date;switch(e&&(a=new Date(s["a"].format(new Date,"yyyy-MM-dd")+" 00:00:00"),r=new Date(s["a"].format(new Date,"yyyy-MM-dd")+" 23:59:59")),t){case 0:i=[new Date(s["a"].format(a,"yyyy-MM-dd")+" 00:00:00"),new Date(s["a"].format(r,"yyyy-MM-dd")+" 23:59:59")];break;case 1:a.setTime(a.getTime()-864e5),r.setTime(r.getTime()-864e5),i=[a,r];break;case 3:a.setTime(a.getTime()-2592e5),i=[a,r];break;case 7:a.setTime(a.getTime()-6048e5),i=[a,r];break;case 10:a.setTime(a.getTime()-864e6),i=[a,r];break;case 30:a.setTime(a.getTime()-2592e6),i=[a,r];break}this.type=t,this.$emit("input",i)}},mounted:function(){var t=this;this.$nextTick((function(){t.setList()}))}},l=o,n=(i("8d09"),i("2877")),d=Object(n["a"])(l,a,r,!1,null,null,null);e["a"]=d.exports},"0cfa":function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t._self._c;return e("div",{staticClass:"report-form full mileage-oil"},[e("div",{staticClass:"report-form-inner"},[e("div",{staticClass:"report-form-inner-header",staticStyle:{height:"35px"}},[e("div",{staticClass:"f_left"},[e("SingleChoiceVehicle",{attrs:{placeholder:this.$t("tips.selectSingleDevice"),width:"230px"},model:{value:t.deviceid,callback:function(e){t.deviceid=e},expression:"deviceid"}})],1),e("div",{staticClass:"f_left"},[e("SelectDate",{model:{value:t.dateRange,callback:function(e){t.dateRange=e},expression:"dateRange"}})],1),e("div",{staticClass:"f_left"},[e("QuickTimeRange",{model:{value:t.dateRange,callback:function(e){t.dateRange=e},expression:"dateRange"}})],1),e("div",{staticClass:"f_left",staticStyle:{width:"164px"}},[e("LabelWrap",{attrs:{label:t.$t("reportForm.aggregateRange")}},[e("el-select",{model:{value:t.intervalm,callback:function(e){t.intervalm=e},expression:"intervalm"}},t._l(t.mlList,(function(t){return e("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1)],1),e("div",{staticClass:"f_left"},[e("el-button",{attrs:{loading:t.loading,type:"primary"},on:{click:t.handleQuery}},[t._v(t._s(t.$t("common.query")))])],1),e("div",{staticClass:"f_left"},[e("el-button",{attrs:{type:"primary",loading:t.exportLoading1},on:{click:t.exportData}},[t._v(t._s(t.$t("common.export")))])],1)]),e("div",{staticClass:"mileage-oil-echarts"},[e("TimeOilEcharts",{ref:"echartsIns",on:{"legend-changed":t.onLegendChanged,"select-index":t.scrollToRow,onClickMarkPoint:t.onClickMarkPoint}})],1),e("div",{staticClass:"tabs-warpper"},[e("el-tabs",{model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[e("el-tab-pane",{attrs:{label:t.$t("reportForm.addOrLeakOilList")+"(".concat(t.totalList.length,")"),name:"tabTotal"}}),e("el-tab-pane",{attrs:{label:t.$t("reportForm.oilRecordList")+"(".concat(t.detailsList.length,")"),name:"details"}})],1),e("div",{staticClass:"tableTitle"},[e("b",{domProps:{textContent:t._s(t.tableTitle)}})]),e("div",{staticClass:"batch-time"},[e("div",{directives:[{name:"show",rawName:"v-show",value:!t.isDisabledOilRecords,expression:"!isDisabledOilRecords"}]},[e("el-button",{attrs:{type:"primary",size:"mini"},on:{click:t.addOilRecord}},[t._v(t._s(t.$t("common.add")))])],1)])],1),e("div",{staticClass:"report-form-inner-content",staticStyle:{top:"360px"}},[e("div",{style:t.statisticsStyle},[e("vxe-table",{ref:"oilxTable",staticClass:"mytable-scrollbar",attrs:{"edit-config":{trigger:"manual",mode:"row",showIcon:!1,autoClear:!1},"menu-config":t.tableMenu,"auto-resize":"","keep-source":"","row-class-name":t.rowClassName,"cell-class-name":t.cellClassName,"highlight-current-row":"",border:"",resizable:"","show-overflow":"","highlight-hover-row":"",size:"mini",height:"auto",data:t.totalList},on:{"menu-click":t.handleClickTableMenu,"current-change":t.handleCurrentRow}},[e("vxe-table-column",{attrs:{field:"action",title:t.$t("reportForm.action"),width:"100"},scopedSlots:t._u([{key:"default",fn:function(i){return[t.$refs.oilxTable.isEditByRow(i.row)?e("div",[e("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(e){return t.saveRowEvent(i.row)}}},[t._v(t._s(t.$t("common.save")))]),e("span",{staticStyle:{padding:"0px 5px"}}),e("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(e){return t.cancelRowEvent(i.row)}}},[t._v(t._s(t.$t("common.cancel")))])],1):e("div",[t.isDisabledOilRecords?t._e():e("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(e){return t.editRowEvent(i.row)}}},[t._v(t._s(t.$t("common.edit")))]),e("span",{staticStyle:{padding:"0px 5px"}}),e("el-popconfirm",{attrs:{placement:"top",icon:"el-icon-info","icon-color":"red",title:t.$t("tips.confirmDelete"),"confirm-button-text":t.$t("common.confirm"),"cancel-button-text":t.$t("common.cancel")},on:{confirm:function(e){return t.delOilRecord(i)}}},[e("span",{attrs:{slot:"reference"},slot:"reference"},[e("el-button",{attrs:{type:"text",size:"mini"}},[t._v(t._s(t.$t("common.delete")))])],1)])],1)]}}])}),e("vxe-table-column",{attrs:{type:"seq",width:"60",title:t.$t("reportForm.index")}}),e("vxe-table-column",{attrs:{field:"oilindex",title:t.$t("reportForm.oilIndex"),"edit-render":{name:"$select",options:t.oilIndexList,props:{multiple:!1}},width:"100",sortable:""}}),e("vxe-table-column",{attrs:{field:"oilstateStr",title:t.$t("reportForm.status"),width:"100",sortable:""}}),e("vxe-table-column",{attrs:{field:"oilVolume",title:t.$t("reportForm.oil"),formatter:t.numberToFixed2,align:"right",width:"100",sortable:""}}),e("vxe-table-column",{attrs:{field:"soil100",title:t.$t("reportForm.startOil"),"title-help":{message:t.$t("tips.clickDevicenameEdit"),icon:"el-icon-edit"},formatter:t.numberToFixed2,align:"right",width:"120","edit-render":{},sortable:""},scopedSlots:t._u([{key:"edit",fn:function(i){var a=i.row;return[e("vxe-input",{attrs:{type:"number"},model:{value:a.soil100,callback:function(e){t.$set(a,"soil100",e)},expression:"row.soil100"}})]}}])}),e("vxe-table-column",{attrs:{field:"eoil100",title:t.$t("reportForm.endOil"),"title-help":{message:t.$t("tips.clickDevicenameEdit"),icon:"el-icon-edit"},formatter:t.numberToFixed2,align:"right",width:"120","edit-render":{},sortable:""},scopedSlots:t._u([{key:"edit",fn:function(i){var a=i.row;return[e("vxe-input",{attrs:{type:"number"},model:{value:a.eoil100,callback:function(e){t.$set(a,"eoil100",e)},expression:"row.eoil100"}})]}}])}),e("vxe-table-column",{attrs:{field:"begintimeStr",title:t.$t("reportForm.startTime"),"title-help":{message:t.$t("tips.clickDevicenameEdit"),icon:"el-icon-edit"},"edit-render":{},width:"140",sortable:""},scopedSlots:t._u([{key:"edit",fn:function(i){var a=i.row;return[e("vxe-input",{model:{value:a.begintimeStr,callback:function(e){t.$set(a,"begintimeStr",e)},expression:"row.begintimeStr"}})]}}])}),e("vxe-table-column",{attrs:{field:"endtimeStr",title:t.$t("reportForm.endTime"),"title-help":{message:t.$t("tips.clickDevicenameEdit"),icon:"el-icon-edit"},"edit-render":{},width:"140",sortable:""},scopedSlots:t._u([{key:"edit",fn:function(i){var a=i.row;return[e("vxe-input",{model:{value:a.endtimeStr,callback:function(e){t.$set(a,"endtimeStr",e)},expression:"row.endtimeStr"}})]}}])}),e("vxe-table-column",{attrs:{field:"marker",title:t.$t("reportForm.remarks"),"title-help":{message:t.$t("tips.clickDevicenameEdit"),icon:"el-icon-edit"},"edit-render":{name:"$input",props:{type:"string"}},width:"160",sortable:""}}),e("vxe-table-column",{attrs:{field:"address",title:t.$t("reportForm.address"),width:"220",sortable:""},scopedSlots:t._u([{key:"default",fn:function(i){return[e("span",{staticStyle:{"text-decoration":"underline",cursor:"pointer",color:"#388cfe"},domProps:{textContent:t._s(i.row.address)},on:{click:function(e){return t.queryTracks(i.row)}}})]}}])}),e("vxe-table-column",{attrs:{field:"distance",title:t.$t("reportForm.distance")+t.distanceUnit,width:"110",sortable:""}}),e("vxe-table-column",{attrs:{field:"avgspeed",title:t.$t("reportForm.avgSpeed")+t.speedUnit,formatter:t.numberToFixed2,align:"right",width:"120",sortable:""}}),e("vxe-table-column",{attrs:{field:"durationStr",title:t.$t("reportForm.duration"),formatter:t.numberToFixed2,align:"right",width:"100",sortable:""}}),e("vxe-table-column",{attrs:{field:"threshold",title:t.$t("reportForm.threshold"),width:"100",sortable:""}})],1)],1),e("div",{style:t.detailsStyle},[e("vxe-table",{ref:"xTable",attrs:{"menu-config":t.tableMenu,border:"",resizable:"","auto-resize":"","show-overflow":"","highlight-current-row":"","highlight-hover-row":"",size:"mini",height:"auto",data:t.detailsList},on:{"menu-click":t.handleClickTableMenu,"cell-click":t.cellclick}},[e("vxe-table-column",{attrs:{type:"seq",width:"60",title:t.$t("reportForm.index")}}),e("vxe-table-column",{attrs:{field:"updatetimeStr",title:t.$t("reportForm.updatetimeStr"),width:"150",sortable:""}}),e("vxe-table-column",{attrs:{field:"arrivedtimeStr",title:t.$t("reportForm.arrivedtimeStr"),width:"150",sortable:""}}),t._l(t.tableColumn,(function(i,a){return e("vxe-table-column",t._b({key:a,attrs:{formatter:t.numberToFixed2,align:"right",sortable:""}},"vxe-table-column",i,!1))})),e("vxe-table-column",{attrs:{field:"reissue",title:t.$t("reportForm.reissue"),width:"80",sortable:""}}),e("vxe-table-column",{attrs:{field:"status",title:t.$t("reportForm.status"),width:"200",sortable:""}}),e("vxe-table-column",{attrs:{field:"lonLat",title:t.$t("reportForm.lonLat"),width:"140",sortable:""}}),e("vxe-table-column",{attrs:{title:t.$t("reportForm.address"),width:"240"},scopedSlots:t._u([{key:"default",fn:function(i){var a=i.row;return[a.address?e("div",[t._v(t._s(a.address))]):e("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){return t.queryAddress(a)}}},[t._v(t._s(t.$t("reportForm.getAddress")))])]}}])})],2)],1)])]),e("vxe-modal",{attrs:{title:t.$t("reportForm.seeMap"),className:"modal-padding0",value:t.dialogMap,width:"500"},on:{hide:function(e){t.dialogMap=!1},close:function(e){t.dialogMap=!1}}},[e("div",{staticStyle:{width:"100%",height:"400px"}},[e("ReportMap",{ref:"mapIns"})],1)])],1)},r=[],s=i("c7eb"),o=i("1da1"),l=i("5530"),n=(i("99af"),i("14d9"),i("e9c4"),i("a9e3"),i("b680"),i("b64b"),i("d3b7"),i("159b"),i("4795"),i("2f62")),d=i("d03a"),c=i("d462"),m=i("57c9"),h=i("80f4"),u=i("201d"),p=i("c1f2"),b=i("1c31"),f=i("5101"),v=i("6e52"),g=i("c276"),$=i("7cf8"),y=i("a05b"),x={name:"mileageOil",mixins:[y["a"]],data:function(){var t=this.$t("common.metre");return{tableTitle:"",deviceid:"",loading:!1,exportLoading1:!1,dialogMap:!1,activeName:"tabTotal",dateRange:[new Date,new Date],totalList:[],detailsList:[],oilIndexList:[{label:this.$t("reportForm.totalDriving"),value:0},{label:this.$t("reportForm.tank1"),value:1},{label:this.$t("reportForm.tank2"),value:2},{label:this.$t("reportForm.tank3"),value:3},{label:this.$t("reportForm.tank4"),value:4},{label:this.$t("reportForm.totalNotRun"),value:99}],oilStateList:[{label:this.$t("reportForm.refuel"),value:1},{label:this.$t("reportForm.leak"),value:-1}],intervalm:100,mlList:[{label:"1"+t,value:1},{label:"100"+t,value:100},{label:"1000"+t,value:1e3},{label:"5000"+t,value:5e3},{label:"10000"+t,value:1e4}],tableColumn:[]}},components:{SingleChoiceVehicle:d["a"],SelectDate:c["a"],QuickTimeRange:m["a"],TimeOilEcharts:p["a"],ReportMap:h["a"],LabelWrap:u["a"]},computed:Object(l["a"])(Object(l["a"])({},Object(n["b"])(["isZh","singleDeviceid","isDisabledOilRecords","distanceUnit","speedUnit"])),{},{statisticsStyle:function(){return{zIndex:"tabTotal"==this.activeName?999:0}},detailsStyle:function(){return{zIndex:"details"==this.activeName?999:0}}}),watch:{dateRange:function(){this.loading||this.handleQuery()},deviceid:function(t){this.setSingleDeviceid(t)}},methods:Object(l["a"])(Object(l["a"])({},Object(n["c"])(["setSingleDeviceid"])),{},{numberToFixed2:g["qb"],cellClassName:function(t){var e=t.row,i=t.column;return"oilstate"===i.property&&1!=e.oilstate?"cell-color-red":""},queryAddress:function(t){var e=Object(g["Vb"])(t.callat),i=Object(g["Vb"])(t.callon),a=[{lat:e,lon:i}];Object($["v"])(a).then((function(e){var i=e.points;if(i.length>0){var a=i[0],r=a.address,s=a.status;0==s&&null!=r&&(Object(g["rb"])(t,r),t.address=r)}}))},scrollToRow:function(t){var e=t.rowIndex,i=this.detailsList[this.detailsList.length-1-e];this.$refs.xTable.setCurrentRow(i),this.$refs.xTable.scrollToRow(i,null),this.begintimeStr=i.updatetimeStr,this.oilVolume=i.totalad},onClickMarkPoint:function(t){this.handleCurrentRow({row:t}),this.$refs.oilxTable.setCurrentRow(t),this.$refs.oilxTable.scrollToRow(t,null)},handleCurrentRow:function(t){var e=t.row;this.totalList.forEach((function(t){t.isSelected=!1})),e.isSelected=!0},rowClassName:function(t){var e=t.row;t.rowIndex;return e.isSelected?"row--current":1==e.maunedit?"row-yellow":""},cellclick:function(t){var e=t.row,i=t.rowIndex,a=e.updatetimeStr;this.$refs.echartsIns.chartsIns.setOption({xAxis:{axisPointer:{value:a}}});var r=i;r>0&&this.$refs.echartsIns.chartsIns.dispatchAction({type:"showTip",seriesIndex:2,dataIndex:r})},onLegendChanged:function(t){var e=this.$t("reportForm.speed"),i=this.$t("reportForm.mileage"),a=this.$t("reportForm.totalOil"),r=this.$t("reportForm.notRunTotalad"),s=this.$t("reportForm.oil1"),o=this.$t("reportForm.oil2"),l=this.$t("reportForm.oil3"),n=this.$t("reportForm.oil4"),d=this.$t("reportForm.srcad0"),c=this.$t("reportForm.srcad1"),m=this.$t("reportForm.srcad2"),h=this.$t("reportForm.srcad3"),u=this.$t("reportForm.altitude"),p=this.$t("reportForm.voltage"),b=[];for(var f in t){var v=t[f];if(v)switch(f){case e:b.push({field:"speed",title:this.$t("reportForm.speed")+this.speedUnit,width:120});break;case i:b.push({field:"totalMileage",title:this.$t("reportForm.totalMileage")+this.distanceUnit,width:130});break;case a:b.push({field:"totalad",title:this.$t("reportForm.totalOil"),width:100});break;case r:b.push({field:"totalnotrunningad",title:this.$t("reportForm.notRunTotalad"),width:120});break;case s:b.push({field:"ad0",title:this.$t("reportForm.oil1"),width:80});break;case o:b.push({field:"ad1",title:this.$t("reportForm.oil2"),width:80});break;case l:b.push({field:"ad2",title:this.$t("reportForm.oil3"),width:80});break;case n:b.push({field:"ad3",title:this.$t("reportForm.oil4"),width:80});break;case d:b.push({field:"srcad0",title:this.$t("reportForm.srcad0"),width:80});break;case c:b.push({field:"srcad1",title:this.$t("reportForm.srcad1"),width:80});break;case m:b.push({field:"srcad2",title:this.$t("reportForm.srcad2"),width:80});break;case h:b.push({field:"srcad3",title:this.$t("reportForm.srcad3"),width:80});break;case u:b.push({field:"altitude",title:this.$t("reportForm.altitude"),width:80});break;case p:b.push({field:"voltage",title:this.$t("reportForm.voltage"),width:80});break}}this.tableColumn=b},addOilRecord:function(){var t=this,e=this.deviceid,i=this.dateRange;if(""!=e)if(0!=i.length){var a=f["a"].format(i[0],"yyyy-MM-dd"),r={deviceid:e,begintime:new Date("".concat(a," 08:00:00")).getTime(),endtime:new Date("".concat(a," 08:10:00")).getTime()};Object(b["a"])(r).then((function(i){var a=i.status,r=i.oilRecord;if(0==a&&r){var s=v["a"].deviceInfos[e].deviceid;r.devicename=s,r.begintimeStr=f["a"].longToLocalDateTimeStr(r.begintime),r.endtimeStr=f["a"].longToLocalDateTimeStr(r.endtime),r.editting=!1,r.saving=!1,r.durationStr=Number((r.duration/1e3/3600).toFixed(2)),r.address="",r.oilVolume=Math.abs(r.eoil-r.soil).toFixed(2),r.isSelected=!1,t.totalList.push(r)}}))}else this.$XModal.message({message:this.$t("tips.selectTime"),status:"error",zIndex:9999});else this.$XModal.message({message:this.$t("tips.selectDevice"),status:"error",zIndex:9999})},delOilRecord:function(t){var e=this,i=t.rowIndex,a=t.row;Object(b["b"])(a).then((function(t){var a=t.status;0==a?(e.$delete(e.totalList,i),e.$XModal.message({message:e.$t("tips.deleteSucc"),status:"success",zIndex:9999})):e.$XModal.message({message:e.$t("tips.recordInUse"),status:"error",zIndex:9999})}))},queryTracks:function(t){var e=this;this.dialogMap=!0;var i=f["a"].longToLocalDateTimeStr(t.begintime-6e5),a=f["a"].longToLocalDateTimeStr(t.endtime+6e5),r={deviceid:t.deviceid,begintime:i,endtime:a,timezone:f["a"].getOffset()};Object($["Z"])(r).then((function(t){var i=t.records;setTimeout((function(){i?e.$refs.mapIns.markersAndLineLayerToMap(i):e.$refs.mapIns.markersAndLineLayerToMap([])}),300)}))},handleQuery:function(){var t=this;return Object(o["a"])(Object(s["a"])().mark((function e(){var i,a,r,o,l,n,d,c,m,h,u,p,$;return Object(s["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(i=t.isZh,a=t.deviceid,r=t.dateRange,""!=a){e.next=6;break}return t.$XModal.message({message:t.$t("tips.selectDevice"),status:"error",zIndex:9999}),e.abrupt("return");case 6:if(0!=r.length){e.next=9;break}return t.$XModal.message({message:t.$t("tips.selectTime"),status:"error",zIndex:9999}),e.abrupt("return");case 9:return t.loading=!0,e.next=12,t.queryOilRecords();case 12:o=e.sent,l=o.records,n=o.addressmap,d=l[0],c=[],d&&(m=d.deviceid,h=d.records,c=t.getOilRecordsList(m,h,n)),t.totalList=c,u=f["a"].format(r[0],"yyyy-MM-dd"),p=f["a"].format(r[1],"yyyy-MM-dd"),$={startday:u,endday:p,offset:f["a"].getOffset(),devices:[a],intervalm:t.intervalm},t.tableTitle=v["a"].getDeviceNameByDeviceId(a)+" - "+a,Object(b["ab"])($).then((function(e){var a=e.records;t.loading=!1;var r=a[0],s=[];if(r&&r.records){var o=r.deviceid,l=v["a"].deviceInfos[o].devicename,n=r.records;n.forEach((function(e){var a=Object(g["I"])(e);e.devicename=l,e.deviceid=o,e.totalad=e.totalad/100,e.totalnotrunningad=e.totalnotrunningad/100,e.updatetimeStr=f["a"].longToLocalDateTimeStr(e.updatetime),e.arrivedtimeStr=f["a"].longToLocalDateTimeStr(e.arrivedtime),e.reissue=0==e.reissue?t.$t("header.no"):t.$t("header.yes"),e.status=i?e.strstatus:e.strstatusen,e.speed=Object(g["e"])(e.speed),e.totalMileage=Object(g["d"])(e.totaldistance),e.lonLat="".concat(e.callon,",").concat(e.callat),e.ad0=e.ad0/100,e.ad1=e.ad1/100,e.ad2=e.ad2/100,e.ad3=e.ad3/100,e.address=a,s.push(e)}))}t.detailsList=s,t.$refs.echartsIns.updateChartsOption(s,t.totalList)}));case 23:case"end":return e.stop()}}),e)})))()},queryOilRecords:function(){var t=this.deviceid,e=this.dateRange;if(""!=t){if(0!=e.length){var i=f["a"].format(e[0],"yyyy-MM-dd"),a=f["a"].format(e[1],"yyyy-MM-dd"),r={startday:i,endday:a,offset:f["a"].getOffset(),devices:[t],oilstate:99,oilindex:0};return Object(b["db"])(r)}this.$XModal.message({message:this.$t("tips.selectTime"),status:"error",zIndex:9999})}else this.$XModal.message({message:this.$t("tips.selectDevice"),status:"error",zIndex:9999})},getOilRecordsList:function(t,e,i){var a=this,r=[],s=v["a"].deviceInfos[t].devicename;return e.forEach((function(e){var o=e.oilstate;-1!=o&&1!=o||(e.devicename=s||t,e.begintimeStr=f["a"].longToLocalDateTimeStr(e.begintime),e.endtimeStr=f["a"].longToLocalDateTimeStr(e.endtime),e.eoil100=e.eoil/100,e.soil100=e.soil/100,1==e.oilstate?e.oilstateStr=a.$t("reportForm.refuel"):e.oilstateStr=a.$t("reportForm.leak"),e.avgspeed=Object(g["e"])(1e3*e.avgspeed),e.distance=Object(g["d"])(e.distance),e.editting=!1,e.saving=!1,e.oilVolume=Math.abs(e.eoil100-e.soil100),e.durationStr=e.duration/1e3/3600,e.address=Object(g["L"])(i,e.slat,e.slon),e.isSelected=!1,r.push(e))})),r},editRowEvent:function(t){this.editRow=t,this.isEditing=!0,this.$refs.oilxTable.setEditRow(t)},cancelRowEvent:function(t){var e=this,i=this.$refs.oilxTable;i.clearEdit().then((function(){e.isEditing=!1,i.revertData(t)}))},saveRowEvent:function(t){var e=this;t.begintime=new Date(t.begintimeStr).getTime(),t.endtime=new Date(t.endtimeStr).getTime(),t.oilVolume=Math.abs(t.eoil100-t.soil100).toFixed(2);var i=JSON.parse(JSON.stringify(t));i.eoil=100*i.eoil100,i.soil=100*i.soil100,t.eoil100-t.soil100>0?(t.oilstate=1,t.oilstateStr=this.$t("reportForm.refuel")):(t.oilstate=-1,t.oilstateStr=this.$t("reportForm.leak")),Object(b["i"])(i).then((function(i){var a=i.status;i.cause;0==a?(t.maunedit=1,e.$refs.oilxTable.clearEdit(),e.$XModal.message({message:e.$t("tips.editSucc"),status:"success",zIndex:9999})):(e.cancelRowEvent(t),e.$XModal.message({message:e.$t("tips.recordInUse"),status:"error",zIndex:9999}))}))},exportData:function(){var t=[[this.$t("reportForm.index"),this.$t("alarm.devName"),this.$t("alarm.devNum"),this.$t("reportForm.updatetimeStr"),this.$t("reportForm.arrivedtimeStr"),this.$t("reportForm.speed")+this.speedUnit,this.$t("reportForm.totalMileage")+this.distanceUnit,this.$t("reportForm.totalOil"),this.$t("reportForm.notRunTotalad"),this.$t("reportForm.oil1"),this.$t("reportForm.oil2"),this.$t("reportForm.oil3"),this.$t("reportForm.oil4"),this.$t("reportForm.srcad0"),this.$t("reportForm.srcad1"),this.$t("reportForm.srcad2"),this.$t("reportForm.srcad3"),this.$t("reportForm.altitude"),this.$t("reportForm.voltage"),this.$t("reportForm.reissue"),this.$t("reportForm.status"),this.$t("reportForm.lonLat")]];if(0!=this.detailsList.length){var e="";this.detailsList.forEach((function(i,a){0==a&&(e=i.deviceid);var r=[];r.push(a+1),r.push(i.devicename),r.push(i.deviceid),r.push(i.updatetimeStr),r.push(i.arrivedtimeStr),r.push(Object(g["qb"])(i.speed)),r.push(Object(g["qb"])(i.totalMileage)),r.push(Object(g["qb"])(i.totalad)),r.push(Object(g["qb"])(i.totalnotrunningad)),r.push(i.ad0),r.push(i.ad1),r.push(i.ad2),r.push(i.ad3),r.push(i.srcad0),r.push(i.srcad1),r.push(i.srcad2),r.push(i.srcad3),r.push(i.altitude),r.push(i.voltage),r.push(i.reissue),r.push(i.status),r.push(i.lonLat),t.push(r)}));var i={title:this.$t("reportForm.mileageOil")+"-"+e,data:t};this.exportLoading1=!0,new ExcelCls(i).exportExcel(this)}}}),mounted:function(){this.tableColumn=[{field:"speed",title:this.$t("reportForm.speed")+this.speedUnit,width:120},{field:"totalMileage",title:this.$t("reportForm.totalMileage")+this.distanceUnit,width:130},{field:"totalad",title:this.$t("reportForm.totalOil"),width:100},{field:"totalnotrunningad",title:this.$t("reportForm.notRunTotalad"),width:120}],this.singleDeviceid&&(this.deviceid=this.singleDeviceid)}},F=x,w=(i("1012"),i("2877")),k=Object(w["a"])(F,a,r,!1,null,null,null),O=k.exports;e["default"]=O},1012:function(t,e,i){"use strict";i("af2a")},"57c9":function(t,e,i){"use strict";var a=i("0595");e["a"]=a["a"]},"5aff":function(t,e,i){"use strict";i.d(e,"b",(function(){return a})),i.d(e,"h",(function(){return r})),i.d(e,"l",(function(){return s})),i.d(e,"k",(function(){return o})),i.d(e,"c",(function(){return l})),i.d(e,"d",(function(){return n})),i.d(e,"e",(function(){return d})),i.d(e,"f",(function(){return c})),i.d(e,"g",(function(){return m})),i.d(e,"m",(function(){return h})),i.d(e,"i",(function(){return u})),i.d(e,"a",(function(){return p})),i.d(e,"j",(function(){return b}));var a="#2D9F28",r="#89C6F2",s="#FFC65E",o="red",l="#1EBEFF",n="#E505F7",d="#40A703",c="#F27908",m="#F180D1",h="#0F1F46",u="#000000",p={backgroundColor:"rgba(255,255,255,0.85)",borderColor:"transparent",textStyle:{fontSize:12,color:"#000"},padding:2},b=function(t,e,i,a,r){var s=t[0],o=r.contentSize,l=r.viewSize;return s+10>l[0]-o[0]?s=s-o[0]-10:s+=10,[s,"0%"]}},"80f4":function(t,e,i){"use strict";var a=i("32eb");e["a"]=a["a"]},"8d09":function(t,e,i){"use strict";i("a818")},a818:function(t,e,i){},af2a:function(t,e,i){},c1f2:function(t,e,i){"use strict";var a=function(){var t=this,e=t._self._c;return e("div",{ref:"chartId",staticClass:"full"})},r=[],s=i("ade3"),o=i("5530"),l=(i("14d9"),i("b0c0"),i("a9e3"),i("b680"),i("d3b7"),i("159b"),i("43c8")),n=i.n(l),d=i("2f62"),c=i("c276"),m=i("5aff"),h={name:"TimeOilEcharts",computed:Object(o["a"])({},Object(d["b"])(["isZh","distanceUnit","speedUnit"])),methods:{initChart:function(){var t,e=this,i=this.$t("reportForm.notRunTotalad"),a=this.$t("reportForm.oil1"),r=this.$t("reportForm.oil2"),o=this.$t("reportForm.oil3"),l=this.$t("reportForm.oil4"),d=this.$t("reportForm.srcad0"),c=this.$t("reportForm.srcad1"),m=this.$t("reportForm.srcad2"),h=this.$t("reportForm.srcad3"),u=this.$t("reportForm.altitude"),p=this.$t("reportForm.voltage");this.selectedLegend=(t={},Object(s["a"])(Object(s["a"])(Object(s["a"])(Object(s["a"])(Object(s["a"])(Object(s["a"])(Object(s["a"])(Object(s["a"])(Object(s["a"])(Object(s["a"])(t,i,!1),a,!1),r,!1),o,!1),l,!1),d,!1),c,!1),m,!1),h,!1),u,!1),Object(s["a"])(t,p,!1)),this.disMin=0,this.firstDistance=0,this.totalads=[],this.notRunTotalad=[],this.veo=[],this.distance=[],this.recvtime=[],this.oil1=[],this.oil2=[],this.oil3=[],this.oil4=[],this.srcad0=[],this.srcad1=[],this.srcad2=[],this.srcad3=[],this.devReissue=[],this.altitudes=[],this.voltages=[],this.devStates=[],this.markPointData=[],this.markPointDataOil99=[],this.markPointDataOil1=[],this.markPointDataOil2=[],this.markPointDataOil3=[],this.markPointDataOil4=[],this.chartsIns=n.a.init(this.$refs.chartId),this.chartsIns.setOption(this.getChartsOption(),!0),this.chartsIns.on("click",(function(t){if("markPoint"==t.componentType){var i=t.data.oilrecordid,a=e.oilRecords,r=null;a.forEach((function(t){t.oilrecordid==i&&(r=t)})),null!==r&&(e.showMarkerTips&&(e.showMarkerTips=!1),e.$emit("onClickMarkPoint",r))}})),this.chartsIns.on("legendselectchanged",(function(t){e.selectedLegend=t.selected,e.$emit("legend-changed",t.selected)})),this.chartsIns.getZr().on("click",(function(t){var i=[t.offsetX,t.offsetY];if(e.chartsIns.containPixel("grid",i)&&e.recvtime.length){var a=e.chartsIns.convertFromPixel({seriesIndex:0},[t.offsetX,t.offsetY])[0];e.$emit("select-index",{rowIndex:a})}}))},updateChartsOption:function(t,e){var i=this,a=this.isZh,r=0,s=[],o=[],l=[],n=[],d=[],m=[],h=[],u=[],p=[],b=[],f=[],v=[],g=[],$=[],y=[],x=[],F=[];this.srcadratio=Object(c["b"])(t),this.oilRecords=e,t.forEach((function(t,e){0==e&&(r=t.totalMileage),n.push(Number((t.totalMileage-r).toFixed(2))),l.push(t.speed),d.push(t.updatetimeStr),s.push(t.totalad),o.push(t.totalnotrunningad),x.push(t.voltage/100),y.push(t.altitude),$.push(t.reissue),m.push(t.ad0),h.push(t.ad1),u.push(t.ad2),p.push(t.ad3),b.push(t.srcad0/i.srcadratio),f.push(t.srcad1/i.srcadratio),v.push(t.srcad2/i.srcadratio),g.push(t.srcad3/i.srcadratio),F.push(a?t.strstatus:t.strstatusen)})),this.firstDistance=r,this.veo=l,this.totalads=s,this.notRunTotalad=o,this.voltages=x,this.altitudes=y,this.devReissue=$,this.recvtime=d,this.distance=n,this.devStates=F,this.oil1=m,this.oil2=h,this.oil3=u,this.oil4=p,this.srcad0=b,this.srcad1=f,this.srcad2=v,this.srcad3=g,this.markPointData=Object(c["a"])(t,e,0),this.markPointDataOil99=Object(c["a"])(t,e,99),this.markPointDataOil1=Object(c["a"])(t,e,1),this.markPointDataOil2=Object(c["a"])(t,e,2),this.markPointDataOil3=Object(c["a"])(t,e,3),this.markPointDataOil4=Object(c["a"])(t,e,4),this.chartsIns.setOption(this.getChartsOption(),!0),this.chartsIns.resize()},resize:function(){this.chartsIns.resize()},getChartsOption:function(){var t=this.srcadratio,e=this.$t("reportForm.totalOil"),i=this.$t("reportForm.notRunTotalad"),a=this.$t("reportForm.speed"),r=this.$t("reportForm.mileage"),l=this.$t("reportForm.time"),n=this.$t("reportForm.oil1"),d=this.$t("reportForm.oil2"),h=this.$t("reportForm.oil3"),u=this.$t("reportForm.oil4"),p=this.$t("reportForm.srcad0"),b=this.$t("reportForm.srcad1"),f=this.$t("reportForm.srcad2"),v=this.$t("reportForm.srcad3"),g=this.$t("reportForm.status"),$=this.$t("reportForm.reissue"),y=this.$t("reportForm.altitude"),x=this.$t("reportForm.voltage"),F=this.$t("reportForm.altitudeunit"),w=this.distanceUnit,k=this.speedUnit;return{grid:{top:30,left:60,right:60,bottom:40},brush:{xAxisIndex:"all",brushLink:"all",outOfBrush:{colorAlpha:.1}},tooltip:Object(o["a"])(Object(o["a"])({show:!0,trigger:"axis"},m["a"]),{},{formatter:function(s,o){var $="<div>".concat(s[0].name,"</div>");for(var O in s){var S=s[O].seriesName,T=s[O].value;S&&S!=l&&($+=S==r?Object(c["k"])(m["b"],S,T,w):S==a?Object(c["k"])(m["h"],S,T,k):S==e?Object(c["k"])(m["k"],S,T,"L"):S==i?Object(c["k"])(m["c"],S,T,"L"):S==n?Object(c["k"])(m["d"],S,T,"L"):S==d?Object(c["k"])(m["e"],S,T,"L"):S==h?Object(c["k"])(m["f"],S,T,"L"):S==u?Object(c["k"])(m["g"],S,T,"L"):S==g?Object(c["k"])(m["i"],S,T,""):S==y?Object(c["k"])(m["i"],S,T,F):S==x?Object(c["k"])(m["i"],S,T,"V"):S==p||S==b||S==f||S==v?Object(c["k"])(m["i"],S,parseInt(Number(T)*t),""):Object(c["k"])(m["i"],S,T,""))}return'<div style="width:230px">'.concat($,"</div>")}}),legend:{data:[a,r,e,i,n,d,h,u,p,b,f,v,y,x],selected:this.selectedLegend,x:"left"},toolbox:{show:!1,feature:{dataZoom:{yAxisIndex:!1},brush:{type:["lineX","clear"]}},itemSize:14},dataZoom:[{show:!0,realtime:!0,start:0,end:100,height:20,backgroundColor:"#EDEDED",fillerColor:"rgb(54, 72, 96,0.5)",bottom:0},{type:"inside",realtime:!0,start:0,end:100,height:20,bottom:0}],xAxis:{type:"category",boundaryGap:!1,axisLine:{onZero:!1,show:!0},data:this.recvtime,axisPointer:{type:"line",value:"",snap:!1,lineStyle:{color:"#7581BD",width:2},handle:{show:!0,color:"transparent"}}},yAxis:[{name:"",type:"value",nameTextStyle:10,axisLabel:{formatter:"{value} L"},nameGap:5},{name:"",type:"value",nameTextStyle:10,nameGap:2,axisLabel:{formatter:"{value} "+this.distanceUnit},axisTick:{show:!1}}],series:[{name:l,type:"line",symbol:"none",yAxisIndex:1,color:"#F0805A",smooth:!0,data:this.recvtime},Object(s["a"])({name:a,type:"line",symbol:"none",yAxisIndex:0,smooth:!0,color:m["h"],data:this.veo},"yAxisIndex",1),{name:r,type:"line",symbol:"none",yAxisIndex:1,color:m["b"],smooth:!0,data:this.distance},{smooth:!0,name:e,type:"line",symbol:"none",color:m["k"],data:this.totalads,markPoint:{data:this.markPointData,symbolSize:36,symbolKeepAspect:!0}},{smooth:!0,name:i,type:"line",symbol:"none",color:m["c"],data:this.notRunTotalad,markPoint:{data:this.markPointDataOil99,symbolSize:36,symbolKeepAspect:!0}},{smooth:!0,name:n,type:"line",symbol:"none",color:m["d"],data:this.oil1,markPoint:{data:this.markPointDataOil1,symbolSize:36,symbolKeepAspect:!0}},{smooth:!0,name:d,type:"line",symbol:"none",color:m["e"],data:this.oil2,markPoint:{data:this.markPointDataOil2,symbolSize:36,symbolKeepAspect:!0}},{smooth:!0,name:h,type:"line",symbol:"none",color:m["f"],data:this.oil3,markPoint:{data:this.markPointDataOil3,symbolSize:36,symbolKeepAspect:!0}},{smooth:!0,name:u,type:"line",symbol:"none",color:m["g"],data:this.oil4,markPoint:{data:this.markPointDataOil4,symbolSize:36,symbolKeepAspect:!0}},{smooth:!0,name:p,type:"line",symbol:"none",color:m["i"],data:this.srcad0},{smooth:!0,name:b,type:"line",symbol:"none",color:"#000000",data:this.srcad1},{smooth:!0,name:f,type:"line",symbol:"none",color:m["i"],data:this.srcad2},{smooth:!0,name:v,type:"line",symbol:"none",color:m["i"],data:this.srcad3},{smooth:!0,name:g,type:"line",symbol:"none",color:m["i"],data:this.devStates},{smooth:!0,name:$,type:"line",symbol:"none",color:m["i"],data:this.devReissue},{smooth:!0,name:y,type:"line",symbol:"none",color:m["i"],data:this.altitudes},{smooth:!0,name:x,type:"line",symbol:"none",color:m["i"],data:this.voltages}]}}},mounted:function(){var t=this;this.$nextTick((function(){t.initChart()}))}},u=h,p=i("2877"),b=Object(p["a"])(u,a,r,!1,null,null,null);e["a"]=b.exports}}]);