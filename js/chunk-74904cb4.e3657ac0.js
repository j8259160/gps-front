(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-74904cb4"],{2556:function(t,e,s){"use strict";s.r(e);var n=function(){var t=this,e=t._self._c;return e("div",{staticClass:"transfer-bean"},[e("div",{staticClass:"transfer-bean-header"},[e("div",{staticClass:"f_left"},[e("SingleChoiceUser",{attrs:{isMounted:""},model:{value:t.username,callback:function(e){t.username=e},expression:"username"}})],1),e("div",{staticClass:"f_left"},[e("el-button",{attrs:{loading:t.loading,type:"primary"},on:{click:t.handleQuery}},[t._v(t._s(t.$t("common.query")))])],1),e("div",{staticClass:"f_left"},[e("div",{staticStyle:{padding:"5px 0px 0px 0px"}},[e("el-checkbox",{model:{value:t.isFilter,callback:function(e){t.isFilter=e},expression:"isFilter"}},[t._v(t._s(t.$t("bgManage.bonusGreaterThan0")))])],1)]),e("div",{staticClass:"r_left"},[e("span",[t._v(t._s(t.$t("bgManage.userTotal"))+" : "+t._s(t.userTotal))]),e("span",[t._v(t._s(t.$t("bgManage.totalGoldenBeans"))+" : "),e("b",[t._v(t._s(t.bonuspoints))])]),e("span",[t._v(t._s(t.$t("bgManage.userAmount"))+" : "+t._s(t.userbonuspoints))]),e("span",[t._v(t._s(t.$t("bgManage.totalAmount"))+" : "+t._s(t.totalbonuspoints))])])]),e("div",{staticClass:"transfer-bean-table"},[e("vxe-table",{staticClass:"mytable-scrollbar",attrs:{loading:t.loading,border:"",resizable:"","auto-resize":"","show-overflow":"","highlight-current-row":"","highlight-hover-row":"",size:"mini",height:"auto",data:t.tableList}},[0==t.userType?e("vxe-table-column",{attrs:{title:t.$t("reportForm.action"),width:"200",align:"center"},scopedSlots:t._u([{key:"default",fn:function(s){return[e("div",{staticStyle:{"text-align":"center"}},[e("el-button",{attrs:{type:"text"},on:{click:function(e){return t.handleClickRow(s.row,1)}}},[t._v(t._s(t.$t("bgManage.switchIn")))]),e("span",{staticStyle:{display:"inline-block",padding:"0px 25px"}}),e("el-button",{attrs:{type:"text"},on:{click:function(e){return t.handleClickRow(s.row,2)}}},[e("span",{staticStyle:{color:"#e4393c"}},[t._v(t._s(t.$t("bgManage.switchOut")))])])],1)]}}],null,!1,2762739502)}):e("vxe-table-column",{attrs:{title:t.$t("reportForm.action"),width:"90",align:"center"},scopedSlots:t._u([{key:"default",fn:function(s){return[e("el-button",{attrs:{type:"text"},on:{click:function(e){return t.handleClickRow(s.row,1)}}},[t._v(t._s(t.$t("bgManage.switchIn")))])]}}])}),e("vxe-table-column",{attrs:{type:"seq",width:"60",title:t.$t("reportForm.index")}}),e("vxe-table-column",{attrs:{field:"username",title:t.$t("bgManage.subUsernameList")}}),e("vxe-table-column",{attrs:{field:"userTypeStr",title:t.$t("bgManage.userType")}}),e("vxe-table-column",{attrs:{field:"bonuspoints",title:t.$t("bgManage.goldenBeanNumber"),sortable:""}}),e("vxe-table-column",{attrs:{field:"creater",title:t.$t("reportForm.creater")},scopedSlots:t._u([{key:"default",fn:function(s){return[e("el-popover",{attrs:{placement:"bottom",trigger:"click"}},[e("div",{staticClass:"parents-wrapper"},t._l(t.parentsList,(function(s){return e("div",{key:s.username},[t._v(t._s(s.username)+"("+t._s(s.usertypeStr)+")")])})),0),e("el-button",{staticStyle:{color:"#000000"},attrs:{slot:"reference",type:"text"},on:{click:function(e){return t.queryParents(s.row.creater)}},slot:"reference"},[t._v(t._s(s.row.creater))])],1)]}}])})],1)],1),e("div",{staticStyle:{position:"absolute",left:"0px",right:"10px",bottom:"0px"}},[e("el-pagination",{attrs:{currentPage:t.currentPage,"current-page":t.currentChangePage,"page-sizes":[100,400,800,1e3],"page-size":t.pageSize,layout:"total, sizes, pager, jumper",total:t.totalcount},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1),e("vxe-modal",{attrs:{title:t.jinDouSwitchIn,value:t.dialogVisible1,className:"modal-padding0",width:"280px"},on:{hide:function(e){t.dialogVisible1=!1},close:function(e){t.dialogVisible1=!1}}},[e("div",{staticClass:"margin_b10"},[e("LabelWrap",{attrs:{label:t.$t("bgManage.memberUser")}},[e("div",{staticStyle:{"padding-left":"10px","line-height":"32px"},domProps:{textContent:t._s(t.selectUser)}})])],1),e("div",{staticClass:"margin_b10"},[e("LabelWrap",{attrs:{label:t.$t("bgManage.currentGoldenBeans")}},[e("el-input-number",{staticStyle:{width:"100%"},attrs:{min:0,max:1e5,disabled:"","controls-position":"right"},model:{value:t.currentBonusPoint,callback:function(e){t.currentBonusPoint=e},expression:"currentBonusPoint"}})],1)],1),e("div",{staticClass:"margin_b10"},[e("LabelWrap",{attrs:{label:t.$t("bgManage.transferGoldenBeans")}},[e("el-input-number",{staticStyle:{width:"100%"},attrs:{min:0,max:1e5,"controls-position":"right"},model:{value:t.bonuspoint,callback:function(e){t.bonuspoint=e},expression:"bonuspoint"}})],1)],1),e("div",{staticClass:"margin_b10"},[e("LabelWrap",{attrs:{label:t.$t("reportForm.remarks")}},[e("el-input",{attrs:{clearable:""},model:{value:t.remark,callback:function(e){t.remark=e},expression:"remark"}})],1)],1),e("div",{staticStyle:{"text-align":"center"}},[e("el-button",{staticStyle:{width:"100px"},attrs:{type:"primary",loading:t.pointLoading},on:{click:t.assignPoints}},[t._v(t._s(t.$t("common.determine")))])],1)]),e("vxe-modal",{attrs:{title:t.jinDouSwitchOut,value:t.dialogVisible2,className:"modal-padding0",width:"280px"},on:{hide:function(e){t.dialogVisible2=!1},close:function(e){t.dialogVisible2=!1}}},[e("div",{staticClass:"margin_b10"},[e("LabelWrap",{attrs:{label:t.$t("bgManage.memberUser")}},[e("div",{staticStyle:{"padding-left":"10px","line-height":"32px"},domProps:{textContent:t._s(t.selectUser)}})])],1),e("div",{staticClass:"margin_b10"},[e("LabelWrap",{attrs:{label:t.$t("bgManage.currentGoldenBeans")}},[e("el-input-number",{staticStyle:{width:"100%"},attrs:{min:0,max:1e5,disabled:"","controls-position":"right"},model:{value:t.currentBonusPoint,callback:function(e){t.currentBonusPoint=e},expression:"currentBonusPoint"}})],1)],1),e("div",{staticClass:"margin_b10"},[e("LabelWrap",{attrs:{label:t.$t("bgManage.transferOutGoldenBeans")}},[e("el-input-number",{staticStyle:{width:"100%"},attrs:{min:0,max:1e5,"controls-position":"right"},model:{value:t.bonuspoint,callback:function(e){t.bonuspoint=e},expression:"bonuspoint"}})],1)],1),e("div",{staticStyle:{"text-align":"center"}},[e("el-button",{staticStyle:{width:"100px"},attrs:{type:"primary",loading:t.pointLoading},on:{click:t.transferPointsOut}},[t._v(t._s(t.$t("common.determine")))])],1)])],1)},i=[],a=s("5530"),r=(s("c975"),s("14d9"),s("fb6a"),s("a9e3"),s("b680"),s("d3b7"),s("159b"),s("b562")),o=s("e285"),u=s("c276"),l=s("d575"),c=s("2f62"),b=s("201d"),h=s("0c87"),d={name:"transferBean2",data:function(){return{loading:!1,pointLoading:!1,isFilter:!1,dialogVisible1:!1,dialogVisible2:!1,username:"",bonuspoints:0,currentBonusPoint:0,userbonuspoints:0,tableList:[],userTotal:0,selectUser:"",bonuspoint:0,remark:"",pageSize:100,currentPage:1,totalcount:0,jinDouSwitchIn:"",jinDouSwitchOut:""}},mixins:[h["a"]],computed:Object(a["a"])(Object(a["a"])({},Object(c["b"])(["isZh","isQueryInitData","userType"])),{},{totalbonuspoints:function(){return Number((this.userbonuspoints+this.bonuspoints).toFixed(2))},userName:function(){return this.$store.state.user.userName}}),watch:{isQueryInitData:function(t){t&&(this.username=this.userName,this.queryBonusList())},isFilter:function(t){this.currentPage=1,this.totalcount=t?this.filterTableList.length:this.cacheList.length,this.currentChangePage(this.currentPage)}},components:{SingleChoiceUser:l["a"],LabelWrap:b["a"]},methods:{handleSizeChange:function(t){this.pageSize=t,this.currentChangePage(this.currentPage)},handleCurrentChange:function(t){this.currentPage=t,this.currentChangePage(this.currentPage)},currentChangePage:function(t){for(var e=this.isFilter?this.filterTableList:this.cacheList,s=(t-1)*this.pageSize,n=this.pageSize,i=[],a=0;a<e.length;a++)if(a>=s){var r=e[a];if(i.push(r),i.length>=n)break}this.tableList=i},handleQuery:function(){var t=this.username,e=this.isFilter?this.filterTableList:this.cacheList;if(""==t||t==this.userName)this.tableList=e.slice(0,this.pageSize),this.currentPage=1;else{var s=[];e.forEach((function(e){-1!=e.username.indexOf(t)&&s.push(e)})),this.tableList=s}},handleClickRow:function(t,e){this.selectUser=t.username,this.bonuspoint=0,this.currentBonusPoint=Number(t.bonuspoints.toFixed(2)),1==e?(this.isZh?this.jinDouSwitchIn="从 "+this.userName+" 转入 "+t.username:this.jinDouSwitchIn="From "+this.userName+" To "+t.username,this.dialogVisible1=!0):2==e&&(this.isZh?this.jinDouSwitchOut="从 "+t.username+" 转入 "+this.userName:this.jinDouSwitchOut="From "+t.username+" To "+this.userName,this.dialogVisible2=!0)},assignPoints:function(){var t=this;if(0!=this.bonuspoint){this.pointLoading=!0;var e={targetusername:this.selectUser,points:this.bonuspoint,remark:this.remark};Object(r["h"])(e).then((function(s){var n=s.status,i=s.cause,a=s.frompoints;if(t.pointLoading=!1,0==n){var r=0;t.cacheList.forEach((function(t){t.username==e.targetusername&&(t.bonuspoints+=Number(e.points.toFixed(2))),r+=Number(t.bonuspoints.toFixed(2))})),t.bonuspoints=Number(a.toFixed(2)),t.userbonuspoints=r,t.$XModal.message({message:t.$t("bgManage.transferSuccessful"),status:"success",zIndex:9999}),t.dialogVisible1=!1}else t.$XModal.message({message:i,status:"error",zIndex:9999})})).catch((function(e){t.pointLoading=!1}))}},transferPointsOut:function(){var t=this;if(0==isNaN(this.bonuspoint)){if(0==this.bonuspoint)return;this.pointLoading=!0;var e={tousername:this.userName,points:this.bonuspoint,type:"baseaccounttobaseaccount",fromusername:this.selectUser};Object(o["uc"])(e).then((function(s){var n=s.status,i=s.frombonuspoints,a=s.tobonuspoints;if(t.pointLoading=!1,0==n){var r=0;t.cacheList.forEach((function(t){t.username==e.fromusername&&(t.bonuspoints=Number(i.toFixed(2))),r+=t.bonuspoints})),t.currentBonusPoint=Number(i.toFixed(2)),t.bonuspoints=Number(a.toFixed(2)),t.userbonuspoints=Number(r.toFixed(2)),t.addvaluepoints=Number(toaddvaluepoints.toFixed(2)),t.$XModal.message({message:t.$t("bgManage.transferSuccessful"),status:"success",zIndex:9999})}else 1==n?t.$XModal.message({message:t.$t("tips.noPermission"),status:"error",zIndex:9999}):2==n&&t.$XModal.message({message:t.$t("tips.balance"),status:"error",zIndex:9999})})).catch((function(e){t.pointLoading=!1}))}},queryBonusList:function(){var t=this;this.loading=!0;var e=0,s=this.userName;Object(r["P"])().then((function(n){var i=n.records;if(t.loading=!1,i){var a=[],r=[];i.forEach((function(t){t.username!=s&&(t.userTypeStr=Object(u["cb"])(!0,t.usertype),t.bonuspoints=Number(t.bonuspoints.toFixed(2)),e+=t.bonuspoints,r.push(t),t.bonuspoints>0&&a.push(t))})),t.userbonuspoints=Number(e.toFixed(2)),t.tableList=i.slice(0,t.pageSize),t.cacheList=r,t.filterTableList=a,t.totalcount=r.length,t.userTotal=t.totalcount}})).catch((function(e){t.loading=!1})),Object(o["hb"])().then((function(e){var s=e.bonuspoints;t.bonuspoints=null!=s?Number(s.toFixed(2)):0}))}},mounted:function(){this.cacheList=[],this.filterTableList=[],this.isQueryInitData&&(this.username=this.userName,this.queryBonusList())}},p=d,m=s("2877"),g=Object(m["a"])(p,n,i,!1,null,null,null),f=g.exports;e["default"]=f},"58d7":function(t,e,s){},c6a1:function(t,e,s){"use strict";s("58d7")},d575:function(t,e,s){"use strict";var n=function(){var t=this,e=t._self._c;return e("div",{staticClass:"multi-choice single-choice-user"},[e("div",{staticClass:"multi-choice-label"},[t._v(" "+t._s(t.$t("reportForm.selectUser"))+" ")]),e("div",{staticClass:"multi-choice-input"},[e("ZtreeUserDropdown",{ref:"ztreeDropdown",attrs:{placeholder:t.userPlaceholder,isMounted:t.isMounted},model:{value:t.username,callback:function(e){t.username=e},expression:"username"}})],1)])},i=[],a=s("c7eb"),r=s("1da1"),o=s("5530"),u=s("2f62"),l=s("f514"),c=s("e285"),b={props:{value:{type:String,default:""},isMounted:{type:Boolean,default:!1}},name:"SingleChoiceUser",data:function(){return{username:"",userPlaceholder:this.$t("bgManage.pleaseEnterQueryUser")}},watch:{username:function(t){this.$emit("input",t)},isQueryInitData:function(){if(0==this.isMounted){var t=this.$store.state.user.userName;this.ininZtree(t,this)}}},computed:Object(o["a"])({},Object(u["b"])(["isQueryInitData"])),components:{ZtreeUserDropdown:l["a"]},methods:{ininZtree:function(){var t=Object(r["a"])(Object(a["a"])().mark((function t(e,s){var n,i,r;return Object(a["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(c["Vb"])(e,null);case 2:n=t.sent,i=n.status,r=n.rootuser,0==i&&s.$refs.ztreeDropdown.ininZtree(r);case 6:case"end":return t.stop()}}),t)})));function e(e,s){return t.apply(this,arguments)}return e}()},mounted:function(){var t=this;this.$nextTick((function(){if(t.isQueryInitData&&0==t.isMounted){var e=t.$store.state.user.userName;t.ininZtree(e,t)}}))}},h=b,d=(s("c6a1"),s("2877")),p=Object(d["a"])(h,n,i,!1,null,null,null);e["a"]=p.exports}}]);