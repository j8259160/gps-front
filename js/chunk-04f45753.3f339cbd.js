(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-04f45753"],{"0c69":function(e,t,i){},"1d28":function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e._self._c;return t("div",{staticClass:"repair-record full"},[t("div",{staticClass:"repair-record-header"},[t("div",{staticClass:"f_left"},[t("MultiChoiceVehicle",{attrs:{disableShare:""},on:{onSelectDevice:e.onSelectDevice}})],1),t("div",{staticClass:"f_left"},[t("SelectDate",{model:{value:e.dateRange,callback:function(t){e.dateRange=t},expression:"dateRange"}})],1),t("div",{staticClass:"f_left"},[t("el-button",{attrs:{loading:e.loading,type:"primary"},on:{click:e.handleQuery}},[e._v(e._s(e.$t("common.query")))])],1),t("div",{staticClass:"f_left"},[t("el-button",{attrs:{type:"success"},on:{click:e.handleClickAdd}},[e._v(e._s(e.$t("common.add")))])],1),t("div",{staticClass:"f_left"},[t("el-button",{attrs:{type:"primary",loading:e.exportLoading1},on:{click:e.exportData}},[e._v(e._s(e.$t("common.export")))])],1)]),t("div",{staticClass:"repair-record-content"},[t("vxe-table",{attrs:{"sort-config":e.sortConfig,border:"","auto-resize":"",resizable:"","show-overflow":"","highlight-hover-row":"",size:"mini",height:"auto",data:e.tableList},on:{"cell-dblclick":e.handleDbclick}},[t("vxe-table-column",{attrs:{type:"seq",width:"60",title:e.$t("reportForm.index")}}),t("vxe-table-column",{attrs:{field:"devicename",sortable:"",title:e.$t("alarm.devName"),width:"130"}}),t("vxe-table-column",{attrs:{field:"deviceid",sortable:"",title:e.$t("alarm.devNum"),width:"130"}}),t("vxe-table-column",{attrs:{field:"repairitem",title:e.$t("insure.repairItem"),width:"100"}}),t("vxe-table-column",{attrs:{field:"fee",title:e.$t("insure.repairFee"),width:"100"}}),t("vxe-table-column",{attrs:{field:"repairagent",title:e.$t("insure.repairShop"),width:"100"}}),t("vxe-table-column",{attrs:{field:"repairaddress",title:e.$t("insure.repairAddress"),width:"130"}}),t("vxe-table-column",{attrs:{field:"repairphone",title:e.$t("insure.repairShopPhone"),width:"130"}}),t("vxe-table-column",{attrs:{field:"repairname",title:e.$t("insure.repairShopName"),width:"140"}}),t("vxe-table-column",{attrs:{field:"createtimeStr",title:e.$t("insure.deliveryTime"),width:"145"}}),t("vxe-table-column",{attrs:{field:"submitrepairname",title:e.$t("insure.submitRepairName"),width:"100"}}),t("vxe-table-column",{attrs:{field:"submitrepairphone",title:e.$t("insure.submitRepairPhone"),width:"100"}}),t("vxe-table-column",{attrs:{field:"remark",title:e.$t("reportForm.remarks"),width:"130"}}),t("vxe-table-column",{attrs:{title:e.$t("reportForm.action"),width:"100"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("div",{staticStyle:{"padding-top":"7px"}},[t("span",{staticStyle:{padding:"0px 10px 0px 0px"}},[t("img",{staticStyle:{width:"20px",cursor:"pointer"},attrs:{src:e.editIcon},on:{click:function(t){return e.handleEdit(i)}}})]),t("el-popconfirm",{attrs:{placement:"top",icon:"el-icon-info","confirm-button-text":e.$t("common.confirm"),"cancel-button-text":e.$t("common.cancel"),"icon-color":"red",title:e.$t("tips.confirmDelete")},on:{confirm:function(t){return e.handleDelete(i)}}},[t("span",{attrs:{slot:"reference"},slot:"reference"},[t("img",{staticStyle:{width:"20px",cursor:"pointer"},attrs:{src:e.deleteIcon}})])])],1)]}}])})],1)],1),t("vxe-modal",{attrs:{title:e.title,value:e.addDialog,className:"modal-padding0",width:"420px"},on:{hide:function(t){e.addDialog=!1},close:function(t){e.addDialog=!1}}},[t("div",[t("el-row",{staticClass:"margin_b10"},[e.isAdd?t("el-col",{attrs:{span:24}},[t("SingleChoiceVehicle",{attrs:{placeholder:this.$t("tips.selectSingleDevice"),width:"180px",showLabel:""},model:{value:e.deviceid,callback:function(t){e.deviceid=t},expression:"deviceid"}})],1):t("el-col",{attrs:{span:24}},[t("LabelWrap",{attrs:{label:e.$t("alarm.devName")}},[t("div",{staticStyle:{height:"34px","line-height":"34px","padding-left":"18px"}},[e._v(e._s(e.devicename))])])],1)],1),t("el-row",{staticClass:"margin_b10"},[t("el-col",{attrs:{span:24}},[t("LabelWrap",{attrs:{label:e.$t("insure.repairItem")}},[t("el-input",{attrs:{clearable:""},model:{value:e.repairitem,callback:function(t){e.repairitem=t},expression:"repairitem"}})],1)],1)],1),t("el-row",{staticClass:"margin_b10"},[t("el-col",{attrs:{span:24}},[t("LabelWrap",{attrs:{label:e.$t("insure.repairFee")}},[t("el-input",{attrs:{clearable:""},model:{value:e.fee,callback:function(t){e.fee=e._n(t)},expression:"fee"}})],1)],1)],1),t("el-row",{staticClass:"margin_b10"},[t("el-col",{attrs:{span:24}},[t("LabelWrap",{attrs:{label:e.$t("insure.repairShop")}},[t("el-input",{attrs:{clearable:""},model:{value:e.repairagent,callback:function(t){e.repairagent=t},expression:"repairagent"}})],1)],1)],1),t("el-row",{staticClass:"margin_b10"},[t("el-col",{attrs:{span:24}},[t("LabelWrap",{attrs:{label:e.$t("insure.repairAddress")}},[t("el-input",{attrs:{clearable:""},model:{value:e.repairaddress,callback:function(t){e.repairaddress=t},expression:"repairaddress"}})],1)],1)],1),t("el-row",{staticClass:"margin_b10"},[t("el-col",{attrs:{span:24}},[t("LabelWrap",{attrs:{label:e.$t("insure.repairShopPhone")}},[t("el-input",{attrs:{clearable:""},model:{value:e.repairphone,callback:function(t){e.repairphone=e._n(t)},expression:"repairphone"}})],1)],1)],1),t("el-row",{staticClass:"margin_b10"},[t("el-col",{attrs:{span:24}},[t("LabelWrap",{attrs:{label:e.$t("insure.repairShopName")}},[t("el-input",{attrs:{clearable:""},model:{value:e.repairname,callback:function(t){e.repairname=t},expression:"repairname"}})],1)],1)],1),t("el-row",{staticClass:"margin_b10"},[t("el-col",{attrs:{span:24}},[t("LabelWrap",{attrs:{label:e.$t("insure.submitRepairName")}},[t("el-input",{attrs:{clearable:""},model:{value:e.submitrepairname,callback:function(t){e.submitrepairname=t},expression:"submitrepairname"}})],1)],1)],1),t("el-row",{staticClass:"margin_b10"},[t("el-col",{attrs:{span:24}},[t("LabelWrap",{attrs:{label:e.$t("insure.submitRepairPhone")}},[t("el-input",{attrs:{clearable:""},model:{value:e.submitrepairphone,callback:function(t){e.submitrepairphone=e._n(t)},expression:"submitrepairphone"}})],1)],1)],1),t("el-row",{staticClass:"margin_b10"},[t("el-col",{attrs:{span:24}},[t("LabelWrap",{attrs:{label:e.$t("reportForm.remarks")}},[t("el-input",{attrs:{clearable:""},model:{value:e.remark,callback:function(t){e.remark=t},expression:"remark"}})],1)],1)],1),t("el-row",[e.isAdd?t("el-col",{attrs:{span:8,offset:8}},[t("el-button",{staticStyle:{width:"100%"},attrs:{type:"primary"},on:{click:e.addRepairRecord}},[e._v(e._s(e.$t("common.determine")))])],1):t("el-col",{attrs:{span:8,offset:8}},[t("el-button",{staticStyle:{width:"100%"},attrs:{type:"primary"},on:{click:e.editRepairRecord}},[e._v(e._s(e.$t("common.determine")))])],1)],1)],1)])],1)},r=[],s=(i("14d9"),i("d3b7"),i("159b"),i("e285")),n=i("201d"),l=i("26c6"),o=i("ea22"),c=i("2ddc"),d=i("5101"),p=i("6e52"),m=i("4c3c"),u=i("61fc"),h=i("e173"),b={name:"RepairRecord",data:function(){return{editIcon:u,deleteIcon:h,isAdd:!1,addDialog:!1,exportLoading1:!1,loading:!1,dateRange:[new Date,new Date],tableList:[],devicename:"",deviceid:"",repairitem:"",fee:"",repairagent:"",repairaddress:"",repairphone:"",repairname:"",submitrepairname:"",submitrepairphone:"",remark:""}},mixins:[m["a"]],components:{SelectDate:c["a"],MultiChoiceVehicle:o["a"],SingleChoiceVehicle:l["a"],LabelWrap:n["a"]},computed:{title:function(){return this.isAdd?this.$t("insure.addRepairInfo"):this.$t("insure.editRepairInfo")}},methods:{handleDbclick:function(e){this.handleEdit(e)},onSelectDevice:function(e){this.deviceids=e},handleQuery:function(){var e=this,t=this.deviceids;if(t.length>0){var i=d["a"].format(this.dateRange[0],"yyyy-MM-dd"),a=d["a"].format(this.dateRange[1],"yyyy-MM-dd"),r={deviceids:t,offset:d["a"].getOffset(),startday:i,endday:a};this.loading=!0,Object(s["Jb"])(r).then((function(t){var i=t.records;e.loading=!1;var a=[];i&&i.forEach((function(e){var t=e.deviceid,i=e.records,r=p["a"].getDeviceNameByDeviceId(t);i.forEach((function(e){e.devicename=r,e.deviceid=t,e.createtimeStr=d["a"].longToLocalDateTimeStr(e.createtime),a.push(e)}))})),e.tableList=a}))}else this.$XModal.message({message:this.$t("tips.selectDevice"),status:"error",zIndex:9999})},handleEdit:function(e){var t=e.row;this.isAdd=!1,this.addDialog=!0,this.row=t,this.devicename=p["a"].deviceInfos[t.deviceid].devicename,this.deviceid=t.deviceid,this.repairitem=t.repairitem,this.fee=t.fee,this.repairagent=t.repairagent,this.repairaddress=t.repairaddress,this.repairphone=t.repairphone,this.repairname=t.repairname,this.submitrepairname=t.submitrepairname,this.submitrepairphone=t.submitrepairphone,this.remark=t.remark},exportData:function(){if(0!=this.tableList.length){var e=[[this.$t("reportForm.index"),this.$t("alarm.devName"),this.$t("alarm.devNum"),this.$t("insure.repairItem"),this.$t("insure.repairFee"),this.$t("insure.repairShop"),this.$t("insure.repairAddress"),this.$t("insure.repairShopPhone"),this.$t("insure.repairShopName"),this.$t("insure.deliveryTime"),this.$t("insure.submitRepairName"),this.$t("insure.submitRepairPhone"),this.$t("reportForm.remarks")]];this.tableList.forEach((function(t,i){var a=[];a.push(i+1),a.push(t.devicename),a.push(t.deviceid),a.push(t.repairitem),a.push(t.fee),a.push(t.repairagent),a.push(t.repairaddress),a.push(t.repairphone),a.push(t.repairname),a.push(t.createtimeStr),a.push(t.submitrepairname),a.push(t.submitrepairphone),a.push(t.remark),e.push(a)}));var t={title:this.$t("bgManage.repairRecord"),data:e};this.exportLoading1=!0,new ExcelCls(t).exportExcel(this)}},handleDelete:function(e){var t=this,i=e.rowIndex,a=e.row;Object(s["H"])({repairrecordid:a.repairrecordid}).then((function(e){0==e.status?(t.$delete(t.tableList,i),t.$XModal.message({message:t.$t("tips.deleteSucc"),status:"error",zIndex:9999})):t.$XModal.message({message:t.$t("tips.deleteFail"),status:"error",zIndex:9999})}))},handleClickAdd:function(){this.isAdd=!0,this.addDialog=!0,this.row=null,this.deviceid="",this.repairitem="",this.fee="",this.repairagent="",this.repairaddress="",this.repairphone="",this.repairname="",this.submitrepairname="",this.submitrepairphone="",this.remark=""},addRepairRecord:function(){var e=this,t=this.deviceid;if(""!=t){var i={deviceid:t,repairitem:this.repairitem,fee:this.fee,repairagent:this.repairagent,repairaddress:this.repairaddress,repairphone:this.repairphone,repairname:this.repairname,submitrepairname:this.submitrepairname,submitrepairphone:this.submitrepairphone,remark:this.remark};Object(s["g"])(i).then((function(a){var r=a.status;0==r?(e.addDialog=!1,i.devicename=p["a"].getDeviceNameByDeviceId(t),i.createtimeStr=d["a"].longToLocalDateTimeStr(Date.now()),e.tableList.push(i),e.$XModal.message({message:e.$t("tips.addSucc"),status:"success",zIndex:9999})):e.$XModal.message({message:e.$t("tips.addFail"),status:"error",zIndex:9999})}))}else this.$XModal.message({message:this.$t("tips.selectDevice"),status:"error",zIndex:9999})},editRepairRecord:function(){var e=this,t=this.row,i={deviceid:this.deviceid,repairitem:this.repairitem,fee:this.fee,repairagent:this.repairagent,repairaddress:this.repairaddress,repairphone:this.repairphone,repairname:this.repairname,submitrepairname:this.submitrepairname,submitrepairphone:this.submitrepairphone,remark:this.remark,repairrecordid:t.repairrecordid};Object(s["U"])(i).then((function(a){var r=a.status;0==r?(e.addDialog=!1,t.repairitem=i.repairitem,t.fee=i.fee,t.repairagent=i.repairagent,t.repairaddress=i.repairaddress,t.repairphone=i.repairphone,t.repairname=i.repairname,t.submitrepairname=i.submitrepairname,t.submitrepairphone=i.submitrepairphone,t.remark=i.remark,e.$XModal.message({message:e.$t("tips.editSucc"),status:"success",zIndex:9999})):e.$XModal.message({message:e.$t("tips.editFail"),status:"error",zIndex:9999})}))}},mounted:function(){this.deviceids=[]}},f=b,v=(i("ae34"),i("2877")),g=Object(v["a"])(f,a,r,!1,null,null,null),$=g.exports;t["default"]=$},"3b13":function(e,t,i){},7031:function(e,t,i){"use strict";i("3b13")},ae34:function(e,t,i){"use strict";i("0c69")},ea22:function(e,t,i){"use strict";var a=function(){var e=this,t=e._self._c;return t("div",{staticClass:"multi-choice multi-choice-vehicle"},[t("div",{staticClass:"multi-choice-input"},[t("ZtreeDeviceDropdown",{ref:"ztreeDevice",attrs:{disableShare:e.disableShare,isCheck:"",placeholder:this.$t("tips.selectDevice"),isQueryInitData:e.isQueryInitData,selectDeviceIds:e.multipleDeviceids},on:{onTreeCheck:e.onTreeCheck}})],1)])},r=[],s=i("5530"),n=(i("4795"),i("2f62")),l=i("2df7"),o={name:"MultiChoiceVehicle",props:{disableShare:{type:Boolean,default:!1}},data:function(){return{}},computed:Object(s["a"])({},Object(n["b"])(["isQueryInitData","multipleDeviceids"])),components:{ZtreeDeviceDropdown:l["a"]},methods:Object(s["a"])(Object(s["a"])({},Object(n["c"])(["setMultipleDeviceids"])),{},{onTreeCheck:function(e){this.$emit("onSelectDevice",e),this.setMultipleDeviceids(e)},clearText:function(){var e=this;setTimeout((function(){e.$refs.ztreeDevice.clearText()}),300)}})},c=o,d=(i("7031"),i("2877")),p=Object(d["a"])(c,a,r,!1,null,null,null);t["a"]=p.exports}}]);