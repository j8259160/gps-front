(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-897313ae"],{1664:function(e,t,a){},"23ff":function(e,t,a){"use strict";a("1664")},3133:function(e,t,a){"use strict";a("d325")},"6e7c":function(e,t,a){"use strict";a("8fa3")},"7dc0":function(e,t,a){"use strict";a("c8b8")},"8fa3":function(e,t,a){},"927b":function(e,t,a){"use strict";a.r(t);var i=a("ade3"),s=(a("c975"),function(){var e=this,t=e._self._c;return t("div",{staticClass:"query-device full"},[t("div",{staticClass:"query-device-header"},[t("div",{staticClass:"f_left",staticStyle:{width:"210px"}},[t("LabelWrap",{attrs:{label:e.$t("bgManage.queryDevice"),showLabel:!1}},[t("ZtreeDeviceDropdown",{attrs:{placeholder:this.$t("tips.selectSingleDevice"),isQueryInitData:e.isQueryInitData,isClickAll:!0},model:{value:e.queryText,callback:function(t){e.queryText=t},expression:"queryText"}})],1)],1),t("div",{staticClass:"f_left"},[t("el-button",{attrs:{type:"primary",loading:e.loading},on:{click:e.handleClickQuery}},[e._v(e._s(e.$t("common.query")))])],1),t("div",{staticClass:"f_right",staticStyle:{"padding-top":"3px"}},[t("el-button",{staticStyle:{position:"relative",top:"-1px"},attrs:{type:"info",size:"mini",loading:e.exportAllLoading},on:{click:e.exportDataAll}},[e._v(e._s(e.$t("device.exportAllDevice")))])],1),t("div",{staticClass:"f_right",staticStyle:{"padding-top":"3px"}},[t("el-button",{staticStyle:{position:"relative",top:"-1px"},attrs:{type:"info",size:"mini",loading:e.exportLoading},on:{click:e.exportData}},[e._v(e._s(e.$t("device.exportCurrentDevice")))])],1),t("div",{staticClass:"f_right"},[t("el-radio",{attrs:{label:"-1"},model:{value:e.queryType,callback:function(t){e.queryType=t},expression:"queryType"}},[e._v(e._s(e.$t("device.expired"))),"-1"==e.queryType?t("span",[e._v("("+e._s(e.totalcount)+")")]):e._e()])],1),t("div",{staticClass:"f_right"},[t("el-radio",{attrs:{label:"60"},model:{value:e.queryType,callback:function(t){e.queryType=t},expression:"queryType"}},[e._v(e._s(e.$t("device.daysOverdue60"))),"60"==e.queryType?t("span",[e._v("("+e._s(e.totalcount)+")")]):e._e()])],1),t("div",{staticClass:"f_right"},[t("el-radio",{attrs:{label:"7"},model:{value:e.queryType,callback:function(t){e.queryType=t},expression:"queryType"}},[e._v(e._s(e.$t("device.daysOverdue7"))),"7"==e.queryType?t("span",[e._v("("+e._s(e.totalcount)+")")]):e._e()])],1),t("div",{staticClass:"f_right",staticStyle:{width:"auto"}},[t("el-radio",{attrs:{label:"0"},model:{value:e.queryType,callback:function(t){e.queryType=t},expression:"queryType"}},[e._v(e._s(e.$t("device.allDevice"))),"0"==e.queryType?t("span",[e._v("("+e._s(e.totalcount)+")")]):e._e()])],1)]),t("div",{staticClass:"query-device-content",staticStyle:{top:"39px"}},[t("vxe-table",{ref:"xTable",attrs:{"sort-config":e.sortConfig,"menu-config":e.tableMenu,border:"","auto-resize":"",resizable:"","show-overflow":"","highlight-current-row":"",size:"mini",height:"auto",data:e.tableList},on:{"menu-click":e.handleClickTableMenu,"current-change":e.currentChangeEvent,"cell-dblclick":e.cellDblclick}},[t("vxe-table-column",{attrs:{title:e.$t("reportForm.action"),width:"100",fixed:"left"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("div",{staticStyle:{"padding-top":"7px"}},[t("span",{staticStyle:{padding:"0px 11px 0px 0px"}},[t("img",{staticStyle:{width:"17px",cursor:"pointer"},attrs:{src:e.editIcon},on:{click:function(t){return e.handleEdit(a)}}})]),e.isDeleteDevicePermission?t("el-popconfirm",{attrs:{placement:"top",icon:"el-icon-info","icon-color":"red","confirm-button-text":e.$t("common.confirm"),"cancel-button-text":e.$t("common.cancel"),title:e.$t("tips.confirmDelete")},on:{confirm:function(t){return e.handleDelete(a)}}},[t("span",{attrs:{slot:"reference"},slot:"reference"},[t("img",{staticStyle:{width:"16px",cursor:"pointer"},attrs:{src:e.deleteIcon}})])]):e._e(),t("el-dropdown",{attrs:{trigger:"click",size:"mini"},on:{command:e.onCommand}},[t("span",{staticStyle:{padding:"0px 10px",position:"relative",top:"1px"}},[t("img",{staticStyle:{width:"18px",cursor:"pointer"},attrs:{src:e.moreIcon}})]),t("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[t("el-dropdown-item",{staticClass:"clearfix",attrs:{command:"oil"}},[e._v(e._s(e.$t("device.oilMarking")))]),t("el-dropdown-item",{staticClass:"clearfix",attrs:{command:"weight"}},[e._v(e._s(e.$t("device.weightMarking")))]),t("el-dropdown-item",{staticClass:"clearfix",attrs:{command:"temp"}},[e._v(e._s(e.$t("device.overTemperatureSetting")))]),t("el-dropdown-item",{staticClass:"clearfix",attrs:{command:"io"}},[e._v(e._s(e.$t("device.ioConfig")))]),t("el-dropdown-item",{staticClass:"clearfix",attrs:{command:"password"}},[e._v(e._s(e.$t("common.resetPassword")))]),t("el-dropdown-item",{staticClass:"clearfix",attrs:{command:"records"}},[e._v(e._s(e.$t("bgManage.renew")))]),t("el-dropdown-item",{staticClass:"clearfix",attrs:{command:"bindUsers"}},[e._v(e._s(e.$t("device.viewBindList")))]),t("el-dropdown-item",{staticClass:"clearfix",attrs:{command:"cleanPosi"}},[e._v(e._s(e.$t("device.clearLocation")))]),e.userType<2?t("el-dropdown-item",{staticClass:"clearfix",attrs:{command:"cleanRecord"}},[e._v(e._s(e.$t("device.clearTrack")))]):e._e(),t("el-dropdown-item",{staticClass:"clearfix",attrs:{command:"replaceDevice"}},[e._v(e._s(e.$t("device.replaceDevice")))]),e.permissionList.indexOf("monitor-viewsimdetail")>-1?t("el-dropdown-item",{staticClass:"clearfix",attrs:{command:"simDetails"}},[e._v(e._s(e.$t("common.simDetail")))]):e._e()],1)],1)],1)]}}])}),t("vxe-table-column",{attrs:{type:"seq",fixed:"left",width:"60",title:e.$t("reportForm.index")}}),t("vxe-table-column",{attrs:{field:"devicename",sortable:"",fixed:"left",width:"140",title:e.$t("alarm.devName")}}),t("vxe-table-column",{attrs:{field:"deviceid",sortable:"",width:"140",title:e.$t("alarm.devNum")}}),t("vxe-table-column",{attrs:{field:"deviceType",sortable:"",title:e.$t("reportForm.deviceType"),width:"90"}}),t("vxe-table-column",{attrs:{field:"creater",sortable:"",title:e.$t("reportForm.creater"),width:"130"}}),t("vxe-table-column",{attrs:{field:"groupName",sortable:"",title:e.$t("reportForm.groupName"),width:"110"}}),t("vxe-table-column",{attrs:Object(i["a"])({field:"simiccid",sortable:"",title:"ICCID",width:"160"},"sortable","")}),t("vxe-table-column",{attrs:Object(i["a"])({field:"simnum",sortable:"",title:e.$t("reportForm.sim"),width:"130"},"sortable","")}),t("vxe-table-column",{attrs:Object(i["a"])({field:"addTime",sortable:"",title:e.$t("reportForm.addTime"),width:"110"},"sortable","")}),t("vxe-table-column",{attrs:Object(i["a"])({field:"initloctimeStr",sortable:"",title:e.$t("reportForm.initLocTime"),width:"130"},"sortable","")}),t("vxe-table-column",{attrs:Object(i["a"])({field:"firstLocTime",sortable:"",title:e.$t("reportForm.firstLocTime"),width:"110"},"sortable","")}),t("vxe-table-column",{attrs:Object(i["a"])({field:"installtimeStr",sortable:"",title:e.$t("reportForm.installTime"),width:"110"},"sortable","")}),t("vxe-table-column",{attrs:Object(i["a"])({field:"expireTime",sortable:"",title:e.$t("alarm.expireTime"),width:"110"},"sortable","")}),t("vxe-table-column",{attrs:Object(i["a"])({field:"alarmactionStr",sortable:"",title:e.$t("bgManage.alarmAction"),width:"100"},"sortable","")}),t("vxe-table-column",{attrs:Object(i["a"])({field:"loginenableStr",sortable:"",title:e.$t("login.logining"),width:"100"},"sortable","")}),t("vxe-table-column",{attrs:Object(i["a"])({field:"distanceratio",sortable:"",title:e.$t("bgManage.mileageRatio"),width:"100"},"sortable","")}),e.userType<2?t("vxe-table-column",{attrs:{field:"remark",sortable:"",title:e.$t("reportForm.remarks"),width:"200"}}):t("vxe-table-column",{attrs:{field:"remark2",sortable:"",title:e.$t("reportForm.remarks"),width:"200"}}),t("vxe-table-column",{attrs:{field:"packagesStr",sortable:"",title:e.$t("systemManage.packages"),width:"200"}}),t("vxe-table-column",{attrs:{field:"monitor",sortable:"",title:e.$t("device.tutelageUser"),width:"120"}}),t("vxe-table-column",{attrs:{field:"bindpwd",sortable:"",title:e.$t("reportForm.bindPwd"),width:"120"}}),t("vxe-table-column",{attrs:{field:"vin",sortable:"",title:e.$t("reportForm.vinno"),width:"120"}})],1)],1),t("div",{staticStyle:{position:"absolute",left:"0px",right:"10px",bottom:"0px"}},[t("el-pagination",{attrs:{currentPage:e.currentPage,"current-page":e.currentChangePage,"page-sizes":[20,40,60,80],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.totalcount},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),t("RecordsDialog",{attrs:{deviceid:e.deviceid,deviceName:e.deviceName,packages:e.packages},model:{value:e.recordsDialog,callback:function(t){e.recordsDialog=t},expression:"recordsDialog"}}),t("OilMarkingDialog",{attrs:{deviceid:e.deviceid,deviceName:e.deviceName},model:{value:e.oilMarkDiglog,callback:function(t){e.oilMarkDiglog=t},expression:"oilMarkDiglog"}}),t("EditDevice",{attrs:{deviceid:e.deviceid,info:e.currentRow},on:{editSucc:e.onEditSucc},model:{value:e.editDialog,callback:function(t){e.editDialog=t},expression:"editDialog"}}),t("WeightMarkingDialog",{attrs:{deviceid:e.deviceid,deviceName:e.deviceName},model:{value:e.weightDialog,callback:function(t){e.weightDialog=t},expression:"weightDialog"}}),t("IoMarkingDialog",{attrs:{deviceid:e.deviceid,deviceName:e.deviceName},model:{value:e.ioDialog,callback:function(t){e.ioDialog=t},expression:"ioDialog"}}),t("TempMarkingDialog",{attrs:{deviceid:e.deviceid,deviceName:e.deviceName},model:{value:e.tempDialog,callback:function(t){e.tempDialog=t},expression:"tempDialog"}}),t("ReplaceDeviceDialog",{attrs:{deviceid:e.deviceid,deviceName:e.deviceName},model:{value:e.replaceDialog,callback:function(t){e.replaceDialog=t},expression:"replaceDialog"}}),t("BindUsersDialog",{attrs:{deviceid:e.deviceid},model:{value:e.bindUsersDialog,callback:function(t){e.bindUsersDialog=t},expression:"bindUsersDialog"}})],1)}),l=[],o=a("5530"),r=(a("14d9"),a("a9e3"),a("d3b7"),a("159b"),a("0139")),n=function(){var e=this,t=e._self._c;return t("vxe-modal",{ref:"xTable",attrs:{title:e.title,loading:e.loading,className:"modal-padding0",value:e.value,width:"960px"},on:{hide:e.handleClose,close:e.handleClose}},[t("vxe-table",{staticClass:"mytable-scrollbar",attrs:{border:"",resizable:"","show-overflow":"",size:"mini","menu-config":e.tableMenu,height:"420",data:e.tableList},on:{"menu-click":e.handleClickTableMenu}},[t("vxe-table-column",{attrs:{type:"seq",width:"60",title:e.$t("reportForm.index")}}),t("vxe-table-column",{attrs:{field:"devicename",title:e.$t("alarm.devName")}}),t("vxe-table-column",{attrs:{field:"deviceid",title:e.$t("alarm.devNum")}}),t("vxe-table-column",{attrs:{field:"deviceType",title:e.$t("reportForm.deviceType"),width:"100"}}),t("vxe-table-column",{attrs:{field:"chargeyears",title:e.$t("device.renewalYears"),width:"80"}}),t("vxe-table-column",{attrs:{field:"chargetimeStr",width:"160",title:e.$t("device.rechargeTime")}}),t("vxe-table-column",{attrs:{field:"postoverduetimeStr",width:"100",title:e.$t("device.beforeRecharging")}}),t("vxe-table-column",{attrs:{field:"preoverduetimeStr",width:"100",title:e.$t("device.afterRecharging")}}),t("vxe-table-column",{attrs:{field:"packagesStr",sortable:"",title:e.$t("systemManage.packages"),width:"160"}})],1)],1)},c=[],d=(a("99af"),a("2f62")),m=a("e285"),p=a("6e52"),u=a("5101"),h=a("c276"),v=a("a05b"),g={name:"RecordsDialog",props:{value:{type:!1,default:!1},deviceid:{type:String,default:""},deviceName:{type:String,default:""},packages:{type:Array,default:function(){return[]}}},data:function(){return{loading:!1,tableList:[]}},mixins:[v["a"]],computed:Object(o["a"])(Object(o["a"])({},Object(d["b"])(["deviceTypes"])),{},{title:function(){return"".concat(this.$t("bgManage.renew")," - ").concat(this.deviceName)}}),watch:{value:function(e){e?this.queryChargeDeviceRecords(this.deviceid):this.tableList=[]}},methods:{handleClose:function(){this.$emit("input",!1)},queryChargeDeviceRecords:function(e){var t=this;this.loading=!0;var a=this.packages,i=this.deviceTypes;Object(m["ib"])(e).then((function(s){var l=s.records;l.forEach((function(t){t.devicename=p["a"].getDeviceNameByDeviceId(e),t.deviceType=i[t.devicetype].typename,t.postoverduetimeStr=0==t.preoverduetime?"-":u["a"].format(new Date(t.preoverduetime),"yyyy-MM-dd"),t.preoverduetimeStr=0==t.postoverduetime?"-":u["a"].format(new Date(t.postoverduetime),"yyyy-MM-dd"),t.chargetimeStr=0==t.chargetime?"-":u["a"].longToLocalDateTimeStr(t.chargetime),Object(h["tb"])(t,a,t.packageids)})),t.tableList=l})).finally((function(){t.loading=!1}))}}},b=g,f=a("2877"),x=Object(f["a"])(b,n,c,!1,null,null,null),y=x.exports,w=function(){var e=this,t=e._self._c;return t("vxe-modal",{attrs:{title:e.title,className:"modal-padding0",value:e.value,width:"760px"},on:{hide:e.handleClose,close:e.handleClose}},[t("div",{staticClass:"oil-marking-tabs",staticStyle:{width:"100%"}},[t("el-tabs",{attrs:{type:"card"},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[t("el-tab-pane",{attrs:{label:e.$t("device.tank1"),name:"0"}}),t("el-tab-pane",{attrs:{label:e.$t("device.tank2"),name:"1"}}),t("el-tab-pane",{attrs:{label:e.$t("device.tank3"),name:"2"}}),t("el-tab-pane",{attrs:{label:e.$t("device.tank4"),name:"3"}})],1),t("div",{staticStyle:{"border-left":"1px solid #c4bcbc","border-right":"1px solid #c4bcbc","border-bottom":"1px solid #c4bcbc","margin-top":"10px","border-top":"1px solid #c4bcbc"}},e._l(e.oilDetectors,(function(a,i){return t("div",[i==e.activeName?t("div",[t("OilMarkingItem",{attrs:{item:a,deviceid:e.deviceid}})],1):e._e()])})),0)],1),t("el-row",{staticClass:"margin_b10"},[t("el-col",{attrs:{span:12}},[t("div",{staticClass:"oil-marking-checkbox",staticStyle:{height:"40px","line-height":"40px"}},[t("el-checkbox",{model:{value:e.travelOil,callback:function(t){e.travelOil=t},expression:"travelOil"}},[e._v(e._s(e.$t("device.mergeStatistical")))]),t("el-checkbox",{model:{value:e.noTravelOil,callback:function(t){e.noTravelOil=t},expression:"noTravelOil"}},[e._v(e._s(e.$t("device.notRunOilMergeStatistical")))])],1)]),t("el-col",{attrs:{span:1,offset:11}},[t("div",{staticStyle:{"padding-top":"8px",float:"right",cursor:"pointer"}},[t("el-dropdown",{attrs:{trigger:"hover"},on:{command:e.onCommand}},[t("img",{attrs:{src:e.icon1,width:"14px"}}),t("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[t("el-dropdown-item",{staticClass:"clearfix",attrs:{command:"save"}},[t("img",{staticStyle:{"vertical-align":"middle"},attrs:{src:e.icon2,width:"16px"}}),t("span",{staticStyle:{"font-size":"12px",position:"relative",top:"1px"}},[e._v(e._s(e.$t("device.saveTemplate")))])]),t("el-dropdown-item",{staticClass:"clearfix",attrs:{command:"import"}},[t("img",{staticStyle:{"vertical-align":"middle"},attrs:{src:e.icon3,width:"16px"}}),t("span",{staticStyle:{"font-size":"12px",position:"relative",top:"1px"}},[e._v(e._s(e.$t("device.ImportFromTemplate")))])])],1)],1)],1)])],1),t("el-row",{staticClass:"margin_b10",staticStyle:{height:"60px","padding-top":"20px"}},[t("el-col",{staticStyle:{"text-align":"center"},attrs:{span:8,offset:8}},[t("el-button",{staticStyle:{width:"100px"},attrs:{type:"primary",loading:e.loading},on:{click:e.handleSubmit}},[e._v(e._s(e.$t("common.determine")))])],1)],1),t("vxe-modal",{attrs:{title:e.$t("device.addTempInfo"),className:"modal-padding0",value:e.saveTemp,width:"360px"},on:{hide:function(t){e.saveTemp=!1},close:function(t){e.saveTemp=!1}}},[t("div",{staticStyle:{width:"320px",margin:"0 auto"}},[t("el-row",{staticClass:"margin_b10",staticStyle:{"margin-bottom":"20px"}},[t("el-col",{attrs:{span:24}},[t("LabelWrap",{attrs:{label:e.$t("device.templateInfo")}},[t("el-input",{attrs:{clearable:"",placeholder:e.$t("device.inputTemplateInfo")},model:{value:e.templatename,callback:function(t){e.templatename=t},expression:"templatename"}})],1)],1)],1),t("el-row",{staticClass:"margin_b10",staticStyle:{"margin-bottom":"20px"}},[t("el-col",{attrs:{span:24}},[t("LabelWrap",{attrs:{label:e.$t("device.oilRodBrand")}},[t("el-input",{attrs:{clearable:"",placeholder:e.$t("device.inputBrandOil")},model:{value:e.brand,callback:function(t){e.brand=t},expression:"brand"}})],1)],1)],1),t("el-row",{staticClass:"margin_b10",staticStyle:{"margin-bottom":"20px"}},[t("el-col",{attrs:{span:24}},[t("LabelWrap",{attrs:{label:e.$t("device.OilRodModel")}},[t("el-input",{attrs:{clearable:"",placeholder:e.$t("device.inputBrandOilType")},model:{value:e.model,callback:function(t){e.model=t},expression:"model"}})],1)],1)],1),t("el-row",{staticClass:"margin_b10",staticStyle:{"margin-top":"30px"}},[t("el-col",{staticStyle:{"text-align":"center"},attrs:{span:24}},[t("el-button",{staticStyle:{width:"100px"},attrs:{type:"primary"},on:{click:e.saveOilDetectorTemplate}},[e._v(e._s(e.$t("common.save")))])],1)],1)],1)]),t("vxe-modal",{attrs:{title:e.$t("device.saveTemplate"),className:"modal-padding0",value:e.importTemp,width:"680px"},on:{hide:function(t){e.importTemp=!1},close:function(t){e.importTemp=!1}}},[t("div",{staticStyle:{width:"100%"}},[t("el-row",{staticClass:"margin_b10"},[t("el-col",{attrs:{span:8}},[t("LabelWrap",{attrs:{label:e.$t("common.exactQuery")}},[t("el-input",{attrs:{clearable:"",placeholder:e.$t("device.inputTemplateName")},model:{value:e.filterTemp,callback:function(t){e.filterTemp=t},expression:"filterTemp"}})],1)],1),t("el-col",{staticStyle:{"padding-top":"6px"},attrs:{span:3,offset:1}},[t("el-checkbox",{model:{value:e.allTemp,callback:function(t){e.allTemp=t},expression:"allTemp"}},[e._v(e._s(e.$t("device.displayAllTemplate")))])],1),t("el-col",{attrs:{span:2,offset:10}},[t("el-button",{staticStyle:{width:"100%"},attrs:{type:"primary"},on:{click:e.queryOilDetectorTemplate}},[e._v(e._s(e.$t("common.query")))])],1)],1),t("vxe-table",{attrs:{border:"",resizable:"",size:"mini",height:"410",data:e.tempList}},[t("vxe-table-column",{attrs:{type:"seq",width:"60",title:e.$t("reportForm.index")}}),t("vxe-table-column",{attrs:{field:"templatename",title:e.$t("device.templateName")}}),t("vxe-table-column",{attrs:{field:"brand",title:e.$t("device.brand")}}),t("vxe-table-column",{attrs:{field:"model",title:e.$t("device.model")}}),t("vxe-table-column",{attrs:{field:"oilCount",title:e.$t("device.oilCount"),width:"60"}}),t("vxe-table-column",{attrs:{title:e.$t("reportForm.action"),width:"100"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("div",{staticStyle:{"line-height":"18px"}},[e._v("1."+e._s(a.row.oil1))]),t("div",{staticStyle:{"line-height":"18px"}},[e._v("2."+e._s(a.row.oil2))]),t("div",{staticStyle:{"line-height":"18px"}},[e._v("3."+e._s(a.row.oil3))]),t("div",{staticStyle:{"line-height":"18px"}},[e._v("4."+e._s(a.row.oil4))])]}}])}),t("vxe-table-column",{attrs:{title:e.$t("reportForm.action"),width:"75"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("div",{staticStyle:{"padding-top":"6px"}},[t("span",{staticStyle:{cursor:"pointer"},attrs:{title:e.$t("device.import")},on:{click:function(t){return e.handleClickImport(a)}}},[t("img",{staticStyle:{width:"18px",height:"18px"},attrs:{src:e.importIcon}})]),t("span",{staticStyle:{display:"inline-block",width:"6px"}}),t("span",{staticStyle:{cursor:"pointer"},attrs:{title:e.$t("common.delete")},on:{click:function(t){return e.handleClickDelete(a)}}},[t("img",{staticStyle:{width:"18px",height:"18px"},attrs:{src:e.deleteIcon}})])])]}}])})],1)],1)])],1)},$=[],k=(a("4e82"),a("b680"),a("b0c0"),function(){var e=this,t=e._self._c;return t("div",{staticClass:"oil-marking-item"},[t("div",{staticStyle:{padding:"10px"}},[t("el-row",{staticClass:"margin_b10",attrs:{gutter:10}},[t("el-col",{attrs:{span:8}},[t("LabelWrap",{attrs:{label:e.$t("device.purpose")}},[t("el-select",{model:{value:e.item.useas,callback:function(t){e.$set(e.item,"useas",t)},expression:"item.useas"}},e._l(e.useasOptions,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1),t("el-col",{attrs:{span:8}},[t("LabelWrap",{attrs:{label:e.$t("device.tankShape")}},[t("el-select",{model:{value:e.item.appearance,callback:function(t){e.$set(e.item,"appearance",t)},expression:"item.appearance"}},e._l(e.appearanceOptions,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1),t("el-col",{attrs:{span:1}},[t("div",{staticClass:"f_left"},[t("el-tooltip",{attrs:{placement:"top"}},[t("div",{attrs:{slot:"content"},slot:"content"},[e._v(" "+e._s(e.$t("tips.thresholdTip1"))+" "),t("br"),e._v(" "+e._s(e.$t("tips.thresholdTip2"))+" "),t("br"),e._v(" "+e._s(e.$t("tips.thresholdTip3"))+" "),t("br")]),t("div",{staticStyle:{cursor:"pointer","padding-top":"6px"}},[t("i",{staticClass:"el-icon-info",staticStyle:{color:"#FF9900","font-size":"18px"}})])])],1)]),t("el-col",{attrs:{span:7}},[t("LabelWrap",{attrs:{label:e.$t("device.threshold")+"(L)"}},[t("el-input-number",{staticStyle:{width:"100%"},attrs:{"controls-position":"right",min:1,max:999999999999},model:{value:e.item.threshold,callback:function(t){e.$set(e.item,"threshold",t)},expression:"item.threshold"}})],1)],1)],1),t("el-row",{staticClass:"margin_b10"},[t("el-col",{attrs:{span:24}},[t("LabelWrap",{attrs:{label:e.$t("device.remarkInfo")}},[t("el-input",{attrs:{clearable:"",placeholder:e.$t("device.fuelRemarkTip")},model:{value:e.item.name,callback:function(t){e.$set(e.item,"name",t)},expression:"item.name"}})],1)],1)],1),t("el-row",{staticClass:"margin_b10",attrs:{gutter:10}},[t("el-col",{attrs:{span:24}},[t("i",{staticClass:"el-icon-info",staticStyle:{color:"#FF9900"}}),t("span",{staticStyle:{color:"#818181","font-size":"13px"},domProps:{textContent:e._s(e.$t("missing.tankAppropriateThresholdTip"))}})])],1)],1),e.item.appearance>0?t("div",{staticStyle:{padding:"10px","border-top":"1px solid #C4BCBC"}},[1==e.item.appearance?t("div",{staticClass:"marking-tank-info"},[t("el-row",{staticClass:"margin_b10",attrs:{gutter:10}},[t("el-col",{attrs:{span:16}},[t("div",{staticClass:"marking-tank-info-title"},[t("span",{staticStyle:{color:"#000000"},domProps:{textContent:e._s(e.$t("device.maxVolume"))}}),t("span",{staticStyle:{color:"#75A5FF",padding:"0px 10px"}},[e._v(e._s(e.item.capacity)+"L")]),t("span",{staticStyle:{color:"#B6B6B6"}},[e._v("("+e._s(e.$t("device.saveChange"))+")")])])]),t("el-col",{attrs:{span:8}},[t("LabelWrap",{attrs:{label:e.$t("device.maxAnalogQuantity")}},[t("el-input-number",{staticStyle:{width:"100%"},attrs:{"controls-position":"right",min:1,max:65535},model:{value:e.item.maxAdValue,callback:function(t){e.$set(e.item,"maxAdValue",t)},expression:"item.maxAdValue"}})],1)],1)],1),t("el-row",{staticClass:"margin_b10",attrs:{gutter:10}},[t("el-col",{attrs:{span:8}},[t("LabelWrap",{attrs:{label:e.$t("device.tankLength")+"(cm)"}},[t("el-input",{attrs:{clearable:"",placeholder:e.$t("device.inputTankLenthTip")},model:{value:e.item.length,callback:function(t){e.$set(e.item,"length",e._n(t))},expression:"item.length"}})],1)],1),t("el-col",{attrs:{span:8}},[t("LabelWrap",{attrs:{label:e.$t("device.tankWidth")+"(cm)"}},[t("el-input",{attrs:{clearable:"",placeholder:e.$t("device.inputTankWidthTip")},model:{value:e.item.width,callback:function(t){e.$set(e.item,"width",e._n(t))},expression:"item.width"}})],1)],1),t("el-col",{attrs:{span:8}},[t("LabelWrap",{attrs:{label:e.$t("device.tankHeight")+"(cm)"}},[t("el-input",{attrs:{clearable:"",placeholder:e.$t("device.inputTankHeightTip")},model:{value:e.item.height,callback:function(t){e.$set(e.item,"height",e._n(t))},expression:"item.height"}})],1)],1)],1)],1):e._e(),2==e.item.appearance?t("div",{staticClass:"marking-tank-info"},[t("el-row",{staticClass:"margin_b10",attrs:{gutter:10}},[t("el-col",{attrs:{span:16}},[t("div",{staticClass:"marking-tank-info-title"},[t("span",{staticStyle:{color:"#000000"},domProps:{textContent:e._s(e.$t("device.maxVolume"))}}),t("span",{staticStyle:{color:"#75A5FF",padding:"0px 10px"}},[e._v(e._s(e.item.capacity)+"L")]),t("span",{staticStyle:{color:"#B6B6B6"}},[e._v("("+e._s(e.$t("device.saveChange"))+")")])])]),t("el-col",{attrs:{span:8}},[t("LabelWrap",{attrs:{label:e.$t("device.maxAnalogQuantity")}},[t("el-input-number",{staticStyle:{width:"100%"},attrs:{"controls-position":"right",min:1,max:65535},model:{value:e.item.maxAdValue,callback:function(t){e.$set(e.item,"maxAdValue",t)},expression:"item.maxAdValue"}})],1)],1)],1),t("el-row",{staticClass:"margin_b10",attrs:{gutter:10}},[t("el-col",{attrs:{span:12}},[t("LabelWrap",{attrs:{label:e.$t("device.tankHeight")+"(cm)"}},[t("el-input",{attrs:{clearable:"",placeholder:e.$t("device.inputTankHeightTip")},model:{value:e.item.height,callback:function(t){e.$set(e.item,"height",e._n(t))},expression:"item.height"}})],1)],1),t("el-col",{attrs:{span:12}},[t("LabelWrap",{attrs:{label:e.$t("device.tankDiameter")+"(cm)"}},[t("el-input",{attrs:{clearable:"",placeholder:e.$t("device.inputTankDiameterTip")},model:{value:e.item.diameter,callback:function(t){e.$set(e.item,"diameter",e._n(t))},expression:"item.diameter"}})],1)],1)],1)],1):e._e(),3==e.item.appearance?t("div",{staticClass:"marking-tank-info"},[t("el-row",{staticClass:"margin_b10",attrs:{gutter:10}},[t("el-col",{attrs:{span:16}},[t("div",{staticClass:"marking-tank-info-title"},[t("span",{staticStyle:{color:"#000000"},domProps:{textContent:e._s(e.$t("device.maxVolume"))}}),t("span",{staticStyle:{color:"#75A5FF",padding:"0px 10px"}},[e._v(e._s(e.item.capacity)+"L")]),t("span",{staticStyle:{color:"#B6B6B6"}},[e._v("("+e._s(e.$t("device.saveChange"))+")")])])]),t("el-col",{attrs:{span:8}},[t("LabelWrap",{attrs:{label:e.$t("device.maxAnalogQuantity")}},[t("el-input-number",{staticStyle:{width:"100%"},attrs:{"controls-position":"right",min:1,max:65535},model:{value:e.item.maxAdValue,callback:function(t){e.$set(e.item,"maxAdValue",t)},expression:"item.maxAdValue"}})],1)],1)],1),t("el-row",{staticClass:"margin_b10",attrs:{gutter:10}},[t("el-col",{attrs:{span:12}},[t("LabelWrap",{attrs:{label:e.$t("device.tankWidth")+"(cm)"}},[t("el-input",{attrs:{clearable:"",placeholder:e.$t("device.inputTankWidthTip")},model:{value:e.item.width,callback:function(t){e.$set(e.item,"width",e._n(t))},expression:"item.width"}})],1)],1),t("el-col",{attrs:{span:12}},[t("LabelWrap",{attrs:{label:e.$t("device.tankDiameter")+"(cm)"}},[t("el-input",{attrs:{clearable:"",placeholder:e.$t("device.inputTankDiameterTip")},model:{value:e.item.diameter,callback:function(t){e.$set(e.item,"diameter",e._n(t))},expression:"item.diameter"}})],1)],1)],1)],1):e._e(),4==e.item.appearance?t("div",{staticClass:"marking-tank-info"},[t("div",{staticClass:"marking-tank-info-title"},[t("span",{staticStyle:{color:"#000000"},domProps:{textContent:e._s(e.$t("device.maxVolume"))}}),t("span",{staticStyle:{color:"#75A5FF",padding:"0px 10px"}},[e._v(e._s(e.item.capacity)+"L")]),t("span",{staticStyle:{color:"#B6B6B6"}},[e._v("("+e._s(e.$t("device.saveChange"))+")")])]),t("el-row",{staticClass:"margin_b10",attrs:{gutter:10}},[t("el-col",{attrs:{span:8}},[t("LabelWrap",{attrs:{label:e.$t("device.scale")}},[t("el-input",{attrs:{clearable:"",placeholder:e.$t("device.inputSrcadTip")},model:{value:e.adHeight,callback:function(t){e.adHeight=e._n(t)},expression:"adHeight"}})],1)],1),t("el-col",{attrs:{span:8}},[t("LabelWrap",{attrs:{label:e.$t("device.calibratedFluid")}},[t("el-input",{attrs:{clearable:"",placeholder:e.$t("device.inputCalibratedFluidTip")},model:{value:e.adVolume,callback:function(t){e.adVolume=e._n(t)},expression:"adVolume"}})],1)],1),t("el-col",{attrs:{span:2,offset:1}},[t("el-button",{staticStyle:{height:"34px",width:"81px"},attrs:{type:"info"},on:{click:e.handleAddAd}},[e._v(e._s(e.$t("bgManage.newAddMark")))])],1)],1),t("div",{staticClass:"margin_b10"},[t("vxe-table",{attrs:{border:"",resizable:"","show-overflow":"",size:"mini",height:"160",data:e.item.markers}},[t("vxe-table-column",{attrs:{type:"seq",width:"60",title:e.$t("reportForm.index")}}),t("vxe-table-column",{attrs:{field:"height",title:e.$t("device.scale")}}),t("vxe-table-column",{attrs:{field:"volume",title:e.$t("reportForm.oil")}}),t("vxe-table-column",{attrs:{title:e.$t("reportForm.action"),width:"70"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("div",{staticStyle:{width:"48px",height:"30px","padding-top":"4px","text-align":"center",cursor:"pointer"},on:{click:function(t){return e.handleClickDelete(a)}}},[t("img",{staticStyle:{width:"22px",height:"22px"},attrs:{src:e.icon}})])]}}],null,!1,4061483848)})],1)],1),t("el-row",{attrs:{gutter:10}},[t("el-col",{attrs:{span:e.isZh?3:4,offset:e.isZh?15:12}},[t("el-button",{staticStyle:{height:"34px",width:"100%"},attrs:{type:"info"},on:{click:e.downloadTemp}},[e._v(e._s(e.$t("insure.templateDownload")))])],1),t("el-col",{attrs:{span:e.isZh?3:4}},[t("el-button",{staticStyle:{height:"34px",width:"100%"},attrs:{type:"info"},on:{click:e.importTemp}},[e._v(e._s(e.$t("common.importMark")))])],1),t("el-col",{attrs:{span:e.isZh?3:4}},[t("el-button",{staticStyle:{height:"34px",width:"100%"},attrs:{type:"info"},on:{click:e.exportTemp}},[e._v(e._s(e.$t("common.exportMark")))])],1)],1)],1):e._e()]):e._e(),t("input",{ref:"fileEl",staticStyle:{display:"none"},attrs:{type:"file"}})])}),D=[],S=(a("caad"),a("d81d"),a("2532"),a("201d")),_=a("b059"),C={name:"OilMarkingItem",props:{item:{type:Object,default:function(){return{}}},deviceid:{type:String,default:""}},data:function(){return{icon:_,remark:"",maxAdValue:65535,threshold:10,useas:0,useasOptions:[],appearanceOptions:[],length:"",width:"",height:"",adHeight:"",adVolume:"",adList:[]}},components:{LabelWrap:S["a"]},computed:Object(o["a"])({},Object(d["b"])(["isZh"])),methods:{downloadTemp:function(){var e=document.createElement("a");e.href=this.isZh?"./xlsxtemplates/oiladtemplate.xlsx":"./xlsxtemplates/oiladtemplate_en.xlsx",e.download="oiladtemplate.xlsx",e.click()},importTemp:function(){var e=this.$refs.fileEl;e.value="",e.click()},exportTemp:function(){var e=[[this.$t("device.scale"),this.$t("reportForm.oil")]];this.item.markers.forEach((function(t){var a=[t.height,t.volume];e.push(a)}));var t=this.deviceid,a=p["a"].getDeviceNameByDeviceId(t);this.devicenameAndDeviceid=a+"-"+t;var i={title:this.isZh?"测量标定":"VolumeCalibration",data:e,hideTitle:!0};new ExcelCls(i).exportExcel(this)},handleAddAd:function(){var e=this.adHeight,t=this.adVolume;if(e&&t){var a=this.item.markers,i=a.map((function(e){return e.height})),s=i.indexOf(e);i.includes(e)?a[s].volume=t:(a.push({height:e,volume:t}),a.sort((function(e,t){return t.height-e.height}))),this.adHeight="",this.adVolume=""}},handleClickDelete:function(e){var t=e.rowIndex;this.$delete(this.item.markers,t)},readWorkbookFromLocalFile:function(e,t){var a=new FileReader;a.onload=function(e){var a=e.target.result,i=new ExcelJS.Workbook;i.xlsx.load(a).then((function(){t&&t(i)}))},a.readAsBinaryString(e)},parserExcelData:function(e){console.log("worksheet",e);try{var t=[];e.eachRow({includeEmpty:!0},(function(e,a){if(a>1){var i={};e.eachCell({includeEmpty:!0},(function(e,t){switch(t){case 1:i.height=e.text;break;case 2:i.volume=e.text;break}})),t.push(i)}})),t.sort((function(e,t){return t.height-e.height})),this.item.markers=t}catch(a){console.log(a),this.$XModal.message({message:this.$t("tips.useTemplateTips"),status:"error",zIndex:9999})}}},mounted:function(){var e=this;this.excelX=["A","B"],this.$nextTick((function(){var t=e.$refs.fileEl;t.onchange=function(t){var a=t.target.files[0];e.readWorkbookFromLocalFile(a,(function(t){var a="测量标定",i=t.getWorksheet(a);void 0==i&&(a="VolumeCalibration",i=t.getWorksheet(a)),void 0==i&&(a="excel_oil",i=t.getWorksheet(a)),e.parserExcelData(i)}))}})),this.$nextTick((function(){e.useasOptions=[{label:e.$t("device.travel"),value:0},{label:e.$t("device.storage"),value:1}],e.appearanceOptions=[{label:e.$t("device.noTank"),value:0},{label:e.$t("device.cuboid"),value:1},{label:e.$t("device.verticalCylinder"),value:2},{label:e.$t("device.transverseCylinder"),value:3},{label:e.$t("device.irregular"),value:4}]}))}},T=C,M=(a("23ff"),Object(f["a"])(T,k,D,!1,null,null,null)),O=M.exports,A=a("d71b"),L=a("fa04"),I=a("e6ad"),F=a("addb2"),E=a("e173"),N={name:"OilMarkingDialog",props:{value:{type:!1,default:!1},deviceid:{type:String,default:""},deviceName:{type:String,default:""}},data:function(){return{loading:!1,activeName:"0",travelOil:!1,noTravelOil:!1,saveTemp:!1,importTemp:!1,icon1:A,icon2:L,icon3:I,importIcon:F,deleteIcon:E,oilDetectors:[{markers:[]},{markers:[]},{markers:[]},{markers:[]}],templatename:"",brand:"",model:"",filterTemp:"",allTemp:!1,tempList:[]}},computed:{title:function(){return"".concat(this.$t("device.oilMarking")," - ").concat(this.deviceName)}},components:{OilMarkingItem:O,LabelWrap:S["a"]},watch:{value:function(e){var t=this;e?(this.activeName="0",Object(m["Ab"])(this.deviceid).then((function(e){var a=e.oildetectors,i=e.combinestatus;a&&a.length&&a.forEach((function(e){e.capacity=Number(e.capacity.toFixed(2)),null==e.markers&&(e.markers=[])})),t.oilDetectors=a,t.travelOil=1==(1&i),t.noTravelOil=1==(1&i)}))):(this.saveTemp=!1,this.importTemp=!1,this.tableList=[])},importTemp:function(e){var t=this;if(e){var a=this;Object(m["zb"])(this.allTemp).then((function(e){var i=e.records;i.forEach((function(e){var t=e.oildetectors,i=t[0],s=t[1],l=t[2],o=t[3],r=0;e.oil1=a.getTankShape(i?i.appearance:0),e.oil2=a.getTankShape(s?s.appearance:0),e.oil3=a.getTankShape(l?l.appearance:0),e.oil4=a.getTankShape(o?o.appearance:0),t.forEach((function(e){0!=e.appearance&&r++})),e.oilCount=r})),t.tempList=i}))}else this.allTemp=!1,this.tempList=[]}},methods:{getTankShape:function(e){var t="";switch(e){case 0:t=this.$t("device.noTank");break;case 1:t=this.$t("device.cuboid");break;case 2:t=this.$t("device.verticalCylinder");break;case 3:t=this.$t("device.transverseCylinder");break;case 4:t=this.$t("device.irregular");break}return t},handleClose:function(){this.$emit("input",!1)},handleClickImport:function(e){var t=e.row.oildetectors;t.forEach((function(e){null==e.markers&&(e.markers=[]),e.markers.sort((function(e,t){return t.height-e.height}))})),this.oilDetectors=t,this.$XModal.message({message:this.$t("tips.importSucc"),status:"success",zIndex:9999})},handleClickDelete:function(e){var t=e.rowIndex,a=e.row.oildetectortemplateid;this.$delete(this.tempList,t),Object(m["G"])(a)},queryOilDetectorTemplate:function(){var e=this,t=this.filterTemp,a=this;Object(m["zb"])(this.allTemp).then((function(i){var s=i.records,l=[];s&&(""==t?(s.forEach((function(e){var t=e.oildetectors,i=t[0],s=t[1],l=t[2],o=t[3],r=0;e.oil1=a.getTankShape(i?i.appearance:0),e.oil2=a.getTankShape(s?s.appearance:0),e.oil3=a.getTankShape(l?l.appearance:0),e.oil4=a.getTankShape(o?o.appearance:0),t.forEach((function(e){0!=e.appearance&&r++})),e.oilCount=r})),l=s):s.forEach((function(e){if(e.templatename.indexOf(t)>-1){var i=e.oildetectors,s=i[0],o=i[1],r=i[2],n=i[3],c=0;e.oil1=a.getTankShape(s.appearance),e.oil2=a.getTankShape(o.appearance),e.oil3=a.getTankShape(r?r.appearance:0),e.oil4=a.getTankShape(n?n.appearance:0),i.forEach((function(e){0!=e.appearance&&c++})),e.oilCount=c,l.push(e)}}))),e.tempList=l}))},saveOilDetectorTemplate:function(){var e=this,t=this.templatename,a=this.model,i=this.brand,s={deviceid:this.deviceid,templatename:t,model:a,brand:i,independent:this.travelOil?0:1,oildetectors:this.oilDetectors};Object(m["mc"])(s).then((function(t){var a=t.status;0==a?e.$XModal.message({message:e.$t("tips.saveSucc"),status:"success",zIndex:9999}):1==a?e.$XModal.message({message:e.$t("tips.duplicateTemplateName"),status:"error",zIndex:9999}):e.$XModal.message({message:e.$t("tips.saveFail"),status:"error",zIndex:9999})}))},getCombinestatus:function(){var e=0;return this.travelOil&&(e|=1),this.noTravelOil&&(e|=2),e},onCommand:function(e){"save"==e?this.saveTemp=!0:this.importTemp=!0},handleSubmit:function(){var e=this,t={deviceid:this.deviceid,oildetectors:this.oilDetectors,combinestatus:this.getCombinestatus()};this.loading=!0,Object(m["nc"])(t).then((function(t){var a=t.status,i=t.oildetectors;e.loading=!1,0==a?(i&&i.length&&(i.forEach((function(e){e.capacity=Number(e.capacity.toFixed(2)),null==e.markers&&(e.markers=[])})),e.oilDetectors=i),e.$XModal.message({message:e.$t("tips.saveSucc"),status:"success",zIndex:9999}),e.handleClose()):e.$XModal.message({message:e.$t("tips.saveFail"),status:"error",zIndex:9999})}))}}},R=N,z=(a("6e7c"),Object(f["a"])(R,w,$,!1,null,null,null)),j=z.exports,q=j,W=function(){var e=this,t=e._self._c;return t("vxe-modal",{attrs:{title:e.title,value:e.value,className:"modal-padding0",width:"560px"},on:{hide:e.handleClose,close:e.handleClose}},[t("div",{staticClass:"weight-marking"},[t("input",{ref:"fileEl",staticStyle:{display:"none"},attrs:{type:"file"}}),t("el-row",{staticClass:"margin_b10",attrs:{gutter:10}},[t("el-col",{attrs:{span:12}},[t("LabelWrap",{attrs:{label:e.$t("device.communicationProtocol")}},[t("el-select",{staticStyle:{width:"100%"},model:{value:e.protocoltype,callback:function(t){e.protocoltype=t},expression:"protocoltype"}},[t("el-option",{attrs:{label:"河北重优",value:1}}),t("el-option",{attrs:{label:"上海通立",value:2}})],1)],1)],1),t("el-col",{attrs:{span:12}},[t("LabelWrap",{attrs:{label:e.$t("device.sensorChannel")}},[t("el-select",{staticStyle:{width:"100%"},model:{value:e.weightindex,callback:function(t){e.weightindex=t},expression:"weightindex"}},[t("el-option",{attrs:{label:"1",value:0}}),t("el-option",{attrs:{label:"2",value:1}}),t("el-option",{attrs:{label:"3",value:2}}),t("el-option",{attrs:{label:"4",value:3}})],1)],1)],1)],1),t("div",{staticStyle:{"border-top":"8px solid #f7f7f7","padding-top":"10px"}},[t("el-row",{staticClass:"margin_b10",attrs:{gutter:10}},[t("el-col",{attrs:{span:10}},[t("LabelWrap",{attrs:{label:e.$t("device.scale")}},[t("el-input",{attrs:{clearable:""},model:{value:e.advalue,callback:function(t){e.advalue=e._n(t)},expression:"advalue"}})],1)],1),t("el-col",{attrs:{span:10}},[t("LabelWrap",{attrs:{label:e.$t("device.weightValue")}},[t("el-input",{attrs:{clearable:""},model:{value:e.weight,callback:function(t){e.weight=e._n(t)},expression:"weight"}})],1)],1),t("el-col",{attrs:{span:4}},[t("el-button",{staticStyle:{width:"100%"},attrs:{type:"primary"},on:{click:e.handleAdd}},[e._v(e._s(e.$t("bgManage.newAddMark")))])],1)],1),t("div",{staticClass:"margin_b10"},[t("vxe-table",{attrs:{border:"",resizable:"","show-overflow":"","highlight-current-row":"",size:"mini",height:"180",data:e.weightList}},[t("vxe-table-column",{attrs:{type:"seq",width:"60",title:e.$t("reportForm.index")}}),t("vxe-table-column",{attrs:{field:"advalue",title:e.$t("device.scale"),sortable:""}}),t("vxe-table-column",{attrs:{field:"weight",title:e.$t("device.weightValue"),sortable:""}}),t("vxe-table-column",{attrs:{title:e.$t("reportForm.action"),width:"60"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("div",{staticStyle:{padding:"7px 0px 0px 4px"}},[t("el-popconfirm",{attrs:{placement:"top",icon:"el-icon-info","icon-color":"red","confirm-button-text":e.$t("common.confirm"),"cancel-button-text":e.$t("common.cancel"),title:e.$t("tips.confirmDelete")},on:{confirm:function(t){return e.handleDelete(a)}}},[t("span",{attrs:{slot:"reference"},slot:"reference"},[t("img",{staticStyle:{width:"16px",cursor:"pointer"},attrs:{src:e.deleteIcon}})])])],1)]}}])})],1)],1),t("el-row",{attrs:{gutter:10}},[t("el-col",{attrs:{span:e.isZh?4:5,offset:e.isZh?12:9}},[t("el-button",{staticStyle:{width:"100%"},attrs:{type:"primary"},on:{click:e.handleImport}},[e._v(e._s(e.$t("device.importData")))])],1),t("el-col",{attrs:{span:e.isZh?4:5}},[t("el-button",{staticStyle:{width:"100%"},attrs:{type:"primary"},on:{click:e.handleExport}},[e._v(e._s(e.$t("common.exportData")))])],1),t("el-col",{attrs:{span:e.isZh?4:5}},[t("el-button",{staticStyle:{width:"100%"},attrs:{type:"primary"},on:{click:e.downloadTemp}},[e._v(e._s(e.$t("insure.templateDownload")))])],1)],1)],1)],1),t("div",{staticStyle:{"margin-top":"10px","text-align":"center",height:"70px","padding-top":"20px"}},[t("el-button",{staticStyle:{width:"120px"},attrs:{type:"primary",loading:e.loading},on:{click:e.handleSendDevice}},[e._v(e._s(e.$t("device.sendToDevice")))]),t("el-button",{staticStyle:{width:"120px"},attrs:{type:"primary",loading:e.qloading},on:{click:e.handleOnlineQuery}},[e._v(e._s(e.$t("device.onlineQuery")))])],1)])},U=[],X=(a("baa5"),a("fb6a"),a("4795"),a("e173")),B={name:"WeightMarkingDialog",props:{value:{type:Boolean,default:!1},deviceid:{type:String,default:""},deviceName:{type:String,default:""}},data:function(){return{deleteIcon:X,loading:!1,qloading:!1,protocoltype:1,weightindex:0,advalue:"",weight:"",weightList:[]}},components:{LabelWrap:S["a"]},computed:Object(o["a"])(Object(o["a"])({},Object(d["b"])(["isZh"])),{},{title:function(){return"".concat(this.$t("device.weightMarking")," - ").concat(this.deviceName)}}),watch:{value:function(e){var t=this;e?(this.qloading=!1,this.loading=!1,setTimeout((function(){var e=t.$refs.fileEl;e.onchange=function(e){var a=e.srcElement.value.lastIndexOf("."),i=e.srcElement.value.slice(a);if(-1!=i.indexOf("xlsx")){var s=e.target.files[0];t.readWorkbookFromLocalFile(s,(function(e){var a="载重标定",i=e.getWorksheet(a);void 0==i&&(a="weightmarker",i=e.getWorksheet(a)),t.parserExcelData(i)}))}else t.$XModal.message({message:t.$t("insure.importExcelTips"),status:"error",zIndex:9999})}}),1e3)):(this.advalue="",this.weight="",this.weightList=[])}},methods:{handleDelete:function(e){this.$delete(this.weightList,e.rowIndex)},downloadTemp:function(){var e=document.createElement("a");e.href=this.isZh?"./xlsxtemplates/weightemplate.xlsx":"./xlsxtemplates/weightemplate_en.xlsx",e.download="weightemplate.xlsx",e.click()},handleImport:function(){var e=this.$refs.fileEl;e.value="",e.click()},handleExport:function(){var e=[[this.$t("device.scale"),this.$t("device.weightValue")]];this.weightList.forEach((function(t){var a=[t.advalue,t.weight];e.push(a)}));var t=this.deviceid,a=p["a"].getDeviceNameByDeviceId(t);this.devicenameAndDeviceid=a+"-"+t;var i={title:this.isZh?"载重标定":"weightmarker",data:e,devicename:a,hideTitle:!0};new ExcelCls(i).exportExcel(this)},handleClose:function(){this.$emit("input",!1)},handleAdd:function(){var e=this.advalue,t=this.weight;if(e&&t){var a=this.weightList.map((function(e){return e.advalue}));a.includes(e)||(this.weightList.push({advalue:e,weight:t}),this.weightList.sort((function(e,t){return e.advalue-t.advalue})),this.advalue="",this.weight="")}},handleSendDevice:function(){var e=this;if(!this.qloading){this.loading=!0;var t={deviceid:this.deviceid,weightindex:this.weightindex,markers:this.weightList,protocoltype:this.protocoltype};Object(m["pc"])(t).then((function(t){var a=t.status,i=t.cause;e.loading=!1,0==a?e.$XModal.message({message:e.$t("monitor.CMD_SEND_RESULT_UNCONFIRM"),status:"error",zIndex:9999}):1===a?e.$XModal.message({message:e.$t("monitor.CMD_SEND_RESULT_PASSWORD_ERROR"),status:"error",zIndex:9999}):2===a?e.$XModal.message({message:e.$t("monitor.CMD_SEND_RESULT_OFFLINE_NOT_CACHE"),status:"error",zIndex:9999}):3===a?e.$XModal.message({message:e.$t("monitor.CMD_SEND_RESULT_OFFLINE_CACHED"),status:"error",zIndex:9999}):4===a?e.$XModal.message({message:e.$t("monitor.CMD_SEND_RESULT_MODIFY_DEFAULT_PASSWORD"),status:"error",zIndex:9999}):5===a?e.$XModal.message({message:e.$t("monitor.CMD_SEND_RESULT_DETAIL_ERROR")+i,status:"error",zIndex:9999}):6===a?e.$XModal.message({message:e.$t("tips.saveSucc")+i,status:"success",zIndex:9999}):7===a?e.$XModal.message({message:e.$t("monitor.CMD_SEND_OVER_RETRY_TIMES"),status:"error",zIndex:9999}):8===a&&e.$XModal.message({message:e.$t("monitor.CMD_SEND_SYNC_TIMEOUT")+i,status:"error",zIndex:9999})}))}},handleOnlineQuery:function(){var e=this;if(0==this.loading){this.qloading=!0;var t={deviceid:this.deviceid,weightindex:this.weightindex,protocoltype:this.protocoltype};Object(m["Wb"])(t).then((function(t){var a=t.markers;e.qloading=!1,null!=a&&(e.weightList=a)}))}},readWorkbookFromLocalFile:function(e,t){var a=new FileReader;a.onload=function(e){var a=e.target.result,i=new ExcelJS.Workbook;i.xlsx.load(a).then((function(){t&&t(i)}))},a.readAsBinaryString(e)},parserExcelData:function(e){try{var t=[];e.eachRow({includeEmpty:!0},(function(e,a){if(a>1){var i={};e.eachCell({includeEmpty:!0},(function(e,t){switch(t){case 1:i.advalue=e.text;break;case 2:i.weight=e.text;break}})),t.push(i)}})),this.weightList=t}catch(a){this.$XModal.message({message:this.$t("insure.importExcelFailTips"),status:"error",zIndex:9999})}}},mounted:function(){this.excelX=["A","B","C"]}},P=B,V=(a("7dc0"),Object(f["a"])(P,W,U,!1,null,null,null)),Q=V.exports,Z=Q,Y=function(){var e=this,t=e._self._c;return t("vxe-modal",{attrs:{title:e.title,className:"modal-padding0",value:e.value,width:"560px"},on:{hide:e.handleClose,close:e.handleClose}},[t("el-row",{staticClass:"margin_b10"},[t("el-col",{staticStyle:{"line-height":"32px"},attrs:{span:4,offset:1}},[e._v(" "+e._s(e.$t("device.ioNumber"))+" ")]),t("el-col",{attrs:{span:5,offset:4}},[t("el-input-number",{staticStyle:{width:"100%"},attrs:{min:0,max:16,"controls-position":"right"},model:{value:e.num,callback:function(t){e.num=t},expression:"num"}})],1),t("el-col",{staticStyle:{"text-align":"right","padding-right":"10px"},attrs:{span:10}},[t("el-button",{staticStyle:{width:"100px"},attrs:{type:"primary"},on:{click:function(t){e.setVideoParamesDialog=!0}}},[e._v(e._s(e.$t("device.copy")))])],1)],1),t("div",{staticStyle:{"max-height":"210px","overflow-x":"hidden","overflow-y":"auto","border-top":"1px solid #ebeef5","padding-top":"10px"}},e._l(e.ioList,(function(a,i){return t("el-row",{key:i,staticClass:"margin_b10",attrs:{gutter:10}},[t("el-col",{attrs:{span:11,offset:1}},[t("LabelWrap",{attrs:{label:e.$t("device.io".concat(i+1,"Open"))}},[t("el-input",{attrs:{clearable:""},model:{value:a.ioOpen,callback:function(t){e.$set(a,"ioOpen",t)},expression:"item.ioOpen"}})],1)],1),t("el-col",{attrs:{span:11}},[t("LabelWrap",{attrs:{label:e.$t("device.io".concat(i+1,"Close"))}},[t("el-input",{attrs:{clearable:""},model:{value:a.ioClose,callback:function(t){e.$set(a,"ioClose",t)},expression:"item.ioClose"}})],1)],1)],1)})),1),t("div",{staticStyle:{"text-align":"center",height:"70px","padding-top":"20px"}},[t("el-button",{staticStyle:{width:"120px"},attrs:{type:"primary"},on:{click:e.handleSubmit}},[e._v(e._s(e.$t("common.determine")))]),t("VideoParamesDialog",{ref:"ioParames",attrs:{isVedeo:!1},on:{onResetPassword:e.onIoSetting},model:{value:e.setVideoParamesDialog,callback:function(t){e.setVideoParamesDialog=t},expression:"setVideoParamesDialog"}})],1)],1)},H=[],J=a("26c6"),K=a("368a"),G={name:"IoMarkingDialog",props:{value:{type:Boolean,default:!1},deviceid:{type:String,default:""},deviceName:{type:String,default:""}},components:{LabelWrap:S["a"],SingleChoiceVehicle:J["a"],VideoParamesDialog:K["a"]},data:function(){return{num:0,vehicleid:"",ioList:[],setVideoParamesDialog:!1}},watch:{value:function(e){var t=this;e?Object(m["wb"])(this.deviceid).then((function(e){var a=e.records;if(a){var i=[];t.num=a.length,a.forEach((function(e){i.push({ioOpen:e.openstr,ioClose:e.closestr})})),t.ioList=i}else t.num=0,t.$XModal.message({message:t.$t("tips.noData"),status:"error",zIndex:9999})})):setTimeout((function(){t.ioList=[],t.num=0}),1e3)},num:function(e){var t=this.ioList.length;if(e>t){var a=e-t,i=0;while(i<a)i++,this.ioList.push({ioOpen:"",ioClose:""})}else this.ioList.length=e}},computed:{title:function(){return"".concat(this.$t("device.ioConfig")," - ").concat(this.deviceName)}},methods:{handleClose:function(){this.$emit("input",!1)},onIoSetting:function(e){var t=e.deviceid;this.vehicleid=t,this.setVideoParamesDialog=!1,this.$refs.ioParames.loading=!1,this.handleConsult()},handleConsult:function(){var e=this;this.vehicleid?Object(m["wb"])(this.vehicleid).then((function(t){var a=t.records;if(a){var i=[];e.num=a.length,a.forEach((function(e){i.push({ioOpen:e.openstr,ioClose:e.closestr})})),e.ioList=i}else e.num=0,e.ioList=[]})):this.$XModal.message({message:this.$t("tips.selectDevice"),status:"error",zIndex:9999})},handleSubmit:function(){var e=this,t={deviceid:this.deviceid,records:[]};this.ioList.forEach((function(e,a){t.records.push({index:a+1,openstr:e.ioOpen,closestr:e.ioClose})})),Object(m["rc"])(t).then((function(t){var a=t.status;0==a?(e.$XModal.message({message:e.$t("tips.setSucc"),status:"success",zIndex:9999}),e.handleClose()):e.$XModal.message({message:e.$t("tips.setFail"),status:"error",zIndex:9999})}))}}},ee=G,te=Object(f["a"])(ee,Y,H,!1,null,null,null),ae=te.exports,ie=ae,se=a("f1b2"),le=a("4d3b"),oe=function(){var e=this,t=e._self._c;return t("vxe-modal",{attrs:{title:e.title,className:"modal-padding0",value:e.value,width:"680px"},on:{hide:e.handleClose,close:e.handleClose}},[t("vxe-table",{attrs:{border:"",resizable:"","show-overflow":"","highlight-hover-row":"",size:"mini",height:"240",data:e.tableList}},[t("vxe-table-column",{attrs:{type:"seq",width:"60",title:e.$t("reportForm.index")}}),t("vxe-table-column",{attrs:{field:"username",title:e.$t("device.tutelageUser")}}),t("vxe-table-column",{attrs:{field:"nickname",title:e.$t("bgManage.nickname")}}),t("vxe-table-column",{attrs:{field:"deviceid",title:e.$t("alarm.devNum")}}),t("vxe-table-column",{attrs:{field:"bindtimeStr",title:e.$t("reportForm.time"),width:"100"}}),t("vxe-table-column",{attrs:{field:"bindstateStr",title:e.$t("bgManage.type"),width:"60"}}),t("vxe-table-column",{attrs:{title:e.$t("reportForm.action"),width:"80"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-popconfirm",{attrs:{placement:"top",icon:"el-icon-info","icon-color":"red","confirm-button-text":e.$t("common.confirm"),"cancel-button-text":e.$t("common.cancel"),title:e.$t("tips.confirmUnbind")},on:{confirm:function(t){return e.handleDelete(a)}}},[t("el-button",{attrs:{slot:"reference",type:"danger",size:"mini"},slot:"reference"},[e._v(e._s(e.$t("common.unbind")))])],1)]}}])})],1)],1)},re=[],ne={name:"BindUsersDialog",props:{value:{type:Boolean,default:!1},deviceid:{type:String,default:""}},data:function(){return{deviceName:"",tableList:[]}},watch:{value:function(e){var t=this;e&&(this.deviceName=p["a"].getDeviceNameByDeviceId(this.deviceid),Object(m["fb"])(this.deviceid).then((function(e){var a=e.binds;console.log("result",a);var i=[];a&&a.length&&(a.forEach((function(e){e.bindtimeStr=u["a"].format(new Date(e.bindtime),"yyyy-MM-dd"),e.bindstateStr=1==e.bindstate?t.$t("bgManage.master"):t.$t("bgManage.slave")})),i=a),t.tableList=i})))}},computed:{title:function(){return"".concat(this.$t("device.tutelageUser")," - ").concat(this.deviceName)}},methods:{handleClose:function(){this.$emit("input",!1)},handleDelete:function(e){var t=this,a=e.rowIndex,i=e.row,s={operator:i.username,deviceid:i.deviceid,username:i.username};Object(m["ac"])(s).then((function(e){var i=e.status;0==i?(t.$delete(t.tableList,a),t.$XModal.message({message:t.$t("device.actionSucc"),status:"success",zIndex:9999})):1==i?t.$XModal.message({message:t.$t("device.actionFail"),status:"error",zIndex:9999}):2==i?t.$XModal.message({message:t.$t("tips.noPermission"),status:"error",zIndex:9999}):t.$XModal.message({message:t.$t("device.actionFail"),status:"error",zIndex:9999})}))}}},ce=ne,de=Object(f["a"])(ce,oe,re,!1,null,null,null),me=de.exports,pe=me,ue=function(){var e=this,t=e._self._c;return t("vxe-modal",{attrs:{title:e.title,value:e.value,className:"modal-padding0",width:"360px"},on:{hide:e.handleClose,close:e.handleClose}},[t("div",{staticStyle:{"text-align":"center"}},[t("div",[t("i",{staticClass:"el-icon-warning",staticStyle:{color:"#f56c6c"}}),t("span",{staticStyle:{color:"#f56c6c","padding-left":"4px"},domProps:{textContent:e._s(e.$t("tips.replaceDeviceTip"))}})])]),t("div",{staticClass:"margin_b10 noselect",staticStyle:{"margin-top":"18px"}},[t("LabelWrap",{attrs:{label:e.$t("device.oldDeviceid")}},[t("el-input",{attrs:{clearable:"",disabled:""},model:{value:e.deviceid,callback:function(t){e.deviceid=t},expression:"deviceid"}})],1)],1),t("div",{staticClass:"margin_b10 noselect",staticStyle:{"margin-top":"18px"}},[t("LabelWrap",{attrs:{label:e.$t("device.newDeviceid")}},[t("el-input",{attrs:{clearable:""},model:{value:e.newDeviceid,callback:function(t){e.newDeviceid=t},expression:"newDeviceid"}})],1)],1),t("div",{staticStyle:{"text-align":"center",height:"60px","padding-top":"20px"}},[t("el-button",{staticStyle:{width:"120px"},attrs:{type:"primary",loading:e.loading},on:{click:e.handleClick}},[e._v(e._s(e.$t("common.determine")))])],1)])},he=[],ve={name:"ReplaceDeviceDialog",props:{value:{type:Boolean,default:!1},deviceid:{type:String,default:""},deviceName:{type:String,default:""}},components:{LabelWrap:S["a"]},data:function(){return{loading:!1,newDeviceid:""}},watch:{value:function(e){}},computed:{title:function(){return"".concat(this.$t("device.replaceDevice")," - ").concat(this.deviceName)}},methods:Object(o["a"])(Object(o["a"])({},Object(d["c"])(["isZh","setIsReloadRootuser","setReportTagList"])),{},{handleClose:function(){this.$emit("input",!1)},handleClick:function(){var e=this,t=(this.isZh,{olddeviceid:this.deviceid,newdeviceid:this.newDeviceid});if(""!=t.newdeviceid){var a=this.$store.state.deviceTypes;Object(m["bc"])(t).then((function(i){var s=i.status,l=i.cause,o=i.newdevice,r=i.olddevice;0==s?(Object.assign(cacheMgr.deviceInfos[t.olddeviceid],r),cacheMgr.deviceInfos[t.newdeviceid]=o,o.hasFunctions=Object(h["D"])(o,a),cacheMgr.addDevice(o),e.$XModal.message({message:e.$t("missing.replacementSucceeded"),status:"success",zIndex:9999}),e.setReportTagList([]),e.setIsReloadRootuser(!0),e.handleClose()):-1==s?e.$XModal.message({message:e.$t("missing.replacementFailed")+":"+l,status:"error",zIndex:9999}):1==s?e.$XModal.message({message:e.$t("missing.oldEquipmentDoesNotExis"),status:"error",zIndex:9999}):2==s?e.$XModal.message({message:e.$t("missing.newEquipmentSerialNumberAlreadyExists"),status:"error",zIndex:9999}):3==s&&e.$XModal.message({message:e.$t("missing.addNewDeviceException")+":"+l,status:"error",zIndex:9999})}))}}})},ge=ve,be=Object(f["a"])(ge,ue,he,!1,null,null,null),fe=be.exports,xe=fe,ye=a("2df7"),we=a("b562"),$e=a("7cf8"),ke=a("4c3c"),De=a("61fc"),Se=a("e173"),_e=a("7b49"),Ce={name:"QueryDevice",data:function(){return{totalColumns:["devicename","deviceid","deviceType","creater","groupName","simiccid","simnum","addTime","initloctimeStr","firstLocTime","installtimeStr","expireTime","alarmactionStr","loginenableStr","distanceratio","remark"],editIcon:De,deleteIcon:Se,moreIcon:_e,loading:!1,editDialog:!1,recordsDialog:!1,oilMarkDiglog:!1,editDiglog:!1,weightDialog:!1,ioDialog:!1,tempDialog:!1,replaceDialog:!1,bindUsersDialog:!1,queryText:"",queryType:"0",tableList:[],packages:[],totalcount:0,deviceid:"",deviceName:"",currentRow:{},pageSize:20,currentPage:1,exportLoading:!1,exportAllLoading:!1}},mixins:[v["a"],ke["a"]],components:{LabelWrap:r["a"],RecordsDialog:y,OilMarkingDialog:q,EditDevice:se["a"],WeightMarkingDialog:Z,IoMarkingDialog:ie,TempMarkingDialog:le["a"],ReplaceDeviceDialog:xe,ZtreeDeviceDropdown:ye["a"],BindUsersDialog:pe},computed:Object(o["a"])(Object(o["a"])({},Object(d["b"])(["isZh","deviceTypes","isQueryInitData","userType","permissionList"])),{},{isDeleteDevicePermission:function(){return-1!=this.permissionList.indexOf("manage-managedevice-querydevice-deletedevice")}}),watch:{isQueryInitData:function(e){var t=this;e&&Object(we["Z"])({filterenabled:0}).then((function(e){var a=e.packages;a=a||[],a.forEach((function(e){e.packagename=Object(h["Y"])(e)})),t.packages=a;var i={count:t.pageSize,keyword:t.queryText,offset:1,all:!1,expiredays:0};t.queryDevices(i)}))},queryType:function(){this.totalcount=0;var e={count:this.pageSize,keyword:this.queryText,offset:0,all:!1,expiredays:Number(this.queryType)};this.queryDevices(e)}},destroyed:function(){this.tableList=null},methods:Object(o["a"])(Object(o["a"])({},Object(d["c"])(["setIsReloadRootuser","setReportTagList"])),{},{onEditSucc:function(e){var t=e.deviceid,a=this.deviceTypes,i=a[e.devicetype].typename;this.currentRow.deviceType=i,this.currentRow.devicename=e.devicename,this.currentRow.creater=e.creater,this.currentRow.simiccid=e.simiccid,this.currentRow.simnum=e.simnum,this.currentRow.offlinedelay=e.offlinedelay,this.currentRow.parkdrifting=e.parkdrifting,this.currentRow.parktimeout=e.parktimeout,this.currentRow.loginenableStr=0==e.loginenable?this.$t("bgManage.ban"):this.$t("bgManage.allow"),this.currentRow.installtimeStr=u["a"].format(new Date(e.installtime),"yyyy-MM-dd"),p["a"].deviceInfos[t].offlinedelay=e.offlinedelay},cellDblclick:function(e){this.handleEdit(e)},exportData:function(){var e=[[this.$t("reportForm.index"),this.$t("alarm.devName"),this.$t("alarm.devNum"),this.$t("reportForm.deviceType"),"ICCID",this.$t("reportForm.sim"),this.$t("reportForm.addTime"),this.$t("reportForm.initLocTime"),this.$t("reportForm.firstLocTime"),this.$t("reportForm.installTime"),this.$t("alarm.expireTime"),this.$t("reportForm.creater"),this.$t("reportForm.groupName"),this.$t("reportForm.remarks"),this.$t("device.tutelageUser"),this.$t("reportForm.bindPwd"),this.$t("reportForm.vinno")]],t=this.userType;this.tableList.forEach((function(a,i){var s=[];s.push(++i),s.push(a.devicename),s.push(a.deviceid),s.push(a.deviceType),s.push(a.simiccid?a.simiccid:""),s.push(a.simnum?a.simnum:""),s.push(a.addTime),s.push(a.initloctimeStr),s.push(a.firstLocTime),s.push(a.installtimeStr),s.push(a.expireTime),s.push(a.creater),s.push(a.groupName),t<2?s.push(a.remark?a.remark:""):s.push(a.remark2?a.remark2:""),s.push(a.monitor?a.monitor:""),s.push(a.bindpwd?a.bindpwd:""),s.push(a.vin?a.vin:""),e.push(s)}));var a={title:this.$t("bgManage.deviceList"),data:e,dateRange:null};new ExcelCls(a).exportExcel(this)},exportDataAll:function(){var e=this,t=[[this.$t("reportForm.index"),this.$t("alarm.devName"),this.$t("alarm.devNum"),this.$t("reportForm.deviceType"),"ICCID",this.$t("reportForm.sim"),this.$t("reportForm.addTime"),this.$t("reportForm.initLocTime"),this.$t("reportForm.firstLocTime"),this.$t("reportForm.installTime"),this.$t("alarm.expireTime"),this.$t("reportForm.creater"),this.$t("reportForm.groupName"),this.$t("bgManage.mileageRatio"),this.$t("reportForm.remarks"),this.$t("device.tutelageUser"),this.$t("reportForm.bindPwd"),this.$t("reportForm.vinno")]],a=this.userType,i=this.deviceTypes,s=p["a"].deviceInfos;this.exportAllLoading=!0,Object(m["pb"])({all:!1,keyword:this.queryText,count:this.totalcount,offset:0,expiredays:Number(this.queryType)}).then((function(l){var o=l.devices;if(e.exportAllLoading=!1,o){o.forEach((function(l,o){var r=[],n="",c=s[l.deviceid];c&&(n=0==c.groupid?e.$t("common.defaultGroup"):c.groupname);var d=u["a"].format(new Date(l.createtime),"yyyy-MM-dd"),m=0==l.initloctime?"-":u["a"].format(new Date(l.initloctime),"yyyy-MM-dd"),p=0==l.firstloctime?"-":u["a"].format(new Date(l.firstloctime),"yyyy-MM-dd"),h=0==l.installtime?"-":u["a"].format(new Date(l.installtime),"yyyy-MM-dd"),v=i[l.devicetype].typename,g=u["a"].format(new Date(l.expirenotifytime),"yyyy-MM-dd");r.push(++o),r.push(l.devicename),r.push(l.deviceid),r.push(v),r.push(l.simiccid?l.simiccid:""),r.push(l.simnum?l.simnum:""),r.push(d),r.push(m),r.push(p),r.push(h),r.push(g),r.push(l.creater),r.push(n),r.push(l.distanceratio+"%"),a<2?r.push(l.remark?l.remark:""):r.push(l.remark2?l.remark2:""),r.push(l.monitor?l.monitor:""),r.push(l.bindpwd?l.bindpwd:""),r.push(l.vin?l.vin:""),t.push(r)}));var r={title:e.$t("bgManage.deviceList"),data:t,dateRange:null,exportMaxLength:1e5};new ExcelCls(r).exportExcel(e)}})).catch((function(t){e.exportAllLoading=!1}))},onCommand:function(e){var t=this,a=this.isZh;switch(e){case"oil":this.oilMarkDiglog=!0;break;case"temp":this.tempDialog=!0;break;case"weight":this.weightDialog=!0;break;case"io":this.ioDialog=!0;break;case"password":Object(m["ec"])(this.currentRow.deviceid).then((function(e){var i=e.status,s=e.cause,l=e.newpass;a?0==i?t.$XModal.message({message:"重置密码成功,新密码:"+l,status:"success",zIndex:9999}):t.$XModal.message({message:"重置密码失败:"+s,status:"error",zIndex:9999}):0==i?t.$XModal.message({message:"Password reset succeeded. New password:"+l,status:"success",zIndex:9999}):t.$XModal.message({message:"Password reset failed:"+s,status:"error",zIndex:9999})}));break;case"records":this.recordsDialog=!0;break;case"bindUsers":this.bindUsersDialog=!0;break;case"cleanPosi":this.$confirm(this.$t("bgManage.clearTheLastPosition"),{title:this.$t("bgManage.tip"),center:!0,customClass:"MessageBox_confirm"}).then((function(e){if("confirm"==e){var a=t.currentRow.deviceid;Object(m["r"])({deviceid:a}).then((function(e){var i=e.status;0==i?(delete p["a"].lastPositions[a],t.$XModal.message({message:t.$t("tips.setSucc"),status:"success",zIndex:9999})):t.$XModal.message({message:t.$t("tips.setFail"),status:"error",zIndex:9999})})).catch((function(e){console.log(e)}))}})).catch((function(e){}));break;case"cleanRecord":this.$confirm(this.$t("bgManage.clearTheHistoryTrack"),{title:this.$t("bgManage.tip"),center:!0,customClass:"MessageBox_confirm"}).then((function(e){"confirm"==e&&Object(m["q"])(t.currentRow.deviceid).then((function(e){var a=e.status;0==a?t.$XModal.message({message:t.$t("tips.setSucc"),status:"success",zIndex:9999}):t.$XModal.message({message:t.$t("tips.setFail"),status:"error",zIndex:9999})}))})).catch((function(e){}));break;case"replaceDevice":this.replaceDialog=!0;break;case"simDetails":var i=this.currentRow.deviceid;Object($e["V"])(i).then((function(e){var a=e.status,i=e.accessurl;if(0==a){var s=document.createElement("a");s.setAttribute("target","_blank"),s.href=i,s.click()}else 1==a?t.$XModal.message({message:t.$t("tips.noPermission"),status:"success",zIndex:9999}):2==a?t.$XModal.message({message:t.$t("tips.deviceNotIncludedSim"),status:"success",zIndex:9999}):3==a&&t.$XModal.message({message:t.$t("tips.notFoundSim"),status:"success",zIndex:9999})}));break}},handleEdit:function(e){this.currentRow=e.row,this.deviceid=e.row.deviceid,this.deviceName=e.row.devicename,this.editDialog=!0},currentChangeEvent:function(e){var t=e.row;this.currentRow=t,this.deviceid=t.deviceid,this.deviceName=t.devicename},handleClickQuery:function(){var e={count:this.pageSize,keyword:this.queryText,offset:0,all:!1,expiredays:0};this.queryDevices(e)},handleDelete:function(e){var t=this,a=e.row,i=e.rowIndex,s=a.deviceid,l=a.groupid,o=a.creater,r=p["a"].deviceInfos;Object(m["C"])({deviceid:s}).then((function(e){var a=e.status;0==a?(t.$delete(t.tableList,i),t.totalcount--,delete r[s],delete p["a"].lastPositions[s],p["a"].removeDevice(o,l,s),t.setReportTagList([]),t.setIsReloadRootuser(!0),t.$XModal.message({message:t.$t("tips.deleteSucc"),status:"success",zIndex:9999})):t.$XModal.message({message:t.$t("tips.deleteFail"),status:"error",zIndex:9999})}))},getAlarmActionStr:function(e){var t=this.$t("bgManage.platform");return 1==(1&e)&&(t+="+"+this.$t("bgManage.voice")),2==(2&e)&&(t+="+"+this.$t("bgManage.pop_up")),4==(4&e)&&(t+="+"+this.$t("common.weChat")),8==(8&e)&&(t+="+"+this.$t("bgManage.relieve")),t},queryDevices:function(e){var t=this;this.loading=!0;var a=this.packages,i=this.deviceTypes,s=p["a"].deviceInfos;Object(m["pb"])(e).then((function(e){var l=e.devices,o=e.totalcount;t.totalcount=o,l.forEach((function(e){var l=e.deviceid,o=s[l],r="-";try{r=i[e.devicetype].typename}catch(n){console.log(e)}e.installtime||(e.installtime=0),Object(h["tb"])(e,a,e.packageids),e.addTime=u["a"].format(new Date(e.createtime),"yyyy-MM-dd"),e.expireTime=u["a"].format(new Date(e.expirenotifytime),"yyyy-MM-dd"),e.initloctimeStr=0==e.initloctime?"-":u["a"].format(new Date(e.initloctime),"yyyy-MM-dd"),e.firstLocTime=0==e.firstloctime?"-":u["a"].format(new Date(e.firstloctime),"yyyy-MM-dd"),e.installtimeStr=0==e.installtime?"-":u["a"].format(new Date(e.installtime),"yyyy-MM-dd"),e.deviceType=r,e.alarmactionStr=t.getAlarmActionStr(e.alarmaction),e.loginenableStr=0==e.loginenable?t.$t("bgManage.ban"):t.$t("bgManage.allow"),o&&(0==o.groupid?e.groupName=t.$t("common.defaultGroup"):e.groupName=o.groupname)})),t.tableList=l,t.loading=!1})).catch((function(e){console.log(e),t.loading=!1}))},currentChangePage:function(e){var t={count:this.pageSize,keyword:this.queryText,offset:e-1,all:!1,expiredays:0};this.queryDevices(t)},handleSizeChange:function(e){this.pageSize=e,this.currentChangePage(this.currentPage)},handleCurrentChange:function(e){this.currentChangePage(e)}}),mounted:function(){var e=this;this.isQueryInitData&&Object(we["Z"])({filterenabled:0}).then((function(t){var a=t.packages;a=a||[],a.forEach((function(e){e.packagename=Object(h["Y"])(e)})),e.packages=a;var i={count:e.pageSize,keyword:e.queryText,offset:0,all:!1,expiredays:0};e.queryDevices(i)}))}},Te=Ce,Me=(a("3133"),Object(f["a"])(Te,s,l,!1,null,null,null)),Oe=Me.exports;t["default"]=Oe},addb2:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAYAAACM/rhtAAAAAXNSR0IArs4c6QAABC1JREFUWEftmF9oW3UUxz/ntiZTcI7Q3sYymYpDnUPFgRN8WeeEzRehMBRRmajIhg92sOa2e8jy4HJTtfNlIkyGMETEyaQqCtP6JjJB9MHV6RAZE5Obus0JronJPZK06W7ucvOnSUYfdt+Sc37f8/md37/z+wnL/JNlzsc1wHZHKDCD0TFd5yovCGxTuA0ItxtsoX1O4TeBLwzhnXRSTtbTvQJwXVxDs3kmUXYCRoeggmRchEOhOUbOHpBLtZyqAMtwOT4DtnQZzC8/3Rdm28mE5P2GKkDT0oPArqsMNx9OOOgk5eVAwGhM73GFH4Eej9OvCFYhxJfnEnKxE+CRuK7szbMFxQbWejSLhnJfOiU/eeMsZrA/pgdEeMVj/CUfZuOFhFzoBJhfY1VcV4VyfAvcWbGp8mY2JSM1AQcsnVG4q2IUeCpjy/vdgKtommM6jPKRJ+bPGVvurgloWpoDQhVjj7Lmz5ScaQQ4uE9vyF9iaEWe6aCVGKTRN6o3GgbeqZN3bKnazhaH2LRUvUKGYKaTkq0HOLhXbykUmEJYK8KTmaR82qhDfrs/rmNL1cINBJQCA5nXxQnsvaUbDPgKuKm8CIXHM0mZWhaA/ZZuFfjcBzPs2HLsqgEGDbEZ05cQ3q4BchaYwuVjZ0KONwu65CGuBWhaOglUbQO1QBRmRHjXCTFJQgr1YDsGOBDTwyo812xmFvxOi7I7k5JPgtq1DRgd0/6iywciDLUIt+iuwv5sUvbWat82oDmmu1HeWCqcZxM+nLHl+SqduBpmjqL3v6a3mcocjIzq6h6DIwKb2oUE9jm2JCo6q0f0+nyYf9sCXDyWLJ0A9rQJOesqO2ZTUirpyl/bQ+wFMmP6NMKRNiBL9d7FYg/3//Wq/FHSGbB0s1cvY8u093fLR505rvfi8h6w3ieUpJdDbo5e6cVUlwdEeAzYekWHlO+dlGxopqMtA5ZFS5N7jg8Rhi8vVR52UvKNP2jU0k0Ke5QyrHdlb88m5WgjyCWfxQvzJ16a+OUgwrNOUgKH34zpToS3PEBnHFvWLBkQg6izXzKNBMwxfQZlh+uya3ZCTtXzN0f1UYzynee6kp8BD6Zt+a5em8AM5iDyty3nGwG2ah8Y1/Xq8jXQh3LUScn2ZgGrClYtcnP2NUm3CtCMf9+oDhoGM8BK/8bsb7+YQX/Jr8oT2fMcuyOMUYi09kTSe45y8Xs6wn8kxK0FXS52i5Qq9pRjixXUsXqXplP5MA/NX5p0wU+qqu5G2SpdjOpduqLjOlRUNmdDxIM6cjmD83Pjh1rXTrfI8dkJ+acRkN9+a1xX/J6QuYbt4mo0BFzYNjp2cRd4xH8qNASt4dC1p4+uAJY60KnHo64BVrJcegopCi/K/Fl6e2VzbXaYDJeN6Qk50ax/w1XcrlC32l97Am43s8s+g/8D6wHPODIU0XIAAAAASUVORK5CYII="},b059:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACQAAAAkCAYAAADhAJiYAAAAAXNSR0IArs4c6QAAAu1JREFUWEftmDuMTVEUQNcmPgUJEf8JQUIxtYZK4RsUCgalROIzmIoOHdX4zESl9JkpNAQzEho0WiQKEt/BEILGCEf2u/vOO+9+5t773vXmFU43887ee539OWfvK7TYkhbjoRCQg0nAemAtsBJYCsywQ30FXgCPgDvAgMCvogfOBeQCo0eA/cDsnEY+Ab3AGQGFzbUygRx0qFJgbi6N8U0f9DACV/PIpwI5mAicB/ZFFL0CrgB3gafAMEEo24DFwBpgO7AkIncB6BT4PRZYIpDB9APbPGEFOQb0Zyk1eYU6BSzydFxT2LHk04DUMwc9RTeA3QLf8rg93ONgOnAZ2OzJ9Uqt7hqVMSAHO6iN9zmgS+BPERgPagLQDRzy5DsE+pL01QBZNT0D5thmFdop4OqB8aDUjuadHlbXR2BFUvVFgU4Ax03oNdAu8L0RmEj4Hns5dVJA7SWHzMFk4I13z2jOaPxLWw52AZdMoVZnm8CIb2DUQy5IvOv240tgWVY1FSW16ntu14OKbxHQghldPpAmb6f9clqCEi99ueAqOGqKe6Rqs/IvH+g+sNo2bhAYKJ2GSnXoW3jbdD+Uqs0YkGZ++E5pbN/+I6CFlquqfliqFR0D+kmQ2LqmCujfeqKNwEVgfp2AQ8AegVumT21UdAMjAlPScigN6F0DMKGtIYEFRYESQ+agDKD3Yh52kDtkD4BV0aR2sMlCNq/OkGku7hW4aR7KndQtV/bNuBj1odU2V/smXVulehnHqkyzX/Nllm0e36fD4us/rtqQ6eP6o87cqRFzMA14kvtxNSBt5pvRfujDujyz/TCoZjRo2mMlNv1pLWwPcMDz+fi1sOYlnTjSmvy+rHa29Cbfg0obg7Rxu2dJqje8Lm17220M0rCXNwb55WGD4lmvzy5adAp8uOFBMQKl1ddleRXeU1lgn22U7i51lI6AhR8b1nkfG2bani/ex4ZBYDDaL2edQH/PnO3zKClzz3+gLG+2nIf+AjPc2CWQPrm+AAAAAElFTkSuQmCC"},c8b8:function(e,t,a){},d325:function(e,t,a){}}]);