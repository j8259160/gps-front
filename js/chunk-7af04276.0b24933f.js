(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7af04276"],{"0012":function(t,e,n){},"349b4":function(t,e,n){"use strict";n.r(e);var s=function(){var t=this,e=t._self._c;return e("div",{staticClass:"transfer"},[e("div",{staticClass:"transfer-bean"},[e("div",{staticClass:"transfer-bean-header"},[e("div",{staticClass:"f_left"},[e("SingleChoiceUser",{attrs:{isMounted:""},model:{value:t.username,callback:function(e){t.username=e},expression:"username"}})],1),e("div",{staticClass:"f_left"},[e("el-button",{attrs:{loading:t.loading,type:"primary"},on:{click:t.handleQuery}},[t._v(t._s(t.$t("common.query")))])],1),e("div",{staticClass:"f_left"},[e("div",{staticStyle:{padding:"5px 0px 0px 0px"}},[e("el-checkbox",{model:{value:t.isFilter,callback:function(e){t.isFilter=e},expression:"isFilter"}},[t._v(t._s(t.$t("bgManage.bonusGreaterThan0")))])],1)]),e("div",{staticClass:"r_left"},[e("span",[t._v(t._s(t.$t("bgManage.userTotal"))+" : "+t._s(t.userTotal))]),t._v("   "),e("span",[t._v(t._s(t.$t("bgManage.totalGoldenBeans"))+" : "),e("b",[t._v(t._s(t.addvaluepoints))])]),t._v("   "),e("span",[t._v(t._s(t.$t("bgManage.userAmount"))+" : "+t._s(t.useraddvaluepoints))]),t._v("   "),e("span",[t._v(t._s(t.$t("bgManage.totalAmount"))+" : "+t._s(t.totalbonuspoints))]),t._v("   ")])]),e("div",{staticClass:"transfer-bean-table"},[e("vxe-table",{staticClass:"mytable-scrollbar",attrs:{border:"",resizable:"","auto-resize":"","show-overflow":"","highlight-current-row":"","highlight-hover-row":"",size:"mini",height:"auto",data:t.tableList}},[0==t.userType?e("vxe-table-column",{attrs:{title:t.$t("reportForm.action"),width:"200",align:"center"},scopedSlots:t._u([{key:"default",fn:function(n){return[e("div",{staticStyle:{"text-align":"center"}},[e("el-button",{attrs:{type:"text"},on:{click:function(e){return t.handleClickRowTransferin(n.row)}}},[t._v(t._s(t.$t("bgManage.switchIn")))]),e("span",{staticStyle:{display:"inline-block",padding:"0px 25px"}}),e("el-button",{attrs:{type:"text"},on:{click:function(e){return t.handleClickRowTransferOut(n.row)}}},[e("span",{staticStyle:{color:"#e4393c"}},[t._v(t._s(t.$t("bgManage.switchOut")))])])],1)]}}],null,!1,2035406308)}):e("vxe-table-column",{attrs:{title:t.$t("reportForm.action"),width:"90"},scopedSlots:t._u([{key:"default",fn:function(n){return[e("el-button",{attrs:{type:"text"},on:{click:function(e){return t.handleClickRowTransferin(n.row)}}},[t._v(t._s(t.$t("bgManage.switchIn")))])]}}])}),e("vxe-table-column",{attrs:{type:"seq",width:"60",title:t.$t("reportForm.index")}}),e("vxe-table-column",{attrs:{field:"username",title:t.$t("bgManage.subUsernameList")}}),e("vxe-table-column",{attrs:{field:"userTypeStr",title:t.$t("bgManage.userType")}}),e("vxe-table-column",{attrs:{field:"addvaluepoints",title:t.$t("bgManage.goldenBeanNumber"),sortable:""}}),e("vxe-table-column",{attrs:{field:"creater",title:t.$t("reportForm.creater")},scopedSlots:t._u([{key:"default",fn:function(n){return[e("el-popover",{attrs:{placement:"bottom",trigger:"click"}},[e("div",{staticClass:"parents-wrapper"},t._l(t.parentsList,(function(n){return e("div",{key:n.username},[t._v(t._s(n.username)+"("+t._s(n.usertypeStr)+")")])})),0),e("el-button",{staticStyle:{color:"#000000"},attrs:{slot:"reference",type:"text"},on:{click:function(e){return t.queryParents(n.row.creater)}},slot:"reference"},[t._v(t._s(n.row.creater))])],1)]}}])})],1)],1),e("div",{staticStyle:{position:"absolute",left:"0px",right:"10px",bottom:"0px"}},[e("el-pagination",{attrs:{currentPage:t.currentPage,"current-page":t.currentChangePage,"page-sizes":[100,400,800,1e3],"page-size":t.pageSize,layout:"total, sizes, pager, jumper",total:t.totalcount},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1),e("vxe-modal",{attrs:{title:t.jinDouSwitchIn,className:"modal-padding0",value:t.dialogVisible1,width:"280px"},on:{hide:function(e){t.dialogVisible1=!1},close:function(e){t.dialogVisible1=!1}}},[e("div",{staticClass:"margin_b10"},[e("LabelWrap",{attrs:{label:t.$t("bgManage.currentGoldenBeans")}},[e("el-input-number",{staticStyle:{width:"100%"},attrs:{min:0,max:1e5,disabled:"","controls-position":"right"},model:{value:t.currentBonusPoint,callback:function(e){t.currentBonusPoint=e},expression:"currentBonusPoint"}})],1)],1),e("div",{staticClass:"margin_b10"},[e("LabelWrap",{attrs:{label:t.$t("bgManage.transferGoldenBeans")}},[e("el-input-number",{staticStyle:{width:"100%"},attrs:{min:0,max:1e5,"controls-position":"right"},model:{value:t.bonuspoint,callback:function(e){t.bonuspoint=e},expression:"bonuspoint"}})],1)],1),e("div",{staticStyle:{"text-align":"center"}},[e("el-button",{staticStyle:{width:"100px"},attrs:{type:"primary",loading:t.pointLoading},on:{click:t.transferPoints}},[t._v(t._s(t.$t("common.determine")))])],1)]),e("vxe-modal",{attrs:{title:t.jinDouSwitchOut,className:"modal-padding0",value:t.dialogVisible2,width:"280px"},on:{hide:function(e){t.dialogVisible2=!1},close:function(e){t.dialogVisible2=!1}}},[e("div",{staticClass:"margin_b10"},[e("LabelWrap",{attrs:{label:t.$t("bgManage.currentGoldenBeans")}},[e("el-input-number",{staticStyle:{width:"100%"},attrs:{min:0,max:1e5,disabled:"","controls-position":"right"},model:{value:t.currentBonusPoint,callback:function(e){t.currentBonusPoint=e},expression:"currentBonusPoint"}})],1)],1),e("div",{staticClass:"margin_b10"},[e("LabelWrap",{attrs:{label:t.$t("bgManage.transferOutGoldenBeans")}},[e("el-input-number",{staticStyle:{width:"100%"},attrs:{min:0,max:1e5,"controls-position":"right"},model:{value:t.bonuspoint,callback:function(e){t.bonuspoint=e},expression:"bonuspoint"}})],1)],1),e("div",{staticStyle:{"text-align":"center"}},[e("el-button",{staticStyle:{width:"100px"},attrs:{type:"primary",loading:t.pointLoading},on:{click:t.transferOutPoints}},[t._v(t._s(t.$t("common.determine")))])],1)])],1)])},a=[],i=n("5530"),r=(n("c975"),n("14d9"),n("fb6a"),n("a9e3"),n("b680"),n("d3b7"),n("498a"),n("159b"),n("b562")),o=n("e285"),u=n("c276"),l=n("d575"),c=n("2f62"),d=n("201d"),h=n("0c87"),p={name:"transferBean1",data:function(){return{loading:!1,pointLoading:!1,isFilter:!1,dialogVisible1:!1,dialogVisible2:!1,username:"",addvaluepoints:0,currentBonusPoint:0,useraddvaluepoints:0,tableList:[],userTotal:0,selectUser:"",bonuspoint:0,remark:"",pageSize:100,currentPage:1,totalcount:0,jinDouSwitchIn:"",jinDouSwitchOut:""}},mixins:[h["a"]],computed:Object(i["a"])(Object(i["a"])({},Object(c["b"])(["isZh","isQueryInitData","userType"])),{},{totalbonuspoints:function(){return Number((this.useraddvaluepoints+this.addvaluepoints).toFixed(2))},userName:function(){return this.$store.state.user.userName}}),watch:{isQueryInitData:function(t){t&&(this.username=this.userName,this.queryBonusList())},isFilter:function(t){this.currentPage=1,this.totalcount=t?this.filterTableList.length:this.cacheList.length,this.currentChangePage(this.currentPage)}},components:{SingleChoiceUser:l["a"],LabelWrap:d["a"]},methods:{handleSizeChange:function(t){this.pageSize=t,this.currentChangePage(this.currentPage)},handleCurrentChange:function(t){this.currentPage=t,this.currentChangePage(this.currentPage)},currentChangePage:function(t){for(var e=this.isFilter?this.filterTableList:this.cacheList,n=(t-1)*this.pageSize,s=this.pageSize,a=[],i=0;i<e.length;i++)if(i>=n){var r=e[i];if(a.push(r),a.length>=s)break}this.tableList=a},handleQuery:function(){var t=this.username.trim(),e=this.isFilter?this.filterTableList:this.cacheList;if(""==t||t==this.userName)this.tableList=e.slice(0,this.pageSize),this.currentPage=1;else{var n=[];e.forEach((function(e){-1!=e.username.indexOf(t)&&n.push(e)})),this.tableList=n}},handleClickRowTransferin:function(t){this.selectUser=t.username,this.bonuspoint=0,this.currentBonusPoint=Number(t.addvaluepoints.toFixed(2)),this.isZh?this.jinDouSwitchIn="从 "+this.userName+" 转入 "+t.username:this.jinDouSwitchIn="From "+this.userName+" To "+t.username,this.dialogVisible1=!0},handleClickRowTransferOut:function(t){this.selectUser=t.username,this.bonuspoint=0,this.currentBonusPoint=Number(t.addvaluepoints.toFixed(2)),this.isZh?this.jinDouSwitchOut="从 "+t.username+" 转到 "+this.userName:this.jinDouSwitchOut="From "+t.username+" To "+this.userName,this.dialogVisible2=!0},transferPoints:function(){var t=this;if(0==isNaN(this.bonuspoint)){if(0==this.bonuspoint)return;this.pointLoading=!0;var e={tousername:this.selectUser,points:this.bonuspoint,type:"addvaluetoaddvalueaccount",fromusername:this.userName};Object(o["uc"])(e).then((function(n){var s=n.status,a=n.fromaddvaluepoints,i=n.toaddvaluepoints;if(t.pointLoading=!1,0==s){var r=0;t.cacheList.forEach((function(t){t.username==e.tousername&&(t.addvaluepoints=Number(i.toFixed(2))),r+=t.addvaluepoints})),t.currentBonusPoint=Number(i.toFixed(2)),t.useraddvaluepoints=Number(r.toFixed(2)),t.addvaluepoints=Number(a.toFixed(2)),t.$XModal.message({message:t.$t("bgManage.transferSuccessful"),status:"success",zIndex:9999})}else 1==s?t.$XModal.message({message:t.$t("tips.noPermission"),status:"error",zIndex:9999}):2==s&&t.$XModal.message({message:t.$t("tips.balance"),status:"error",zIndex:9999})})).catch((function(e){t.pointLoading=!1}))}},transferOutPoints:function(){var t=this;if(0==isNaN(this.bonuspoint)){if(0==this.bonuspoint)return;this.pointLoading=!0;var e={tousername:this.userName,points:this.bonuspoint,type:"addvaluetoaddvalueaccount",fromusername:this.selectUser};Object(o["uc"])(e).then((function(n){var s=n.status,a=n.fromaddvaluepoints,i=n.toaddvaluepoints;if(t.pointLoading=!1,0==s){var r=0;t.cacheList.forEach((function(t){t.username==e.fromusername&&(t.addvaluepoints=Number(a.toFixed(2))),r+=t.addvaluepoints})),t.useraddvaluepoints=Number(r.toFixed(2)),t.addvaluepoints=Number(i.toFixed(2)),t.currentBonusPoint=Number(a.toFixed(2)),t.$XModal.message({message:t.$t("bgManage.transferSuccessful"),status:"success",zIndex:9999})}else 1==s?t.$XModal.message({message:t.$t("tips.noPermission"),status:"error",zIndex:9999}):2==s&&t.$XModal.message({message:t.$t("tips.balance"),status:"error",zIndex:9999})})).catch((function(e){t.pointLoading=!1}))}},queryBonusList:function(){var t=this;this.loading=!0;var e=0,n=this.userName;Object(r["P"])().then((function(s){var a=s.records;if(t.loading=!1,a){var i=[],r=[];a.forEach((function(t){t.username!=n&&(t.userTypeStr=Object(u["cb"])(!0,t.usertype),t.addvaluepoints=Number(t.addvaluepoints.toFixed(2)),e+=t.addvaluepoints,r.push(t),t.addvaluepoints>0&&i.push(t))})),t.useraddvaluepoints=Number(e.toFixed(2)),t.tableList=a.slice(0,t.pageSize),t.cacheList=r,t.filterTableList=i,t.totalcount=r.length,t.userTotal=t.totalcount}})).catch((function(e){t.loading=!1})),Object(o["hb"])().then((function(e){var n=e.addvaluepoints;t.addvaluepoints=null!=n?Number(n.toFixed(2)):null}))}},mounted:function(){this.cacheList=[],this.filterTableList=[],this.isQueryInitData&&(this.username=this.userName,this.queryBonusList())}},b=p,m=(n("788d"),n("2877")),g=Object(m["a"])(b,s,a,!1,null,null,null),f=g.exports;e["default"]=f},"58d7":function(t,e,n){},"788d":function(t,e,n){"use strict";n("0012")},c6a1:function(t,e,n){"use strict";n("58d7")},d575:function(t,e,n){"use strict";var s=function(){var t=this,e=t._self._c;return e("div",{staticClass:"multi-choice single-choice-user"},[e("div",{staticClass:"multi-choice-label"},[t._v(" "+t._s(t.$t("reportForm.selectUser"))+" ")]),e("div",{staticClass:"multi-choice-input"},[e("ZtreeUserDropdown",{ref:"ztreeDropdown",attrs:{placeholder:t.userPlaceholder,isMounted:t.isMounted},model:{value:t.username,callback:function(e){t.username=e},expression:"username"}})],1)])},a=[],i=n("c7eb"),r=n("1da1"),o=n("5530"),u=n("2f62"),l=n("f514"),c=n("e285"),d={props:{value:{type:String,default:""},isMounted:{type:Boolean,default:!1}},name:"SingleChoiceUser",data:function(){return{username:"",userPlaceholder:this.$t("bgManage.pleaseEnterQueryUser")}},watch:{username:function(t){this.$emit("input",t)},isQueryInitData:function(){if(0==this.isMounted){var t=this.$store.state.user.userName;this.ininZtree(t,this)}}},computed:Object(o["a"])({},Object(u["b"])(["isQueryInitData"])),components:{ZtreeUserDropdown:l["a"]},methods:{ininZtree:function(){var t=Object(r["a"])(Object(i["a"])().mark((function t(e,n){var s,a,r;return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(c["Vb"])(e,null);case 2:s=t.sent,a=s.status,r=s.rootuser,0==a&&n.$refs.ztreeDropdown.ininZtree(r);case 6:case"end":return t.stop()}}),t)})));function e(e,n){return t.apply(this,arguments)}return e}()},mounted:function(){var t=this;this.$nextTick((function(){if(t.isQueryInitData&&0==t.isMounted){var e=t.$store.state.user.userName;t.ininZtree(e,t)}}))}},h=d,p=(n("c6a1"),n("2877")),b=Object(p["a"])(h,s,a,!1,null,null,null);e["a"]=b.exports}}]);