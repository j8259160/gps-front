(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-e37b23a4"],{"1de3":function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQEAYAAABPYyMiAAAACXBIWXMAAAsTAAALEwEAmpwYAAAKTWlDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVN3WJP3Fj7f92UPVkLY8LGXbIEAIiOsCMgQWaIQkgBhhBASQMWFiApWFBURnEhVxILVCkidiOKgKLhnQYqIWotVXDjuH9yntX167+3t+9f7vOec5/zOec8PgBESJpHmomoAOVKFPDrYH49PSMTJvYACFUjgBCAQ5svCZwXFAADwA3l4fnSwP/wBr28AAgBw1S4kEsfh/4O6UCZXACCRAOAiEucLAZBSAMguVMgUAMgYALBTs2QKAJQAAGx5fEIiAKoNAOz0ST4FANipk9wXANiiHKkIAI0BAJkoRyQCQLsAYFWBUiwCwMIAoKxAIi4EwK4BgFm2MkcCgL0FAHaOWJAPQGAAgJlCLMwAIDgCAEMeE80DIEwDoDDSv+CpX3CFuEgBAMDLlc2XS9IzFLiV0Bp38vDg4iHiwmyxQmEXKRBmCeQinJebIxNI5wNMzgwAABr50cH+OD+Q5+bk4eZm52zv9MWi/mvwbyI+IfHf/ryMAgQAEE7P79pf5eXWA3DHAbB1v2upWwDaVgBo3/ldM9sJoFoK0Hr5i3k4/EAenqFQyDwdHAoLC+0lYqG9MOOLPv8z4W/gi372/EAe/tt68ABxmkCZrcCjg/1xYW52rlKO58sEQjFu9+cj/seFf/2OKdHiNLFcLBWK8ViJuFAiTcd5uVKRRCHJleIS6X8y8R+W/QmTdw0ArIZPwE62B7XLbMB+7gECiw5Y0nYAQH7zLYwaC5EAEGc0Mnn3AACTv/mPQCsBAM2XpOMAALzoGFyolBdMxggAAESggSqwQQcMwRSswA6cwR28wBcCYQZEQAwkwDwQQgbkgBwKoRiWQRlUwDrYBLWwAxqgEZrhELTBMTgN5+ASXIHrcBcGYBiewhi8hgkEQcgIE2EhOogRYo7YIs4IF5mOBCJhSDSSgKQg6YgUUSLFyHKkAqlCapFdSCPyLXIUOY1cQPqQ28ggMor8irxHMZSBslED1AJ1QLmoHxqKxqBz0XQ0D12AlqJr0Rq0Hj2AtqKn0UvodXQAfYqOY4DRMQ5mjNlhXIyHRWCJWBomxxZj5Vg1Vo81Yx1YN3YVG8CeYe8IJAKLgBPsCF6EEMJsgpCQR1hMWEOoJewjtBK6CFcJg4Qxwicik6hPtCV6EvnEeGI6sZBYRqwm7iEeIZ4lXicOE1+TSCQOyZLkTgohJZAySQtJa0jbSC2kU6Q+0hBpnEwm65Btyd7kCLKArCCXkbeQD5BPkvvJw+S3FDrFiOJMCaIkUqSUEko1ZT/lBKWfMkKZoKpRzame1AiqiDqfWkltoHZQL1OHqRM0dZolzZsWQ8ukLaPV0JppZ2n3aC/pdLoJ3YMeRZfQl9Jr6Afp5+mD9HcMDYYNg8dIYigZaxl7GacYtxkvmUymBdOXmchUMNcyG5lnmA+Yb1VYKvYqfBWRyhKVOpVWlX6V56pUVXNVP9V5qgtUq1UPq15WfaZGVbNQ46kJ1Bar1akdVbupNq7OUndSj1DPUV+jvl/9gvpjDbKGhUaghkijVGO3xhmNIRbGMmXxWELWclYD6yxrmE1iW7L57Ex2Bfsbdi97TFNDc6pmrGaRZp3mcc0BDsax4PA52ZxKziHODc57LQMtPy2x1mqtZq1+rTfaetq+2mLtcu0W7eva73VwnUCdLJ31Om0693UJuja6UbqFutt1z+o+02PreekJ9cr1Dund0Uf1bfSj9Rfq79bv0R83MDQINpAZbDE4Y/DMkGPoa5hpuNHwhOGoEctoupHEaKPRSaMnuCbuh2fjNXgXPmasbxxirDTeZdxrPGFiaTLbpMSkxeS+Kc2Ua5pmutG003TMzMgs3KzYrMnsjjnVnGueYb7ZvNv8jYWlRZzFSos2i8eW2pZ8ywWWTZb3rJhWPlZ5VvVW16xJ1lzrLOtt1ldsUBtXmwybOpvLtqitm63Edptt3xTiFI8p0in1U27aMez87ArsmuwG7Tn2YfYl9m32zx3MHBId1jt0O3xydHXMdmxwvOuk4TTDqcSpw+lXZxtnoXOd8zUXpkuQyxKXdpcXU22niqdun3rLleUa7rrStdP1o5u7m9yt2W3U3cw9xX2r+00umxvJXcM970H08PdY4nHM452nm6fC85DnL152Xlle+70eT7OcJp7WMG3I28Rb4L3Le2A6Pj1l+s7pAz7GPgKfep+Hvqa+It89viN+1n6Zfgf8nvs7+sv9j/i/4XnyFvFOBWABwQHlAb2BGoGzA2sDHwSZBKUHNQWNBbsGLww+FUIMCQ1ZH3KTb8AX8hv5YzPcZyya0RXKCJ0VWhv6MMwmTB7WEY6GzwjfEH5vpvlM6cy2CIjgR2yIuB9pGZkX+X0UKSoyqi7qUbRTdHF09yzWrORZ+2e9jvGPqYy5O9tqtnJ2Z6xqbFJsY+ybuIC4qriBeIf4RfGXEnQTJAntieTE2MQ9ieNzAudsmjOc5JpUlnRjruXcorkX5unOy553PFk1WZB8OIWYEpeyP+WDIEJQLxhP5aduTR0T8oSbhU9FvqKNolGxt7hKPJLmnVaV9jjdO31D+miGT0Z1xjMJT1IreZEZkrkj801WRNberM/ZcdktOZSclJyjUg1plrQr1zC3KLdPZisrkw3keeZtyhuTh8r35CP5c/PbFWyFTNGjtFKuUA4WTC+oK3hbGFt4uEi9SFrUM99m/ur5IwuCFny9kLBQuLCz2Lh4WfHgIr9FuxYji1MXdy4xXVK6ZHhp8NJ9y2jLspb9UOJYUlXyannc8o5Sg9KlpUMrglc0lamUycturvRauWMVYZVkVe9ql9VbVn8qF5VfrHCsqK74sEa45uJXTl/VfPV5bdra3kq3yu3rSOuk626s91m/r0q9akHV0IbwDa0b8Y3lG19tSt50oXpq9Y7NtM3KzQM1YTXtW8y2rNvyoTaj9nqdf13LVv2tq7e+2Sba1r/dd3vzDoMdFTve75TsvLUreFdrvUV99W7S7oLdjxpiG7q/5n7duEd3T8Wej3ulewf2Re/ranRvbNyvv7+yCW1SNo0eSDpw5ZuAb9qb7Zp3tXBaKg7CQeXBJ9+mfHvjUOihzsPcw83fmX+39QjrSHkr0jq/dawto22gPaG97+iMo50dXh1Hvrf/fu8x42N1xzWPV56gnSg98fnkgpPjp2Snnp1OPz3Umdx590z8mWtdUV29Z0PPnj8XdO5Mt1/3yfPe549d8Lxw9CL3Ytslt0utPa49R35w/eFIr1tv62X3y+1XPK509E3rO9Hv03/6asDVc9f41y5dn3m978bsG7duJt0cuCW69fh29u0XdwruTNxdeo94r/y+2v3qB/oP6n+0/rFlwG3g+GDAYM/DWQ/vDgmHnv6U/9OH4dJHzEfVI0YjjY+dHx8bDRq98mTOk+GnsqcTz8p+Vv9563Or59/94vtLz1j82PAL+YvPv655qfNy76uprzrHI8cfvM55PfGm/K3O233vuO+638e9H5ko/ED+UPPR+mPHp9BP9z7nfP78L/eE8/sl0p8zAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAARZSURBVHjaxJVvSNVnFMc/53d/3blNxInZnf3BiXNlzi5irm7irMlwsSSahZS45sSFtK2JSIzNOYiwkILWzDlpIS6ckxgtRJyYkxYi4iREJJyIC5GLidjd1d3ufc5e5MbI6/ay582B87w4n3O+z/M9oqqqyhM79uOJtWsvXfxtDABr+dYQBNKxWAAdYUy6IZQoSToT3y1+6kLR+3qoNaNWU/523SH93HO1WhXkM/OgTq6ZQVJbzqvLKqfuWz8jjhQ7sNhwX8rqE46FASCGOOLDAERjEwtYRHNj61HZpNM0N34tU1Ra855WSqSdqj9qJZI5pro8VFMk7uhBnbX8Ot24hS4KGN62R2KJxVN1lfsAiwsrALSNk5wLAxBPgOinn6GQVA1+uIsWDusdT6kO4iMLSGCW1prX2Mtx/HWZjhQNiA+Mj3g8Vel6S/Zr45lSlswVU/bzcQAa20+HAdC7uicMgJMA9vpZYsVD1s4j4sImhlK9AsSAePByImmjSZRm8hIGzDhtpnoyU+9oOlnfV+LHRVJVhvabgVDgSBQ78UB7GAna5DbuMAAWTmyJYolT+PiKJSaYBynHxgukEUf1ey4p1GLx7yhSW1NM05lKXJIqnVvW4WaIzsgR9YjfGt5Yvlzt5goA84l69ca/ACyC+IG7GOImj8spKZe2jsuSRRMXU0sYxYsXmCOKwyAtNJC3rRufjEp14zntJo4kasVFIuapee6o26QOHOaFVX5B6LJ98tkFwGARAQyTJOdAYjQpNB7R4mg3yYu99iXq8Ipv6SiGIEsRTdhYWNjcI0LbAUM2GyIr5HXmMVRgMcscVyXbqhR3z/P8Tk9YAHaQJg2AkyCzQDxRGFLIJQl3YYFkcFvKd+ZwAmTTd/VagKUfv21LHLNMhgaBBab+LMYJRDm8OkAuvQudZKmh9MuDjMgshdd//buctcIYekJpSzVgz4SsxU5Y0xl0P8h5dbPjhulcqjmwjjwdJKG7iGIi1Fc8LFmUSbMGOMQGKr7JxKVuk/jOPpLVa/Lf363HpDlY9cpP2k4a1Z87xYmfqEDdqkakfbilA+QQcyS/OMoBiqTszAMSpIbAzTLGOY1dMMFeSsQnCxqrr5u8X9LVGzplOj97Q8qtaTk2fVb6xCM2EE0XY7RjE1xu99GjXg1AGikLxYG+ybDUv3veTDk+4FZnhiOgaTjTY3RIuoiKP8sMZxkeu256Hg6Fci88F8p8ePTh0HSH3evsXhMJ4nb4HKXAJF3/ZcUrJJAGLQmNH8yXaRZCfSnXZK/WSOrWfj1lbktF7mZyzH6Jyt9FgU4w8NZ2pomU4h+N1MqcXAcSxSPJQAAfS/+/C1YAMCWzVmTheumjT/p3d1jxWs90wWUp0RkyPn1Zr+gP0tYXyWbJYW40nkiisRd7Mf/M03o8Svj8KgD9ZEvZwBfqZxLvcCunNU+zP3qJfLy4LkzhZAcTgMG3rGVwudNVo4bPP5r4k17Hfw0ARCzlTR0jwMUAAAAASUVORK5CYII="},2873:function(e,t,i){},2909:function(e,t,i){"use strict";i.d(t,"a",(function(){return l}));var a=i("6b75");function n(e){if(Array.isArray(e))return Object(a["a"])(e)}i("a4d3"),i("e01a"),i("d28b"),i("a630"),i("d3b7"),i("3ca3"),i("ddb0");function r(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}var s=i("06c5");i("d9e2");function o(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function l(e){return n(e)||r(e)||Object(s["a"])(e)||o()}},"8bec":function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e._self._c;return t("div",{staticClass:"role full"},[t("div",{staticClass:"role-header"},[t("el-tabs",{model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[t("el-tab-pane",{attrs:{label:e.$t("bgManage.roleAuthorize"),name:"authorize"}}),t("el-tab-pane",{attrs:{label:e.$t("bgManage.roleLists"),name:"roleList"}})],1)],1),t("div",{staticStyle:{"margin-top":"6px"}},[t("div",{directives:[{name:"show",rawName:"v-show",value:"authorize"==e.activeName,expression:"activeName=='authorize'"}],staticClass:"role-header-right"},[t("div",{staticStyle:{width:"280px"}},[t("LabelWrap",{attrs:{label:e.$t("bgManage.queryUser")}},[t("el-input",{attrs:{clearable:"",placeholder:e.$t("bgManage.pleaseEnterQueryUser")},model:{value:e.searchTextUser,callback:function(t){e.searchTextUser=t},expression:"searchTextUser"}})],1)],1),t("div",{staticStyle:{width:"10px"}}),t("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.queryLocalUser}},[e._v(e._s(e.$t("common.query"))+"("+e._s(e.authorizeList.length)+")")])],1),t("div",{directives:[{name:"show",rawName:"v-show",value:"roleList"==e.activeName,expression:"activeName=='roleList'"}],staticClass:"role-header-right"},[t("div",{staticStyle:{width:"280px"}},[t("LabelWrap",{attrs:{label:e.$t("bgManage.qeuryRole")}},[t("el-select",{attrs:{filterable:"",clear:""},model:{value:e.searchTextRole,callback:function(t){e.searchTextRole=t},expression:"searchTextRole"}},[t("el-option",{attrs:{label:e.$t("monitor.all"),value:"all"}}),e._l(e.roleOptions,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],2)],1)],1),t("div",{staticStyle:{width:"10px"}}),t("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.queryLocalRole}},[e._v(e._s(e.$t("common.query"))+"("+e._s(e.tableList.length)+")")]),t("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.onOpenDialog}},[e._v(e._s(e.$t("common.add")))])],1)]),t("div",{staticClass:"role-table"},[t("div",{style:{zIndex:"roleList"==e.activeName?20:1}},[t("vxe-table",{attrs:{border:"",resizable:"","auto-resize":"","show-overflow":"","highlight-hover-row":"","highlight-current-row":"",size:"mini","menu-config":e.tableMenu,height:"auto",data:e.tableList},on:{"menu-click":e.handleClickTableMenu,"cell-click":e.cellClick,"cell-dblclick":e.cellDblclick}},[t("vxe-table-column",{attrs:{type:"seq",width:"60",title:e.$t("reportForm.index")}}),t("vxe-table-column",{attrs:{field:"rolename",title:e.$t("bgManage.roleName")}}),t("vxe-table-column",{attrs:{field:"creater",title:e.$t("monitor.creator")}}),t("vxe-table-column",{attrs:{field:"creatertimeStr",title:e.$t("alarm.createTime")}}),t("vxe-table-column",{attrs:{field:"remark",title:e.$t("reportForm.remarks")}}),t("vxe-table-column",{attrs:{field:"roletypeStr",title:e.$t("bgManage.roleType"),width:"105"}}),t("vxe-table-column",{attrs:{title:e.$t("reportForm.action"),width:"65"},scopedSlots:e._u([{key:"default",fn:function(i){return["admin"==e.userName||1!=i.row.roletype?t("div",{staticStyle:{"padding-top":"7px"}},[t("div"),t("i",{staticClass:"el-icon-document-copy",staticStyle:{"font-size":"14px",cursor:"pointer",position:"relative",top:"-3.5px"},attrs:{title:e.$t("bgManage.copy")},on:{click:function(t){return e.onShowCopy(i.row)}}}),t("el-dropdown",{attrs:{trigger:"click",size:"mini"},on:{command:e.onCommand}},[t("span",{staticStyle:{padding:"0px 10px"}},[t("img",{staticStyle:{width:"18px",cursor:"pointer"},attrs:{src:e.moreIcon}})]),t("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[t("el-dropdown-item",{staticClass:"clearfix",attrs:{command:"permission"}},[e._v(e._s(e.$t("common.permissionList")))]),t("el-dropdown-item",{staticClass:"clearfix",attrs:{command:"username"}},[e._v(e._s(e.$t("bgManage.userList")))]),t("el-dropdown-item",{staticClass:"clearfix",attrs:{command:"edit"}},[e._v(e._s(e.$t("common.edit")))]),t("el-dropdown-item",{staticClass:"clearfix",attrs:{command:"delete"}},[e._v(e._s(e.$t("common.delete")))])],1)],1)],1):t("div",{staticStyle:{"padding-top":"7px"}},[t("div"),t("i",{staticClass:"el-icon-document-copy",staticStyle:{"font-size":"14px",cursor:"pointer",position:"relative",top:"-3.5px"},attrs:{title:e.$t("bgManage.copy")},on:{click:function(t){return e.onShowCopy(i.row)}}}),t("el-dropdown",{attrs:{trigger:"click",size:"mini"},on:{command:e.onCommand}},[t("span",{staticStyle:{padding:"0px 10px"}},[t("img",{staticStyle:{width:"18px",cursor:"pointer"},attrs:{src:e.moreIcon}})]),t("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[t("el-dropdown-item",{staticClass:"clearfix",attrs:{command:"see"}},[e._v(e._s(e.$t("common.see")))])],1)],1)],1)]}}])})],1)],1),t("div",{style:{zIndex:"authorize"==e.activeName?20:1}},[t("vxe-table",{attrs:{border:"",loading:e.usersLoading,"menu-config":e.tableMenu,"highlight-hover-row":"","highlight-current-row":"",resizable:"","auto-resize":"","show-overflow":"",size:"mini",height:"auto",data:e.authorizeList},on:{"menu-click":e.handleClickTableMenu}},[t("vxe-table-column",{attrs:{type:"seq",width:"60",title:e.$t("reportForm.index")}}),t("vxe-table-column",{attrs:{title:e.$t("bgManage.user"),field:"username",sortable:""},scopedSlots:e._u([{key:"default",fn:function(i){return[t("el-popover",{attrs:{placement:"bottom",trigger:"click"}},[t("div",{staticClass:"parents-wrapper"},e._l(e.parentsList,(function(i){return t("div",{key:i.username},[e._v(e._s(i.username)+"("+e._s(i.usertypeStr)+")")])})),0),t("el-button",{staticStyle:{color:"#000000"},attrs:{slot:"reference",type:"text"},on:{click:function(t){return e.queryParents(i.row.username)}},slot:"reference"},[e._v(e._s(i.row.username))])],1)]}}])}),t("vxe-table-column",{attrs:{field:"showname",title:e.$t("bgManage.displayName"),sortable:""}}),t("vxe-table-column",{attrs:{field:"usertypeStr",title:e.$t("bgManage.userType"),sortable:""}}),t("vxe-table-column",{attrs:{title:e.$t("bgManage.role"),width:"240"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("el-select",{on:{change:function(t){return e.onChangeRole(i.row)}},model:{value:i.row.roleuuid,callback:function(t){e.$set(i.row,"roleuuid",t)},expression:"scope.row.roleuuid"}},e._l(e.roleOptions,(function(e,i){return t("el-option",{key:i,attrs:{value:e.value,label:e.label}})})),1)]}}])})],1)],1)]),t("AddRole",{ref:"addAialog",attrs:{isCopy:e.isCopy,roleRow:e.roleRow},on:{"add-role":e.addRole},model:{value:e.addAialog,callback:function(t){e.addAialog=t},expression:"addAialog"}}),t("PermissionAialog",{ref:"permissionAialog",model:{value:e.permissionAialog,callback:function(t){e.permissionAialog=t},expression:"permissionAialog"}}),t("BindUsersDialog",{ref:"bindUsersDialog",attrs:{title:e.bindUserTitle,users:e.users},model:{value:e.bindUsersDialog,callback:function(t){e.bindUsersDialog=t},expression:"bindUsersDialog"}})],1)},n=[],r=i("5530"),s=(i("c975"),i("d81d"),i("14d9"),i("d3b7"),i("159b"),i("201d")),o=i("e285"),l=(i("498a"),function(){var e=this,t=e._self._c;return t("vxe-modal",{attrs:{title:e.title,value:e.value,className:"modal-padding0",width:"360px"},on:{hide:e.handleClose,close:e.handleClose}},[t("div",{staticClass:"margin_b10"},[t("el-row",{attrs:{gutter:10}},[t("el-col",{staticStyle:{"text-align":"right","line-height":"32px"},attrs:{span:5}},[e._v(e._s(e.$t("bgManage.roleName")))]),t("el-col",{attrs:{span:18}},[t("el-input",{attrs:{clearable:""},model:{value:e.rolename,callback:function(t){e.rolename="string"===typeof t?t.trim():t},expression:"rolename"}})],1)],1)],1),t("div",{staticClass:"margin_b10"},[t("el-row",{attrs:{gutter:10}},[t("el-col",{staticStyle:{"text-align":"right","line-height":"32px"},attrs:{span:5}},[e._v(e._s(e.$t("reportForm.remarks")))]),t("el-col",{attrs:{span:18}},[t("el-input",{attrs:{clearable:"",type:"textarea",rows:4},model:{value:e.remark,callback:function(t){e.remark="string"===typeof t?t.trim():t},expression:"remark"}})],1)],1)],1),e.isCopy?t("div",{staticStyle:{"text-align":"center"}},[t("el-button",{staticStyle:{width:"120px"},attrs:{type:"primary",loading:e.loading},on:{click:e.copyRole}},[e._v(e._s(e.$t("bgManage.copy")))])],1):t("div",{staticStyle:{"text-align":"center"}},[null==e.roleRow?t("el-button",{staticStyle:{width:"120px"},attrs:{type:"primary",loading:e.loading},on:{click:e.addRole}},[e._v(e._s(e.$t("common.add")))]):t("el-button",{staticStyle:{width:"120px"},attrs:{type:"primary",loading:e.loading},on:{click:e.editRole}},[e._v(e._s(e.$t("common.edit")))])],1)])}),c=[],d=(i("e9c4"),i("b64b"),i("2f62")),u={name:"AddRole",props:{value:{type:Boolean,default:!1},isCopy:{type:Boolean,default:!1},roleRow:{type:Object,default:null}},data:function(){return{loading:!1,rolename:"",remark:"",roleName:""}},computed:Object(r["a"])(Object(r["a"])({},Object(d["b"])(["isZh","userName"])),{},{title:function(){return this.isCopy?this.roleRow.rolename+" - "+this.$t("bgManage.copyRole"):null==this.roleRow?this.$t("bgManage.addRole"):this.roleName+" - "+this.$t("bgManage.editRole")}}),watch:{value:function(e){e&&(this.isCopy||(null==this.roleRow?(this.rolename="",this.remark=""):(this.rolename=this.roleRow.rolename,this.remark=this.roleRow.remark)))}},mounted:function(){},methods:{handleClose:function(){this.$emit("input",!1)},copyRole:function(){var e=this,t={rolename:this.rolename,creater:this.userName,remark:this.remark},i=this.roleRow.roleuuid;this.loading=!0,Object(o["u"])(t).then((function(t){var a=t.status,n=t.cause,r=t.role;0==a?Object(o["Db"])(i).then((function(t){t.status;var i=t.records,a={roleuuid:r.roleuuid,permissions:[]};i&&i.length&&i.forEach((function(e){e.checked&&a.permissions.push(e.permissionname)})),Object(o["W"])(a).then((function(){e.$emit("add-role",r),e.handleClose(),e.$XModal.message({message:e.$t("systemManage.copySucc"),status:"success",zIndex:9999})})).finally((function(){e.loading=!1}))})):e.$XModal.message({message:e.$t("tips.addFail")+n,status:"error",zIndex:9999})})).catch((function(e){}))},addRole:function(){var e=this,t={rolename:this.rolename,creater:this.userName,remark:this.remark};this.loading=!0,Object(o["u"])(t).then((function(t){var i=t.status,a=t.cause,n=t.role;0==i?(e.$emit("add-role",n),e.handleClose(),e.$XModal.message({message:e.$t("tips.addSucc"),status:"success",zIndex:9999})):e.$XModal.message({message:e.$t("tips.addFail")+a,status:"error",zIndex:9999})})).finally((function(){e.loading=!1}))},editRole:function(){var e=this,t=JSON.parse(JSON.stringify(this.roleRow));t.rolename=this.rolename,t.remark=this.remark,this.loading=!0,Object(o["V"])(t).then((function(i){var a=i.status,n=i.cause;0==a?(e.handleClose(),e.roleRow.rolename=t.rolename,e.roleRow.remark=t.remark,e.$XModal.message({message:e.$t("tips.editSucc"),status:"success",zIndex:9999})):e.$XModal.message({message:e.$t("tips.editFail")+n,status:"error",zIndex:9999})})).finally((function(){e.loading=!1}))}}},h=u,m=i("2877"),p=Object(m["a"])(h,l,c,!1,null,null,null),f=p.exports,g=(i("b0c0"),function(){var e=this,t=e._self._c;return t("vxe-modal",{attrs:{title:e.title,value:e.value,className:"modal-padding0",width:"460px"},on:{hide:e.handleClose,close:e.handleClose}},[t("div",{staticStyle:{height:"470px"}},[t("div",{directives:[{name:"clickoutside",rawName:"v-clickoutside",value:e.onClickoutside,expression:"onClickoutside"}],staticStyle:{height:"40px",position:"relative"}},[t("el-input",{staticStyle:{width:"100%"},attrs:{clearable:"","prefix-icon":"el-icon-search"},on:{focus:e.onInputFocus},model:{value:e.searchText,callback:function(t){e.searchText=t},expression:"searchText"}}),e.searchList.length?t("div",{staticClass:"search-drop-down"},e._l(e.searchList,(function(i,a){return t("div",{key:a},[t("div",{staticClass:"el-select-dropdown__item",on:{click:function(t){return e.handleClickDropDown(i)}}},[e._v(e._s(i.name))])])})),0):e._e()],1),t("div",{staticClass:"drop-down-vxetree noselect",staticStyle:{height:"380px"}},[t("vxe-table",{ref:"xTable",staticClass:"mytree-scrollbar",attrs:{height:"100%",size:"mini","show-overflow":"","highlight-hover-row":"","highlight-current-row":"","row-config":e.rowConfig,"auto-resize":!0,border:"none","checkbox-config":{checkStrictly:!1,showHeader:!0},"tree-config":e.treeConfig,"show-header":!1,"scroll-y":{enabled:!0,gt:0},data:e.treeData},on:{"cell-click":e.onClickRow}},[t("vxe-table-column",{attrs:{width:"100%",field:"id"},scopedSlots:e._u([{key:"default",fn:function(i){var a=i.row;return[t("div",{staticClass:"fence-checkbox-cell",style:{paddingLeft:e.getIndent(a)+"px"},attrs:{"data-id":a.id,title:a.showTitle},on:{contextmenu:function(e){e.preventDefault()}}},[a.children.length?t("span",{staticStyle:{position:"relative",top:"1.5px","padding-right":"3px"},on:{dblclick:function(e){e.stopPropagation()},click:function(t){return t.stopPropagation(),e.onExpandNode(a)}}},[(0==a.children.length?a.expand:e.$refs.xTable.isTreeExpandByRow(a))?t("img",{attrs:{src:e.bihe,width:"12",height:"12"}}):t("img",{attrs:{src:e.zhankai,width:"12",height:"12"}})]):t("span",{staticStyle:{padding:"7.5px"}}),t("span",{on:{click:function(e){e.stopPropagation()},dblclick:function(e){e.stopPropagation()}}},[t("el-checkbox",{staticStyle:{margin:"0px 3px 0px 2px"},attrs:{disabled:e.isDisableChecked,indeterminate:a.indeterminate},on:{change:function(t){return e.handleCheckboxChange(a,!1)}},model:{value:a.checked,callback:function(t){e.$set(a,"checked",t)},expression:"row.checked"}})],1),t("img",{staticStyle:{margin:"0px 3px 0px 2px",width:"15px",height:"14px",border:"0px",position:"relative",top:"2.5px"},attrs:{"data-id":a.id,src:a.icon}}),t("span",{attrs:{"data-id":a.id},domProps:{textContent:e._s(a.name)}}),a.children.length?t("span",[e._v("("+e._s(a.checkedCount)+"/"+e._s(a.totalCount)+")")]):e._e()])]}}])})],1)],1),t("div",{staticStyle:{height:"50px","text-align":"center","padding-top":"10px"}},[t("el-button",{staticStyle:{width:"120px"},on:{click:e.handleClose}},[e._v(e._s(e.$t("common.cancel")))]),t("el-button",{staticStyle:{width:"120px"},attrs:{type:"primary",disabled:1==e.roletype&&"admin"!==e.userName,loading:e.loading},on:{click:e.handleSave}},[e._v(e._s(e.$t("common.save")))])],1)])])}),b=[],v=i("2909"),A=i("b85c"),x=(i("99af"),i("caad"),i("13d5"),i("4e82"),i("2532"),i("6406")),y=i("9169"),w=i("bde4"),k=i("1de3"),C=i("0d27"),S=i("8130"),M={name:"PermissionAialog",props:{value:{type:Boolean,default:!1}},data:function(){return{loading:!1,searchText:"",checkedCount:0,totalCount:0,roletype:1,roleName:"",isDisableChecked:!1,zhankai:C,bihe:S,rowConfig:{height:24,useKey:"id",keyField:"id"},treeConfig:{transform:!0,showLine:!0,rowField:"id",parentField:"parentId",expandRowKeys:[]},searchList:[],treeData:[]}},computed:Object(r["a"])({title:function(){return this.roleName+" - "+this.$t("common.setPermission")+"("+this.checkedCount+"/"+this.totalCount+")"}},Object(d["b"])(["isZh","userName"])),directives:{Clickoutside:y["a"]},watch:{value:function(e){0==e&&(this.searchText="",this.$refs.xTable.reloadData(this.treeData))},searchText:function(e){if(""!==e){var t=[];this.treeData.forEach((function(i){-1!=i.name.indexOf(e)&&t.push(i)})),this.searchList=t}else this.searchList=[]}},mounted:function(){},methods:{onClickoutside:function(){this.searchList=[]},onInputFocus:function(){var e=this.searchText;if(""!=e){var t=[];this.treeData.forEach((function(i){-1!=i.name.indexOf(e)&&t.push(i)})),this.searchList=t}},handleClickDropDown:function(e){this.$refs.xTable.setCurrentRow(e),this.$refs.xTable.scrollToRow(e),this.searchList=[]},getIndent:function(e){var t=e.level,i=20;return t*i},onClickRow:function(e){var t=e.row;this.onExpandNode(t)},handleCheckboxChange:function(e,t){e.indeterminate=!1,e.children&&this.updateChildren(e,e.checked),this.updateParent(e),this.$refs.xTable.updateData(),this.updateTreeNodeCheckedCount()},updateParent:function(e){var t=this.findParent(e);if(t){var i=t.children.every((function(e){return e.checked})),a=t.children.every((function(e){return!e.checked&&!e.indeterminate}));i?(t.checked=!0,t.indeterminate=!1):a?(t.checked=!1,t.indeterminate=!1):(t.checked=!1,t.indeterminate=!0),this.updateParent(t)}},findParent:function(e){var t,i=Object(A["a"])(this.treeData);try{for(i.s();!(t=i.n()).done;){var a=t.value,n=this.findParentRecursive(a,e);if(n)return n}}catch(r){i.e(r)}finally{i.f()}return null},findParentRecursive:function(e,t){if(e.children&&e.children.includes(t))return e;if(e.children){var i,a=Object(A["a"])(e.children);try{for(a.s();!(i=a.n()).done;){var n=i.value,r=this.findParentRecursive(n,t);if(r)return r}}catch(s){a.e(s)}finally{a.f()}}return null},updateChildren:function(e,t){var i=this;e.children.forEach((function(e){(e.checked!==t||e.indeterminate)&&(e.checked=t,e.indeterminate=!1,e.children&&i.updateChildren(e,t))}))},onExpandNode:function(e){var t=this.$refs.xTable,i=null;0==e.children.length?(i=!e.expand,e.expand=i):i=!t.isTreeExpandByRow(e),t.setTreeExpand(e,i)},handleClear:function(){this.$refs.inputText.value="",this.$refs.inputText.dispatchEvent(new InputEvent("input"))},queryPermissionsTree:function(e,t){var i=this,a=this.isZh;this.roleuuid=e,this.roletype=t,Object(o["Db"])(e).then((function(e){var n=e.records;n&&(n.forEach((function(e){e.name=a?e.showname:e.shownameen})),i.records=n,i.setTreeNodes(),i.initZtree(i.treeNodes,t))}))},setTreeNodes:function(){var e=this.$t("monitor.all"),t=this.generateTree(this.records),i=0,a=0;t.forEach((function(e){i+=e.totalCount,a+=e.checkedCount,e.checked&&a++})),i+=t.length,this.checkedCount=a,this.totalCount=i;var n=[{name:e,children:t,icon:w,totalCount:i,checkedCount:a,showname:e,shownameen:e,id:0,parentId:null,expand:!1,checked:i==a,indeterminate:i!=a&&a>0,level:0}];this.treeNodes=n},generateTree:function(e){var t=e.reduce((function(e,t){return e[t.permissiontemplateid]=t,e}),{}),i=[];function a(e){for(var t=0,i=0;i<e.length;i++){var n=e[i],r=n.children;r?t+=1+a(r):t++}return t}function n(e){for(var t=0,i=0;i<e.length;i++){var a=e[i],r=a.children;if(r){var s=n(r);t+=s,s>0&&t++}else a.checked&&t++}return t}function r(e,t){e.forEach((function(e){if(e.parentId=e.pid,e.id=e.permissiontemplateid,e.expand=!1,e.indeterminate=!1,e.level=t,e.children&&e.children.length>0){var i=a(e.children),s=n(e.children);e.totalCount=i,e.checkedCount=s,i==s?(e.checked=!0,e.indeterminate=!1):s>0&&(e.checked=!1,e.indeterminate=!0),r(e.children,t+1)}}))}return e.forEach((function(e){if(!e.pid)return e.children?e.icon=w:e.icon=k,void i.push(e);e.icon=k;var a=t[e.pid];if(a){var n=[].concat(Object(v["a"])(a.children||[]),[e]);n.sort((function(e,t){return e.permissionlevel-t.permissionlevel})),a.icon=w,a.children=n}})),i.sort((function(e,t){return e.permissionlevel-t.permissionlevel})),r(i,1),i},handleClose:function(){this.$emit("input",!1)},initZtree:function(e,t){"admin"==this.userName?this.isDisableChecked=!1:this.isDisableChecked=1==t,this.treeData=Object(x["h"])(e),this.$refs.xTable.setTreeExpand(e[0],!0)},updateTreeNodeCheckedCount:function(){var e=Object(x["g"])(this.treeData);function t(e){for(var i=0,a=0;a<e.length;a++){var n=e[a],r=n.children;if(r.length>0){var s=t(r);i+=s,s>0&&i++}else n.checked&&i++}return i}var i=this.treeData;function a(e){e.forEach((function(e){if(e.children&&e.children.length>0){for(var n=t(e.children),r=0;r<i.length;r++){var s=i[r];if(s.id==e.id){s.checkedCount=n;break}}a(e.children)}}))}a(e)},handleSave:function(){var e=this,t=[],i=this.$t("monitor.all");this.treeData.forEach((function(e){e.showname!==i&&(e.checked||e.indeterminate)&&t.push(e.permissionname)}));var a={roleuuid:this.roleuuid,permissions:t};this.loading=!0,Object(o["W"])(a).then((function(t){var i=t.status,a=t.cause;0==i?e.$XModal.message({message:e.$t("tips.saveSucc"),status:"success",zIndex:9999}):e.$XModal.message({message:e.$t("tips.saveFail")+a,status:"error",zIndex:9999}),e.loading=!1})).catch((function(t){e.loading=!1}))}}},L=M,R=(i("c525b"),Object(m["a"])(L,g,b,!1,null,null,null)),O=R.exports,T=function(){var e=this,t=e._self._c;return t("vxe-modal",{attrs:{title:e.roleName+" - "+e.title,value:e.value,className:"modal-padding0",width:"360px"},on:{hide:e.handleClose,close:e.handleClose}},[t("vxe-table",{attrs:{border:"",resizable:"","auto-resize":"","show-overflow":"",size:"mini",height:"240",data:e.users}},[t("vxe-table-column",{attrs:{type:"seq",width:"60",title:e.$t("reportForm.index")}}),t("vxe-table-column",{attrs:{field:"user",title:e.$t("login.username"),sortable:""}})],1)],1)},E=[],N={name:"BindUsersDialog",props:{value:{type:Boolean,default:!1},title:{type:String,default:""},users:{type:Array,default:function(){return[]}}},data:function(){return{roleName:""}},mounted:function(){},methods:{handleClose:function(){this.$emit("input",!1)}}},U=N,I=Object(m["a"])(U,T,E,!1,null,null,null),j=I.exports,z=i("5101"),D=i("c276"),B=i("a05b"),P=i("7b49"),X={name:"RoleList",data:function(){return{moreIcon:P,activeName:"authorize",searchTextUser:"",searchTextRole:"",userOptions:[],roleOptions:[],addAialog:!1,permissionAialog:!1,bindUsersDialog:!1,loading:!1,usersLoading:!1,isCopy:!1,roleRow:null,tableList:[],users:[],parentsList:[],bindUserTitle:"",authorizeList:[]}},computed:Object(r["a"])({},Object(d["b"])(["isZh","userName"])),mixins:[B["a"]],components:{AddRole:f,PermissionAialog:O,BindUsersDialog:j,LabelWrap:s["a"]},mounted:function(){this.permissions=[],this.queryRoles()},methods:{queryLocalUser:function(){var e=this.searchTextUser.toLocaleLowerCase(),t=[];this.cacheAuthorizeList.forEach((function(i){(""==e||-1!=i.username.toLocaleLowerCase().indexOf(e)||i.showname&&-1!=i.showname.toLocaleLowerCase().indexOf(e))&&t.push(i)})),this.authorizeList=t},queryLocalRole:function(){var e=this.searchTextRole,t=[];this.cacheTableList.forEach((function(i){"all"!=e&&i.roleuuid!=e||t.push(i)})),this.tableList=t},onChangeRole:function(e){var t=this;Object(o["X"])(e).then((function(e){var i=e.status;0==i?t.$XModal.message({message:t.$t("tips.editSucc"),status:"success",zIndex:9999}):t.$XModal.message({message:t.$t("tips.editFail"),status:"error",zIndex:9999})}))},onShowCopy:function(e){this.isCopy=!0,this.roleRow=e,this.addAialog=!0},onCommand:function(e){var t=this,i=this.row;switch(this.isCopy=!1,e){case"see":this.handleViewPermission(i);break;case"permission":this.handleViewPermission(i);break;case"edit":this.handleEdit(i);break;case"username":this.handleSee(i);break;case"delete":this.$confirm(this.$t("tips.confirmDelete"),{title:this.$t("bgManage.tip"),center:!0,customClass:"MessageBox_confirm"}).then((function(e){"confirm"==e&&t.handleDelete(i)})).catch((function(e){}));break}},queryParents:function(e){var t=this;this.parentsList=[],Object(o["Bb"])(e).then((function(e){var i=e.status,a=e.records;0==i&&(a.forEach((function(e){e.usertypeStr=Object(D["cb"])(t.isZh,e.usertype)})),t.parentsList=a)}))},cellClick:function(e){var t=e.row;this.row=t},cellDblclick:function(e){var t=e.row;this.handleViewPermission(t)},onOpenDialog:function(){this.roleRow=null,this.isCopy=!1,this.addAialog=!0},handleViewPermission:function(e){var t=e.roleuuid,i=e.roletype,a=e.rolename;this.permissionAialog=!0,this.$refs.permissionAialog.roleName=a,this.$refs.permissionAialog.queryPermissionsTree(t,i)},handleDelete:function(e){var t=this,i=(this.isZh,0);this.tableList.forEach((function(t,a){t.roleuuid==e.roleuuid&&(i=a)})),Object(o["I"])(e.roleuuid).then((function(a){var n=a.status,r=a.users;if(0==n){t.$XModal.message({message:t.$t("tips.deleteSucc"),status:"success",zIndex:9999}),t.$delete(t.tableList,i);var s=[];t.tableList.forEach((function(e){var t=e.remark,i=e.rolename+"(".concat(e.creater,")");t&&(i+="-"+t),s.push({label:i,value:e.roleuuid})})),t.roleOptions=s;var o=[];t.cacheTableList.forEach((function(t,i){t.roleuuid!==e.roleuuid&&o.push(t)})),t.cacheTableList=o}else 1==n?t.$XModal.message({message:t.$t("tips.deleteFail")+":"+t.$t("tips.noPermission"),status:"success",zIndex:9999}):2==n&&(t.$refs.bindUsersDialog.roleName=e.rolename,t.bindUsersDialog=!0,t.users=r.map((function(e){return{user:e}})),t.bindUserTitle=t.$t("tips.deleteFail")+"-"+t.$t("common.bindUser")+"("+r.length+")")}))},handleSee:function(e){var t=this;Object(o["Ub"])(e.roleuuid).then((function(i){var a=i.users;a&&a.length>0?(t.bindUsersDialog=!0,t.$refs.bindUsersDialog.roleName=e.rolename,t.users=a.map((function(e){return{user:e}})),t.bindUserTitle=t.$t("common.bindUser")+"("+a.length+")"):t.$XModal.message({message:t.$t("missing.roleNoBindUser"),status:"error",zIndex:9999})}))},handleEdit:function(e){this.roleRow=e,this.$refs.addAialog.roleName=e.rolename,this.addAialog=!0},queryRoles:function(){var e=this;this.loading=!0;var t=this.isZh;Object(o["Lb"])({}).then((function(i){var a=i.status,n=i.roles,r=[],s=[];0==a&&null!=n&&n.forEach((function(i){1==i.roletype&&0==t&&(i.rolename=i.rolenameen),i.roletypeStr=1==i.roletype?e.$t("bgManage.system"):e.$t("bgManage.custom"),i.creatertimeStr=z["a"].longToLocalDateTimeStr(i.createtime);var a=i.remark,n=i.rolename+"(".concat(i.creater,")");a&&(n+="-"+a),s.push({label:n,value:i.roleuuid}),r.push(i)})),e.roleOptions=s,e.tableList=r,e.cacheTableList=r,e.loading=!1})).catch((function(t){console.log(t),e.loading=!1})),this.usersLoading=!0,Object(o["Tb"])(this.userName,1).then((function(t){var i=[],a=[{username:"all",showname:e.$t("monitor.all")}];0==t.status&&t.userlists&&(t.userlists.forEach((function(t){t.usertypeStr=Object(D["cb"])(e.isZh,t.usertype)})),i=t.userlists,i.forEach((function(e){a.push(e)}))),e.userOptions=a,e.authorizeList=i,e.cacheAuthorizeList=i})).finally((function(t){e.usersLoading=!1}))},addRole:function(e){e.creatertimeStr=z["a"].longToLocalDateTimeStr(e.createtime),e.roletypeStr=1==e.roletype?this.$t("bgManage.system"):this.$t("bgManage.custom");var t=e.remark,i=e.rolename+"(".concat(e.creater,")");t&&(i+="-"+t),this.roleOptions.push({label:i,value:e.roleuuid}),this.cacheTableList.push(e),this.tableList=this.cacheTableList}}},Y=X,J=(i("d597"),Object(m["a"])(Y,a,n,!1,null,null,null)),Q=J.exports;t["default"]=Q},"918c":function(e,t,i){},bde4:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAdJJREFUOE+lkzFMFEEUhv83B40Fsgu9zc2dQQsToKIAQ2UQLAQSSCw17Jw2EIgJDRQWQkhUvDlsJaFAKEw0FCQKJFbGwkSN3m6opAJ2KQ2GeWRWN9nz4CBxynn//817f+YR/vPQaf5mvZ03/HvI1o0RGwcP5MZJ2hMBji4PE+gpiNfBJAD0ApgMlXzyL6QK4JS+dxAyRRCGwxH5zRrcBb8FjCXGUSHyLn9IQ6oB2n8N4Euk5GRa6Gj/EYCrkZK3zgK8J+LnoZdbTQvdUvk2M92PlLxeG1AsT5AQnaGX7akEBG/ZmM2okJupCYhn1sEbEH8E4VUsZgyAqT1U2ZtnhhgHdmQGQaIfwJW/hq9gs4KMWE6CTUAVIbranwMwCqZxMK9dONzd/nXRrcNhptUYbgPRLAMPIyUfVwEcHYwL8BDXoy+8K3/aTpLXHB3cI/ALAWoz4EUiXtj3cs8sJO6gsVi+JkAvSZgb+15+Jx7DYBmEMWa6lJj3VPbTnxpvGcHdByP5zzGgqeTfYUZvqORg0lqzDloN+B2ABvuyNSc1V/trDF6MVG4pBrjFH1PpdJO/byH23pob5/0uUYfOtC705HRNQFocA4TpqgAU8lOnbuN5t/wYZEDEEfMs/RoAAAAASUVORK5CYII="},c525b:function(e,t,i){"use strict";i("2873")},d597:function(e,t,i){"use strict";i("918c")}}]);