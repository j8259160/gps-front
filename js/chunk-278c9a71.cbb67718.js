(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-278c9a71"],{"17f2":function(e,t,i){"use strict";i("6d43")},"3b13":function(e,t,i){},"3fee":function(e,t,i){"use strict";i.r(t);var r=function(){var e=this,t=e._self._c;return t("div",{staticClass:"report-form full"},[t("div",{staticClass:"report-form-inner"},[t("div",{staticClass:"report-form-inner-header",staticStyle:{height:"35px"}},[t("div",{staticClass:"f_left"},[t("MultiChoiceVehicle",{on:{onSelectDevice:e.onSelectDevice}})],1),t("div",{staticClass:"f_left",staticStyle:{width:"164px"}},[t("LabelWrap",{attrs:{label:e.$t("common.duration")}},[t("el-select",{model:{value:e.duration,callback:function(t){e.duration=t},expression:"duration"}},e._l(e.optionList,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1),t("div",{staticClass:"f_left"},[t("el-button",{attrs:{loading:e.loading,type:"primary"},on:{click:e.handleQuery}},[e._v(e._s(e.$t("common.query")))])],1),t("div",{staticClass:"f_left"},[t("el-button",{attrs:{type:"primary",loading:e.exportLoading1},on:{click:e.exportData}},[e._v(e._s(e.$t("common.export")))])],1),t("div",{staticClass:"f_center"}),t("div",{staticClass:"f_right"},[t("el-button",{attrs:{type:"primary"},on:{click:function(t){e.importDialog=!0}}},[e._v(e._s(e.$t("common.importQuery")))])],1)]),t("div",{staticClass:"report-form-inner-content",staticStyle:{top:"39px"}},[t("vxe-table",{ref:"xTable",staticClass:"mytable-scrollbar",attrs:{"sort-config":e.sortConfig,"menu-config":e.tableMenu,border:"",resizable:"","auto-resize":"","show-overflow":"","highlight-hover-row":"",size:"mini",height:"auto",data:e.totalList},on:{"menu-click":e.handleClickTableMenu}},[t("vxe-table-column",{attrs:{type:"seq",width:"60",title:e.$t("reportForm.index")}}),t("vxe-table-column",{attrs:{field:"creater",title:e.$t("reportForm.creater"),width:"120",sortable:""},scopedSlots:e._u([{key:"default",fn:function(i){return[t("el-popover",{attrs:{placement:"bottom",trigger:"click"}},[t("div",{staticClass:"parents-wrapper"},e._l(e.parentsList,(function(i){return t("div",{key:i.username},[e._v(e._s(i.username)+"("+e._s(i.usertypeStr)+")")])})),0),t("el-button",{staticStyle:{color:"#000000"},attrs:{slot:"reference",type:"text"},on:{click:function(t){return e.queryParents(i.row.creater)}},slot:"reference"},[e._v(e._s(i.row.creater))])],1)]}}])}),t("vxe-table-column",{attrs:{field:"groupname",title:e.$t("reportForm.groupName"),width:"120",sortable:""}}),t("vxe-table-column",{attrs:{field:"devicename",title:e.$t("alarm.devName"),width:"120",sortable:""}}),t("vxe-table-column",{attrs:{field:"deviceid",title:e.$t("alarm.devNum"),width:"120",sortable:""}}),t("vxe-table-column",{attrs:{field:"deviceType",title:e.$t("reportForm.deviceType"),width:"120"}}),t("vxe-table-column",{attrs:{field:"updatetimeStr",title:e.$t("reportForm.offlineTime"),width:"145",sortable:""}}),t("vxe-table-column",{attrs:{field:"durationStr",align:"right",title:e.$t("common.duration"),width:"135",sortable:""}}),t("vxe-table-column",{attrs:{field:"sim",title:e.$t("reportForm.sim"),width:"125",sortable:""}}),t("vxe-table-column",{attrs:{field:"strstatus",title:e.$t("reportForm.status"),width:"180",sortable:""}}),t("vxe-table-column",{attrs:{field:"firstloctimeStr",title:e.$t("bgManage.firstloctimeStr"),width:"125",sortable:""}}),t("vxe-table-column",{attrs:{field:"overdueTime",title:e.$t("alarm.expireTime"),width:"125",sortable:""}}),t("vxe-table-column",{attrs:{field:"simiccid",title:"ICCID",width:"180",sortable:""}}),t("vxe-table-column",{attrs:{field:"remark",title:e.$t("reportForm.remarks"),width:"145",sortable:""}})],1)],1)]),t("ImportDeviceidsDialog",{on:{"on-import":e.onImportDevice},model:{value:e.importDialog,callback:function(t){e.importDialog=t},expression:"importDialog"}})],1)},a=[],o=i("5530"),s=(i("14d9"),i("4e82"),i("a9e3"),i("d3b7"),i("159b"),i("e561")),l=i("201d"),c=i("5bca"),n=i("1c31"),u=i("6e52"),d=i("5101"),m=i("c276"),p=i("2f62"),v=i("0c87"),f=i("a05b"),h={name:"offlineReport",data:function(){return{loading:!1,importDialog:!1,exportLoading1:!1,duration:"1",optionList:[],totalList:[],sortConfig:{sortMethod:function(e){var t=e.data,i=e.sortList,r=i[0],a=r.property,o=r.order,s=[];return s="durationStr"==a?"desc"===o?t.sort((function(e,t){return t.duration-e.duration})):"asc"===o?t.sort((function(e,t){return e.duration-t.duration})):t.sort():"desc"===o?t.sort((function(e,t){var i=t[a]+"";return i.localeCompare(e[a])})):"asc"===o?t.sort((function(e,t){var i=e[a]+"";return i.localeCompare(t[a])})):t.sort(),s}}}},mixins:[f["a"],v["a"]],components:{MultiChoiceVehicle:s["a"],LabelWrap:l["a"],ImportDeviceidsDialog:c["a"]},computed:Object(o["a"])({},Object(p["b"])(["isZh","deviceTypes"])),methods:{onSelectDevice:function(e){this.deviceids=e},onImportDevice:function(e){var t=this,i=cacheMgr.deviceInfos,r=this.deviceTypes,a=[],o=Object(m["t"])(i),s=o.simMap,l=o.iccidMap;e.forEach((function(e,o){var c=Object(m["ob"])(i,s,l,e);if(c){var n=cacheMgr.lastPositions[c.deviceid];if(n){var p=n.deviceid,v=u["a"].deviceInfos[p],f=v.devicename,h=v.simnum,b=r[v.devicetype].typename,y=0!=v.firstloctime?d["a"].format(new Date(v.firstloctime),"yyyy-MM-dd"):"-",g=d["a"].format(new Date(v.expirenotifytime),"yyyy-MM-dd");a.push({creater:v.creater,groupname:v.groupname,deviceid:p,devicename:f,deviceType:b,updatetimeStr:d["a"].longToLocalDateTimeStr(n.updatetime),duration:d["a"].getCurrentUTC()-n.updatetime,durationStr:Object(m["Pb"])(d["a"].getCurrentUTC()-n.updatetime,!0),strstatus:t.isZh?n.strstatus:n.strstatusen,sim:h,firstloctimeStr:y,overdueTime:g,simiccid:v.simiccid?v.simiccid:"",remark:Object(m["v"])(v)})}}})),this.totalList=a},handleQuery:function(){var e=this,t=this.deviceids;if(t.length>0){this.loading=!0;var i={deviceids:t,offlinehours:Number(this.duration)};Object(n["V"])(i).then((function(t){var i=t.records;e.loading=!1;var r=e.deviceTypes,a=[];i&&i.forEach((function(t){var i=t.deviceid,o=u["a"].deviceInfos[i],s=o.devicename,l=o.simnum,c=r[t.devicetype].typename,n=0!=o.firstloctime?d["a"].format(new Date(o.firstloctime),"yyyy-MM-dd"):"-",p=d["a"].format(new Date(o.expirenotifytime),"yyyy-MM-dd");a.push({creater:o.creater,groupname:o.groupname,deviceid:i,devicename:s,deviceType:c,updatetimeStr:d["a"].longToLocalDateTimeStr(t.updatetime),duration:d["a"].getCurrentUTC()-t.updatetime,durationStr:Object(m["Pb"])(d["a"].getCurrentUTC()-t.updatetime,!0),strstatus:e.isZh?t.strstatus:t.strstatusen,sim:l,firstloctimeStr:n,overdueTime:p,simiccid:o.simiccid?o.simiccid:"",remark:Object(m["v"])(o)})})),e.totalList=a})).catch((function(t){e.loading=!1}))}else this.$XModal.message({message:this.$t("tips.selectDevice"),status:"error",zIndex:9999})},exportData:function(){var e=[[this.$t("reportForm.index"),this.$t("reportForm.creater"),this.$t("reportForm.groupName"),this.$t("alarm.devName"),this.$t("alarm.devNum"),this.$t("reportForm.deviceType"),this.$t("reportForm.offlineTime"),this.$t("common.duration"),this.$t("reportForm.sim"),this.$t("reportForm.status"),this.$t("bgManage.firstloctimeStr"),this.$t("alarm.expireTime"),"ICCID",this.$t("reportForm.remarks")]],t=this.$refs.xTable.getTableData().visibleData;if(0!=t.length){t.forEach((function(t,i){var r=[];r.push(i+1),r.push(t.creater),r.push(t.groupname),r.push(t.devicename),r.push(t.deviceid),r.push(t.deviceType),r.push(t.updatetimeStr),r.push(t.durationStr),r.push(t.sim?t.sim:""),r.push(t.strstatus),r.push(t.firstloctimeStr),r.push(t.overdueTime),r.push(t.simiccid),r.push(t.remark),e.push(r)}));var i={title:this.$t("reportForm.offlineReport"),data:e};this.exportLoading1=!0,new ExcelCls(i).exportExcel(this)}}},mounted:function(){var e=this;this.deviceids=[],this.$nextTick((function(){var t=e.$t("monitor.hour"),i=e.$t("reportForm.d");e.optionList=[{label:"1"+t,value:"1"},{label:"6"+t,value:"6"},{label:"12"+t,value:"12"},{label:"1"+i,value:"24"},{label:"7"+i,value:"168"},{label:"15"+i,value:"360"},{label:"30"+i,value:"720"},{label:e.$t("reportForm.halfYear"),value:"4320"},{label:e.$t("reportForm.oneYear"),value:"8760"}]}))}},b=h,y=(i("17f2"),i("2877")),g=Object(y["a"])(b,r,a,!1,null,null,null),x=g.exports;t["default"]=x},"6d43":function(e,t,i){},7031:function(e,t,i){"use strict";i("3b13")},e561:function(e,t,i){"use strict";var r=i("ea22");t["a"]=r["a"]},ea22:function(e,t,i){"use strict";var r=function(){var e=this,t=e._self._c;return t("div",{staticClass:"multi-choice multi-choice-vehicle"},[t("div",{staticClass:"multi-choice-input"},[t("ZtreeDeviceDropdown",{ref:"ztreeDevice",attrs:{disableShare:e.disableShare,isCheck:"",placeholder:this.$t("tips.selectDevice"),isQueryInitData:e.isQueryInitData,selectDeviceIds:e.multipleDeviceids},on:{onTreeCheck:e.onTreeCheck}})],1)])},a=[],o=i("5530"),s=(i("4795"),i("2f62")),l=i("2df7"),c={name:"MultiChoiceVehicle",props:{disableShare:{type:Boolean,default:!1}},data:function(){return{}},computed:Object(o["a"])({},Object(s["b"])(["isQueryInitData","multipleDeviceids"])),components:{ZtreeDeviceDropdown:l["a"]},methods:Object(o["a"])(Object(o["a"])({},Object(s["c"])(["setMultipleDeviceids"])),{},{onTreeCheck:function(e){this.$emit("onSelectDevice",e),this.setMultipleDeviceids(e)},clearText:function(){var e=this;setTimeout((function(){e.$refs.ztreeDevice.clearText()}),300)}})},n=c,u=(i("7031"),i("2877")),d=Object(u["a"])(n,r,a,!1,null,null,null);t["a"]=d.exports}}]);