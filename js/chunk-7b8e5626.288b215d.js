(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7b8e5626"],{"33d2":function(e,t,a){"use strict";a.r(t);a("c975"),a("b0c0");var s=function(){var e=this,t=e._self._c;return t("div",{staticClass:"edit-user full"},[t("div",{staticClass:"edit-user-left"},[t("div",{staticClass:"edit-user-inner full"},[t("div",{staticClass:"edit-user-inner-title"},[t("i",{staticClass:"circle"}),t("b",{domProps:{textContent:e._s(e.$t("bgManage.editUserTitle1"))}}),t("span",{domProps:{textContent:e._s(e.$t("bgManage.editUserDesc1"))}})]),t("div",{staticClass:"edit-user-inner-content"},[t("div",{staticClass:"edit-user-inner-content-search"},[t("div",[t("el-input",{staticStyle:{width:"100%"},attrs:{clearable:"",placeholder:e.$t("bgManage.pleaseEnterUsernameOrGroupname")},model:{value:e.searchText,callback:function(t){e.searchText=t},expression:"searchText"}},[t("i",{staticClass:"el-input__icon el-icon-search",attrs:{slot:"prefix"},slot:"prefix"})])],1),t("div",{on:{click:e.refreshZtree}},[t("i",{staticClass:"el-icon-refresh"})])]),t("div",{staticClass:"edit-user-inner-content-ztree drop-down-vxetree noselect"},[t("vxe-table",{ref:"xTable",staticClass:"mytree-scrollbar",attrs:{loading:e.treeLoading,height:"100%",size:"mini","show-overflow":"","highlight-hover-row":"","highlight-current-row":"","row-config":e.rowConfig,"auto-resize":!0,border:"none","checkbox-config":{checkStrictly:!1,showHeader:!0},"tree-config":e.treeConfig,"show-header":!1,"scroll-y":{enabled:!0,gt:0},data:e.treeData},on:{"cell-click":e.onClickRow}},[t("vxe-table-column",{attrs:{width:"100%",field:"id"},scopedSlots:e._u([{key:"default",fn:function(a){var s=a.row;return[t("div",{staticClass:"fence-checkbox-cell",style:{paddingLeft:e.getIndent(s)+"px"},on:{contextmenu:function(e){e.preventDefault()}}},[s.children.length?t("span",{staticStyle:{position:"relative",top:"1.5px","padding-right":"3px"},on:{dblclick:function(e){e.stopPropagation()},click:function(t){return t.stopPropagation(),e.onExpandNode(s)}}},[(0==s.children.length?s.expand:e.$refs.xTable.isTreeExpandByRow(s))?t("img",{attrs:{src:e.bihe,width:"12",height:"12"}}):t("img",{attrs:{src:e.zhankai,width:"12",height:"12"}})]):t("span",{staticStyle:{position:"relative",top:"1.5px","padding-right":"3px"}},[t("img",{staticStyle:{visibility:"hidden"},attrs:{src:e.zhankai,width:"12",height:"12"}})]),t("span",{on:{click:function(e){e.stopPropagation()},dblclick:function(e){e.stopPropagation()}}},[t("el-radio",{staticStyle:{margin:"0px 3px 0px 2px"},attrs:{label:s.id},on:{change:function(t){return e.handleCheckboxChange(s)}},model:{value:e.radio,callback:function(t){e.radio=t},expression:"radio"}})],1),"user"==s.nodeType?t("img",{staticStyle:{width:"16px",height:"16px",border:"0px",position:"relative",top:"3.5px"},attrs:{src:s.icon}}):e._e(),"group"==s.nodeType?t("img",{staticStyle:{width:"15px",height:"14px",border:"0px",position:"relative",top:"2.5px"},attrs:{src:s.icon}}):e._e(),t("span",{staticStyle:{"padding-left":"3px"},domProps:{textContent:e._s(s.name)}}),t("span",[e._v("("+e._s(s.allCount)+")")])])]}}])})],1)],1)])])]),t("div",{staticClass:"edit-user-right"},[t("div",{staticClass:"edit-user-inner full"},[t("div",{staticClass:"edit-user-inner-title"},[t("i",{staticClass:"circle"}),t("b",{domProps:{textContent:e._s(e.rightTitle)}}),t("span",{domProps:{textContent:e._s(e.$t("bgManage.editUserDesc2"))}})]),t("div",{staticClass:"edit-user-inner-content"},[t("div",{staticClass:"full",staticStyle:{overflow:"hidden"}},["user"==e.activeTab?t("div",{staticClass:"user"},[t("el-row",{directives:[{name:"show",rawName:"v-show",value:e.username!==e.userName,expression:"username !== userName"}],staticClass:"margin_b12"},[t("el-col",{staticClass:"red-star",attrs:{span:1}},[e._v("*")]),t("el-col",{attrs:{span:23}},[t("DropdownZtreeUser",{ref:"ztreeUser",attrs:{showLabel:"",label:e.$t("reportForm.creater")},model:{value:e.creater,callback:function(t){e.creater=t},expression:"creater"}})],1)],1),t("el-row",{staticClass:"margin_b12"},[t("el-col",{staticClass:"red-star",attrs:{span:1}},[e._v("*")]),t("el-col",{attrs:{span:11}},[t("LabelWrap",{attrs:{label:e.$t("bgManage.loginUser")}},[t("el-input",{staticStyle:{width:"100%"},attrs:{clearable:"",disabled:!0},model:{value:e.username,callback:function(t){e.username=t},expression:"username"}})],1)],1),t("el-col",{attrs:{span:11,offset:1}},[t("LabelWrap",{attrs:{label:e.$t("bgManage.contacts")}},[t("el-input",{staticStyle:{width:"100%"},attrs:{clearable:"",disabled:e.disabled,placeholder:e.$t("bgManage.pleaseEnterContacts")},model:{value:e.cardname,callback:function(t){e.cardname=t},expression:"cardname"}})],1)],1)],1),t("el-row",{staticClass:"margin_b12"},[t("el-col",{staticClass:"red-star",attrs:{span:1}},[e._v("*")]),t("el-col",{attrs:{span:11}},[t("LabelWrap",{attrs:{label:e.$t("bgManage.accountLevel")}},[t("el-select",{staticStyle:{width:"100%"},attrs:{disabled:e.disabled},model:{value:e.userLevel,callback:function(t){e.userLevel=t},expression:"userLevel"}},e._l(e.userOptions,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1),t("el-col",{attrs:{span:11,offset:1}},[t("LabelWrap",{staticStyle:{width:"100%"},attrs:{label:e.$t("device.driverphone")}},[t("el-input",{attrs:{clearable:"",disabled:e.disabled,placeholder:e.$t("bgManage.pleaseEnterPhone")},model:{value:e.phone,callback:function(t){e.phone=t},expression:"phone"}})],1)],1)],1),t("el-row",{staticClass:"margin_b12"},[t("el-col",{attrs:{span:11,offset:1}},[t("LabelWrap",{attrs:{label:e.$t("bgManage.nickname")}},[t("el-input",{staticStyle:{width:"100%"},attrs:{clearable:"",disabled:e.disabled,placeholder:e.$t("bgManage.pleaseEnterNickname")},model:{value:e.showname,callback:function(t){e.showname=t},expression:"showname"}})],1)],1),t("el-col",{attrs:{span:11,offset:1}},[t("LabelWrap",{attrs:{label:e.$t("common.email")}},[t("el-input",{staticStyle:{width:"100%"},attrs:{clearable:"",disabled:e.disabled,placeholder:e.$t("bgManage.pleaseEnterEmail")},model:{value:e.email,callback:function(t){e.email=t},expression:"email"}})],1)],1)],1),t("el-row",{staticClass:"margin_b12"},[t("el-col",{attrs:{span:11,offset:1}},[t("LabelWrap",{attrs:{label:e.$t("bgManage.moreLanding")}},[t("el-select",{staticStyle:{width:"100%"},attrs:{disabled:e.disabled},model:{value:e.multilogin,callback:function(t){e.multilogin=t},expression:"multilogin"}},e._l(e.loginOptions,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1),t("el-col",{attrs:{span:11,offset:1}},[t("LabelWrap",{attrs:{label:e.$t("common.weChat")}},[t("el-input",{staticStyle:{width:"100%"},attrs:{clearable:"",disabled:e.disabled,placeholder:e.$t("bgManage.pleaseEnterWeChat")},model:{value:e.wechat,callback:function(t){e.wechat=t},expression:"wechat"}})],1)],1)],1),t("el-row",{staticClass:"margin_b12"},[t("el-col",{attrs:{span:11,offset:1}},[t("LabelWrap",{attrs:{label:e.$t("bgManage.companyName")}},[t("el-input",{staticStyle:{width:"100%"},attrs:{clearable:"",disabled:e.disabled,placeholder:e.$t("bgManage.pleaseEnterCorporateName")},model:{value:e.companyname,callback:function(t){e.companyname=t},expression:"companyname"}})],1)],1),t("el-col",{attrs:{span:11,offset:1}},[t("LabelWrap",{attrs:{label:"QQ"}},[t("el-input",{staticStyle:{width:"100%"},attrs:{clearable:"",disabled:e.disabled,placeholder:e.$t("bgManage.pleaseEnterQQ")},model:{value:e.qq,callback:function(t){e.qq=t},expression:"qq"}})],1)],1)],1),t("el-row",{staticClass:"margin_b12"},[t("el-col",{attrs:{span:23,offset:1}},[t("LabelWrap",{attrs:{label:e.$t("bgManage.companyAddress")}},[t("el-input",{staticStyle:{width:"100%"},attrs:{clearable:"",disabled:e.disabled,placeholder:e.$t("bgManage.pleaseEnterCorporateAddress")},model:{value:e.address,callback:function(t){e.address=t},expression:"address"}})],1)],1)],1),t("el-row",{staticClass:"margin_b12"},[t("el-col",{staticStyle:{"text-align":"center","padding-top":"10px"},attrs:{span:23,offset:1}},[t("el-button",{staticStyle:{width:"90px"},attrs:{type:"primary",loading:e.loading,disabled:e.disabled},on:{click:e.handleClickSave}},[e._v(e._s(e.$t("common.save")))]),e._v("       "),t("el-popconfirm",{attrs:{placement:"top","confirm-button-text":e.$t("common.confirm"),"cancel-button-text":e.$t("common.cancel"),icon:"el-icon-info","icon-color":"red",title:e.$t("tips.confirmDelete")},on:{confirm:e.onDeleteUser}},[t("el-button",{staticStyle:{width:"90px"},attrs:{slot:"reference",type:"danger",disabled:e.disabled},slot:"reference"},[e._v(e._s(e.$t("common.delete")))])],1),e._v("       "),e.username!=e.userName?t("el-popconfirm",{attrs:{placement:"top",icon:"el-icon-info","icon-color":"red","confirm-button-text":e.$t("common.confirm"),"cancel-button-text":e.$t("common.cancel"),title:e.$t("tips.confirmResetPassword")},on:{confirm:e.onRsetPassword}},[t("el-button",{attrs:{slot:"reference"},slot:"reference"},[e._v(e._s(e.$t("common.resetPassword")))])],1):e._e()],1)],1)],1):e._e(),"group"==e.activeTab?t("div",{staticClass:"group"},[t("el-row",{staticClass:"margin_b12"},[t("el-col",{staticClass:"red-star",attrs:{span:1}},[e._v("*")]),t("el-col",{attrs:{span:23}},[0==e.groupid?t("LabelWrap",{attrs:{label:e.$t("reportForm.creater")}},[t("div",{staticClass:"full",staticStyle:{padding:"8px 0px 0px 15px","font-size":"13px","background-color":"#f5f7fa",color:"#c0c4cc"},domProps:{textContent:e._s(e.groupCreater)}})]):t("DropdownZtreeUser",{ref:"ztreeGourpUser",attrs:{showLabel:"",label:e.$t("reportForm.creater")},model:{value:e.groupCreater,callback:function(t){e.groupCreater=t},expression:"groupCreater"}})],1)],1),t("el-row",{staticClass:"margin_b12"},[t("el-col",{attrs:{span:23,offset:1}},[t("LabelWrap",{attrs:{label:e.$t("reportForm.groupName")}},[t("el-input",{staticStyle:{width:"100%"},attrs:{clearable:"",placeholder:e.$t("bgManage.pleaseEnterGroupName"),disabled:e.isDisabled},model:{value:e.groupname,callback:function(t){e.groupname=t},expression:"groupname"}})],1)],1)],1),0==e.groupid?t("el-row",{staticClass:"margin_b12"},[t("el-col",{staticStyle:{"text-align":"center","padding-top":"10px"},attrs:{span:23,offset:1}},[t("el-button",{staticStyle:{width:"90px"},attrs:{type:"primary",loading:e.editGroupLoading,disabled:e.isDisabled},on:{click:e.handleEditGroup}},[e._v(e._s(e.$t("common.save")))]),e._v("       "),t("el-button",{staticStyle:{width:"90px"},attrs:{loading:e.deleteLoading,type:"danger",disabled:e.isDisabled},on:{click:e.handleDeleteGroup}},[e._v(e._s(e.$t("common.delete")))])],1)],1):t("el-row",{staticClass:"margin_b12"},[t("el-col",{staticStyle:{"text-align":"center","padding-top":"10px"},attrs:{span:23,offset:1}},[t("el-button",{staticStyle:{width:"84px"},attrs:{type:"primary",loading:e.editGroupLoading,disabled:e.isDisabled},on:{click:e.handleEditGroup}},[e._v(e._s(e.$t("common.save")))]),e._v("       "),t("el-button",{staticStyle:{width:"84px"},attrs:{loading:e.deleteLoading,type:"danger",disabled:e.isDisabled},on:{click:e.handleDeleteGroup}},[e._v(e._s(e.$t("common.delete")))]),e._v("       "),0!=e.groupid?t("el-button",{staticStyle:{width:"84px"},attrs:{type:"primary",plain:""},on:{click:function(t){e.modal=!0}}},[e._v(e._s(e.$t("missing.shareGroup")))]):e._e()],1)],1)],1):e._e()])])])]),t("vxe-modal",{attrs:{title:e.groupname+" - "+e.$t("bgManage.shareGroup")+"("+e.tocreaters.length+")",className:"modal-padding0",value:e.modal,width:"760px"},on:{hide:function(t){e.modal=!1},close:function(t){e.modal=!1}}},[t("el-row",{staticClass:"margin_b12"},[t("el-col",{attrs:{span:24}},[t("vxe-table",{ref:"xTable",attrs:{border:"",resizable:"","auto-resize":"","show-overflow":"","highlight-current-row":"",size:"mini",height:"300",data:e.userList},on:{"checkbox-all":e.selectAllEvent,"checkbox-change":e.selectChangeEvent}},[t("vxe-table-column",{attrs:{type:"seq",width:"60",title:e.$t("reportForm.index")}}),t("vxe-table-column",{attrs:{type:"checkbox",width:"50"}}),t("vxe-table-column",{attrs:{field:"username",title:e.$t("bgManage.user"),filters:[{username:""}],"filter-method":e.filterAgeMethod},scopedSlots:e._u([{key:"filter",fn:function(a){var s=a.$panel,r=a.column;return[e._l(r.filters,(function(a,r){return[t("div",{staticStyle:{padding:"5px"}},[t("div",{staticClass:"el-input--small"},[t("input",{directives:[{name:"model",rawName:"v-model",value:a.data,expression:"option.data"}],key:r,staticClass:"el-input__inner",attrs:{type:"type",placeholder:e.$t("tips.enterToConfirmFiltering")},domProps:{value:a.data},on:{input:[function(t){t.target.composing||e.$set(a,"data",t.target.value)},function(e){return s.changeOption(e,!!a.data,a)}],keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:s.confirmFilter()}}})])])]}))]}}])}),t("vxe-table-column",{attrs:{field:"showname",title:e.$t("bgManage.displayName"),sortable:""}}),t("vxe-table-column",{attrs:{title:e.$t("reportForm.creater"),field:"creater",sortable:""}})],1)],1)],1),t("el-row",{staticClass:"margin_b12"},[t("el-col",{staticStyle:{"text-align":"center"},attrs:{span:24}},[t("el-button",{staticStyle:{width:"120px"},attrs:{type:"primary",loading:e.saveLoading},on:{click:e.addShareGroup}},[e._v(e._s(e.$t("common.save")))])],1)],1)],1)],1)},r=[],n=a("5530"),i=(a("99af"),a("4de4"),a("d81d"),a("14d9"),a("e9c4"),a("a9e3"),a("b680"),a("b64b"),a("d3b7"),a("498a"),a("159b"),a("4795"),a("c276")),o=a("2ef0"),l=a("6406"),c=a("6e52"),d=a("c7bc"),u=a("0139"),p=a("2f62"),h=a("b562"),m=a("e285"),g=a("0d33"),f=a("7fa8"),b=a("0d27"),v=a("8130"),x={name:"editUser",data:function(){return{loading:!1,treeLoading:!1,isUser:!0,modal:!1,visible2:!1,activeTab:"user",creater:"",groupCreater:"",tocreater:"",tocreaters:[],username:"",companyname:"",address:"",userIcon:g,groupIcon:f,zhankai:b,bihe:v,userLevel:"",showname:"",cardname:"",email:"",qq:"",wechat:"",phone:"",userOptions:[],multilogin:1,loginOptions:[],groupname:"",groupid:"",searchText:"",isDisabled:!1,editGroupLoading:!1,deleteLoading:!1,saveLoading:!1,userList:[],radio:"",rowConfig:{height:24,useKey:"id",keyField:"id"},treeConfig:{transform:!0,showLine:!0,rowField:"id",parentField:"parentId",expandRowKeys:[]},treeData:[]}},computed:Object(n["a"])(Object(n["a"])({},Object(p["b"])(["isZh","userName","userLevelList","isQueryInitData","userType"])),{},{rightTitle:function(){return this.isZh?this.isUser?"编辑用户":"编辑分组":this.isUser?"Edit user":"Edit group"},disabled:function(){return this.username==this.userName}}),watch:{searchText:function(e){this.searchZtree(this,e.trim())},isQueryInitData:function(e){e&&this.init()},creater:function(e){if(this.isTreeCheck)this.isTreeCheck=!1;else{var t=c["a"].getUserByUserName(e);t&&(this.userOptions=this.getUserOptions(t.usertype,11==t.usertype),this.userOptions.length>0&&(this.userLevel=this.userOptions[0].value))}},modal:function(e){var t=this;if(e){var a=this.groupCreater,s=this.cacheList,r=[];s.forEach((function(e){e.username!=a&&r.push(JSON.parse(JSON.stringify(e)))})),this.userList=r,setTimeout((function(){var e=t.$refs.xTable;Object(m["ub"])(t.groupid).then((function(a){var s=a.groups;if(s){var r=s.map((function(e){return e.tocreater})),n=t.userList;r.forEach((function(t){n.forEach((function(a){a.username==t&&e.setCheckboxRow(a,!0)}))})),t.tocreaters=r}}))}),300)}else{var n=this.$refs.xTable;n.setAllCheckboxRow(!1)}}},components:{DropdownZtreeUser:d["a"],LabelWrap:u["a"]},methods:Object(n["a"])(Object(n["a"])({},Object(p["c"])(["setIsReloadRootuser","setReportTagList"])),{},{onClickRow:function(e){var t=e.row;this.handleCheckboxChange(t)},handleCheckboxChange:function(e){var t=this,a=this.$refs.xTable;this.treeData.forEach((function(a){a.id==e.id?(t.radio=e.id,a.checked=!0):a.checked=!1})),a.setCurrentRow(e),this.onTreeCheck(e)},onExpandNode:function(e){var t=this.$refs.xTable,a=null;0==e.children.length?(a=!e.expand,e.expand=a):a=!t.isTreeExpandByRow(e),t.setTreeExpand(e,a)},getIndent:function(e){var t=18;return e.level*t},filterAgeMethod:function(e){var t=e.option,a=e.row;return-1!=a.username.indexOf(t.data)},selectAllEvent:function(e){e.checked;var t=e.records;this.tocreaters=t.map((function(e){return e.username}))},selectChangeEvent:function(e){e.checked;var t=e.records;this.tocreaters=t.map((function(e){return e.username}))},searchZtree:Object(o["debounce"])((function(e,t){if(0==t.length)e.treeData=Object(l["h"])(e.treeNodes),e.$refs.xTable.setTreeExpand(e.treeNodes[0],!0);else{e.expandIds={};var a=e.variableDeepSearch(e.treeNodes,t.trim());e.treeData=Object(l["h"])(a);var s=e.treeData.filter((function(t){return e.expandIds[t.id]}));setTimeout((function(){e.$refs.xTable.setTreeExpand(s,!0)}),100)}}),300),onDeleteUser:function(){var e=this;if(null!=this.treeId){var t=[this.username];Object(m["K"])(t).then((function(a){var s=a.status,r=a.cause,n=a.count,i=a.bonuspoints,o=a.addvaluepoints,l=a.commission;if(0==s)c["a"].removeUser(t[0]),e.treeNodes=e.castUsersTreeToDevicesTree(c["a"].rootuser),e.treeId=null,e.deleteTreeNode(t[0]),e.$XModal.message({message:e.$t("tips.deleteSucc"),status:"success",zIndex:9999}),e.setReportTagList([]),e.setIsReloadRootuser(!0);else if(1==s)e.$XModal.message({message:e.$t("tips.accountAndDevice",{count:n}),status:"error",zIndex:9999});else if(2==s){var d="";i>0&&(d+=e.$t("bgManage.bonuspoints")+" "+i.toFixed(0)),o>0&&(d.length>0&&(d+=","),d+=e.$t("bgManage.addvaluepoints")+" "+Number(o.toFixed(2))),l>0&&(d.length>0&&(d+=","),d+=e.$t("bgManage.commission")+" "+Number(l.toFixed(2))),e.$XModal.message({message:e.$t("tips.accountAndGoldenBean",{str:d}),status:"error",zIndex:9999})}else e.$XModal.message({message:e.$t("tips.deleteFail")+r,status:"error",zIndex:9999})}))}},onRsetPassword:function(){var e=this;if(null!=this.treeId){var t=this.username;Object(m["gc"])(t).then((function(t){var a=t.status,s=t.newpass,r=t.cause;0==a?e.$XModal.message({message:e.$t("tips.resetPassSucc")+s,status:"success",zIndex:9999}):e.$XModal.message({message:e.$t("tips.resetPassFail")+r,status:"error",zIndex:9999})}))}},deleteTreeNode:function(e){var t=[];this.treeData.forEach((function(a){a.id!=e&&t.push(a)})),this.treeData=t},selectAndScrollToRow:function(e){var t=this.getNodeById(e);if(t){var a=this.$refs.xTable;setTimeout((function(){a.setCurrentRow(t),a.scrollToRow(t)}),100)}},handleClickSave:function(){var e=this;if(null!=this.oldCreater){var t={creater:this.creater,username:this.username,showname:this.showname,companyaddr:this.address,multilogin:this.multilogin,email:this.email,wechat:this.wechat,phone:this.phone,usertype:this.userLevel,companyname:this.companyname,cardname:this.cardname,qq:this.qq};this.loading=!0,Object(m["X"])(t).then((function(a){var s=a.status,r=a.cause;if(e.loading=!1,0==s){if(e.oldCreater==t.creater){var n=e.selectNode;n.name=t.showname?t.showname:t.username,c["a"].editUser(e.oldCreater,t),e.treeNodes=e.castUsersTreeToDevicesTree(c["a"].rootuser)}else e.oldCreater=null,Object(h["S"])().then((function(a){var s=a.status,r=a.rootuser;0==s&&(c["a"].rootuser=r,c["a"].setDeviceInfos(r),e.initZtree(),e.$refs.ztreeUser.selectedUser(t.creater),e.selectAndScrollToRow(t.username),e.treeNodes=e.castUsersTreeToDevicesTree(c["a"].rootuser))}));c["a"].pinyinMap[t.showname]=__pinyin.get(t.showname),e.$refs.ztreeUser.initZtree(),e.setReportTagList([]),e.setIsReloadRootuser(!0),e.$XModal.message({message:e.$t("tips.saveSucc"),status:"success",zIndex:9999})}else 1==s?e.$XModal.message({message:e.$t("tips.noPermissionToCreater"),status:"error",zIndex:9999}):e.$XModal.message({message:e.$t("tips.saveFail")+r,status:"error",zIndex:9999})}))}},handleEditGroup:function(){var e=this,t=this.groupCreater,a=this.groupid,s=this.groupname,r=this.selectNode;if(t&&a&&s){this.editGroupLoading=!0;var n={creater:t,groupid:a,groupname:s};Object(m["T"])(n).then((function(i){var o=i.status,l=i.cause;if(e.editGroupLoading=!1,0==o){var d=r.username;if(t==d)c["a"].editGroup(d,n),e.treeNodes=e.castUsersTreeToDevicesTree(c["a"].rootuser),r.name=s;else{c["a"].removeGroupAndAdd(d,t,a),e.initZtree();var u=n.creater+"-"+n.groupid;setTimeout((function(){var t=e.getNodeById(u);t&&(e.$refs.xTable.scrollToRow(t),e.$refs.xTable.setCurrentRow(t))}),100)}c["a"].pinyinMap[s]=__pinyin.get(s),e.setReportTagList([]),e.setIsReloadRootuser(!0),e.$XModal.message({message:e.$t("tips.saveSucc"),status:"success",zIndex:9999})}else 2==o?e.$XModal.message({message:e.$t("tips.editDeviceFailTip3"),status:"error",zIndex:9999}):e.$XModal.message({message:e.$t("tips.saveFail")+l,status:"error",zIndex:9999})}))}},handleDeleteGroup:function(){var e=this,t=this.groupid,a=this.groupname;if(t&&a){var s=this.selectNode;if(s){var r={groupid:t,username:s.username};this.deleteLoading=!0,Object(m["F"])(r).then((function(a){var n=a.status,i=a.cause,o=a.count;e.deleteLoading=!1,0==n?(e.username="",e.deleteTreeNode(s.id),c["a"].removeGroup(r.username,t),e.setReportTagList([]),e.setIsReloadRootuser(!0),e.$XModal.message({message:e.$t("tips.deleteSucc"),status:"success",zIndex:9999})):1==n?e.$XModal.message({message:e.$t("tips.deleteGroupFail",{count:o}),status:"error",zIndex:9999}):e.$XModal.message({message:e.$t("tips.deleteFail")+i,status:"error",zIndex:9999})})).catch((function(t){e.deleteLoading=!1}))}}},addShareGroup:function(){var e=this,t=this.groupid,a=this.groupname,s=this.tocreaters;if(0!=s.length){var r=this.selectNode,n={groupid:t,groupname:a,fromcreater:r.username,tocreaters:s};this.saveLoading=!0,Object(m["k"])(n).then((function(t){var a=t.status,s=t.cause;e.saveLoading=!1,0==a?(e.modal=!1,e.$XModal.message({message:e.$t("tips.shareSucc"),status:"success",zIndex:9999})):e.$XModal.message({message:e.$t("tips.shareFail")+s,status:"error",zIndex:9999})}))}else this.$XModal.message({message:this.$t("tips.selectUser"),status:"success",zIndex:9999})},refreshZtree:function(){this.$refs.xTable.reloadData(this.treeData),this.initZtree()},getNodeById:function(e){for(var t=null,a=this.treeData,s=0;s<a.length;s++){var r=a[s];if(r.id==e){t=r;break}}return t},initZtree:function(){var e=this;this.treeLoading=!0,setTimeout((function(){var t=e.castUsersTreeToDevicesTree(c["a"].rootuser);e.treeData=Object(l["h"])(t),e.$refs.xTable.setTreeExpand(t[0],!0),e.treeNodes=t,e.treeLoading=!1}),100)},variableDeepSearch:function(e,t){t=t.toLowerCase();for(var a=[],s=this,r=0;r<e.length;r++){var n=null,i=e[r];if(null!=i){var l=!1;if(-1==i.name.toLowerCase().indexOf(t)&&-1==(i.username&&i.username.toLowerCase().indexOf(t))||(n=Object(o["cloneDeep"])(i),l=!0),0==l){var d=c["a"].pinyinMap[i.name];(d&&-1!=d.l.toLowerCase().indexOf(t)||d&&-1!=d.p.toLowerCase().indexOf(t))&&(n=Object(o["cloneDeep"])(i),l=!0)}if(0==l&&i.children&&i.children.length>0){var u=s.variableDeepSearch(i.children,t);u&&u.length>0&&(n=Object(o["cloneDeep"])(i),n.children=u,l=!0)}1==l&&(s.expandIds[n.parentId]=!0,a.push(n))}}return a},selectedRoot:function(){},castUsersTreeToDevicesTree:function(e){var t={name:"",icon:g,open:!0,nodeType:c["a"].NodeType_User,level:0,checked:!1,allCount:0};if(null!=e){var a=e.username,s=e.subusers,r=e.showname;t.name=a,t.username=a,t.showname=r,t.id=a,t.parentId=null;var n=this.getDeviceListGroups(t,e.groups,a,t.level+1);if(null!=a&&null!=s&&s.length>0){var i=this.doCastUsersTreeToDevicesTree(s,a,t.level+1);i.length>0&&(t.children=i)}if(n.length){var o=n.concat(t.children?t.children:[]);t.children=o}t.children&&t.children.forEach((function(e){t.allCount+=e.allCount}))}return[t]},doCastUsersTreeToDevicesTree:function(e,t,a){var s=[];if(null!=e&&e.length>0)for(var r=0;r<e.length;++r){var n=e[r],o=n.username,l=n.subusers,d=n.showname,u={name:d||o,icon:g,nodeType:c["a"].NodeType_User,username:o,showname:d,id:o,parentId:t,level:a,checked:!1,allCount:0},p=this.getDeviceListGroups(u,n.groups,o,a+1);if(null!=o&&null!=l&&l.length>0){var h=this.doCastUsersTreeToDevicesTree(l,o,a+1);h.length>0&&(u.children=h)}var m=p.concat(u.children?u.children:[]);m.length>0&&(u.children=m),u.children&&u.children.forEach((function(e){u.allCount+=e.allCount})),s.push(u)}return Object(i["Kb"])(s),s},getDeviceListGroups:function(e,t,a,s){var r=[];if(t)for(var n=0;n<t.length;++n){var o=t[n],l=o.groupid>0;if(l){var d=void 0===o.shared?0:o.shared,u=o.groupname,p={groupid:o.groupid,name:u,groupname:u,icon:f,username:a,id:a+"-"+o.groupid,parentId:a,nodeType:c["a"].NodeType_Group,shared:d,level:s,checked:!1,allCount:0};if(p.allCount=o.devices.length,this.disableShare&&1==o.shared)continue;r.push(p)}else e.allCount+=o.devices.length}return Object(i["Kb"])(r),r},getUserOptions:function(e,t){var a=[],s=!1;return this.userLevelList.forEach((function(r){var n=r.name,i=r.type;0==s&&t&&e==i&&(a.push({label:n,value:Number(i)}),s=!0),i>e&&i<=11&&a.push({label:n,value:Number(i)})})),a},init:function(){var e=this;this.$nextTick((function(){Object(m["Tb"])(e.userName,0).then((function(t){var a=t.userlists,s=[];a&&a.forEach((function(e){e.usertype<20&&s.push(e)})),e.cacheList=s})),Object(m["Sb"])(e.userName).then((function(t){e.username=t.username,e.showname=t.showname,e.cardname=t.cardname,e.companyname=t.companyname,e.address=t.companyaddr,e.multilogin=t.multilogin,e.email=t.email,e.wechat=t.wechat,e.phone=t.phone,e.qq=t.qq,e.userLevel=Number(t.usertype),e.oldCreater=t.creater,e.creater=t.creater,e.$refs.ztreeUser&&e.$refs.ztreeUser.selectedUser(t.creater);var a=c["a"].getUserByUserName(e.userName);a&&(e.userLevel=a.usertype,e.userOptions=e.getUserOptions(a.usertype,!0),e.userOptions.length&&(e.userLevel=e.userOptions[0].value))})),e.radio=c["a"].rootuser.username,e.initZtree()}))},onTreeCheck:function(e){var t=this;this.selectNode=e,this.treeId=e.id;var a=e.nodeType;if(this.activeTab=a,a==c["a"].NodeType_User){this.isUser=!0,this.groupname="",this.groupid="";var s=e.username;this.isTreeCheck=!0,Object(m["Sb"])(s).then((function(e){t.username=e.username,t.showname=e.showname,t.cardname=e.cardname,t.companyname=e.companyname,t.address=e.companyaddr,t.multilogin=e.multilogin,t.email=e.email,t.wechat=e.wechat,t.phone=e.phone,t.qq=e.qq,t.userLevel=Number(e.usertype),t.oldCreater=e.creater,t.creater=e.creater,t.$refs.ztreeUser&&t.$refs.ztreeUser.selectedUser(e.creater);var a=c["a"].getUserByUserName(e.creater);t.userOptions=a?t.getUserOptions(a.usertype,!1):t.getUserOptions(t.userType,!0)}))}else this.isUser=!1,this.groupname=e.groupname,this.groupid=e.groupid,this.groupCreater=e.username,0!=e.groupid?setTimeout((function(){t.$refs.ztreeGourpUser&&t.$refs.ztreeGourpUser.selectedUser(t.groupCreater)}),30):this.tocreaters=[],this.oldCreater=null,this.isDisabled=0==e.groupid}}),created:function(){this.isTreeCheck=!1,this.treeId=null,this.oldCreater=null,this.groupname="",this.groupid=""},mounted:function(){var e=this;this.isQueryInitData&&this.init(),this.$nextTick((function(){e.loginOptions=[{label:e.$t("bgManage.singleLongin"),value:0},{label:e.$t("bgManage.multipleLogin"),value:1}]}))}},w=x,y=(a("8cc7"),a("2877")),C=Object(y["a"])(w,s,r,!1,null,null,null),$=C.exports;t["default"]=$},"8cc7":function(e,t,a){"use strict";a("c6b9")},c6b9:function(e,t,a){}}]);