(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-24907b1a"],{"0595":function(t,e,a){"use strict";var i=function(){var t=this,e=t._self._c;return e("div",{staticClass:"quick-time-range"},[e("div",{staticClass:"quick-time-range-wrapper"},t._l(t.list,(function(a){return e("div",{key:a.type,style:{color:a.type==t.type?"#409EFF":""},on:{click:function(e){return t.selectDate(a.type)}}},[t._v(t._s(a.label))])})),0),e("div",{staticClass:"quick-time-range-space"}),e("div",{staticClass:"quick-time-range-btn",on:{click:function(e){t.isCollapse=!t.isCollapse}}},[t.isCollapse?e("i",{staticClass:"el-icon-arrow-right"}):e("i",{staticClass:"el-icon-arrow-left"})])])},s=[],o=a("5101"),n={name:"QuickTimeRange",props:{value:{type:Array,default:function(){return[]}},dateType:{type:String,default:"date"}},watch:{isCollapse:function(){this.setList()}},data:function(){return{isCollapse:!0,type:0,list:[]}},methods:{setList:function(){this.isCollapse?this.list=[{label:this.$t("reportForm.toDay"),type:0},{label:this.$t("reportForm.yesterDay"),type:1},{label:this.$t("reportForm.recent3Days"),type:3}]:this.list=[{label:this.$t("reportForm.recent7Days"),type:7},{label:this.$t("reportForm.recent10Days"),type:10},{label:this.$t("reportForm.recent30Days"),type:30}]},selectDate:function(t){var e="datetimerange"==this.dateType,a=[],i=new Date,s=new Date;switch(e&&(i=new Date(o["a"].format(new Date,"yyyy-MM-dd")+" 00:00:00"),s=new Date(o["a"].format(new Date,"yyyy-MM-dd")+" 23:59:59")),t){case 0:a=[new Date(o["a"].format(i,"yyyy-MM-dd")+" 00:00:00"),new Date(o["a"].format(s,"yyyy-MM-dd")+" 23:59:59")];break;case 1:i.setTime(i.getTime()-864e5),s.setTime(s.getTime()-864e5),a=[i,s];break;case 3:i.setTime(i.getTime()-2592e5),a=[i,s];break;case 7:i.setTime(i.getTime()-6048e5),a=[i,s];break;case 10:i.setTime(i.getTime()-864e6),a=[i,s];break;case 30:i.setTime(i.getTime()-2592e6),a=[i,s];break}this.type=t,this.$emit("input",a)}},mounted:function(){var t=this;this.$nextTick((function(){t.setList()}))}},r=n,l=(a("8d09"),a("2877")),c=Object(l["a"])(r,i,s,!1,null,null,null);e["a"]=c.exports},2455:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t._self._c;return e("div",{staticClass:"commission-records"},[e("div",{staticClass:"commission-records-header"},[e("div",{staticClass:"f_left"},[e("SelectDate",{model:{value:t.dateRange,callback:function(e){t.dateRange=e},expression:"dateRange"}})],1),e("div",{staticClass:"f_left"},[e("QuickTimeRange",{model:{value:t.dateRange,callback:function(e){t.dateRange=e},expression:"dateRange"}})],1),e("div",{staticClass:"f_left"},[e("el-button",{attrs:{loading:t.loading,type:"primary"},on:{click:t.handleQuery}},[t._v(t._s(t.$t("common.query")))])],1),e("div",{staticClass:"f_right"},[e("el-button",{attrs:{type:"primary",loading:t.exportLoading1},on:{click:t.exportData}},[t._v(t._s(t.$t("common.exportData")))])],1),e("div",{staticClass:"f_right"},[e("el-button",{attrs:{type:"primary"},on:{click:function(e){t.transferPointDialog=!0}}},[t._v(t._s(t.$t("bgManage.withdraw")))])],1),e("div",{staticClass:"f_right"},[e("span",[t._v(t._s(t.$t("bgManage.totalCommission")))]),t._v(" : "),e("span",{domProps:{textContent:t._s(t.commission)}})])]),e("div",{staticClass:"commission-records-table"},[e("vxe-table",{ref:"xTable",attrs:{border:"",resizable:"","auto-resize":"","show-overflow":"","highlight-hover-row":"",size:"mini",height:"auto",data:t.tableList},on:{"cell-dblclick":t.cellDblclick}},[e("vxe-table-column",{attrs:{field:"index",width:"60",title:t.$t("reportForm.index")}}),e("vxe-table-column",{attrs:{field:"createtimeStr",title:t.$t("bgManage.chargeTime"),width:"156",sortable:""}}),e("vxe-table-column",{attrs:{field:"otherusername",title:t.$t("bgManage.chargeUser"),sortable:""}}),e("vxe-table-column",{attrs:{field:"points",title:t.$t("bgManage.commission"),sortable:""}}),e("vxe-table-column",{attrs:{field:"remark",title:t.$t("reportForm.remarks"),sortable:""}}),e("vxe-table-column",{attrs:{title:t.$t("bgManage.deviceList"),width:"100"},scopedSlots:t._u([{key:"default",fn:function(a){return[a.row.createtimeStr?e("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(e){return t.handleClickRow(a.row)}}},[t._v(t._s(t.$t("common.see")))]):t._e()]}}])})],1)],1),e("div",{staticClass:"commission-records-footer"},[t._v(" "+t._s(t.$t("reportForm.total"))+" "),e("span",{domProps:{textContent:t._s(t.total)}})]),e("RenewDeviceList",{ref:"renewDevicedialog",model:{value:t.renewDevicedialog,callback:function(e){t.renewDevicedialog=e},expression:"renewDevicedialog"}}),e("TransferCommissionDialog",{ref:"transferPointDialog",model:{value:t.transferPointDialog,callback:function(e){t.transferPointDialog=e},expression:"transferPointDialog"}})],1)},s=[],o=a("5530"),n=(a("99af"),a("14d9"),a("4e82"),a("a9e3"),a("b680"),a("d3b7"),a("159b"),a("e285")),r=a("2ddc"),l=a("0595"),c=a("5101"),m=function(){var t=this,e=t._self._c;return e("vxe-modal",{attrs:{title:t.title,className:"modal-padding0",value:t.value,width:"980px"},on:{hide:t.handleClose,close:t.handleClose}},[e("vxe-table",{ref:"xTable",staticClass:"mytable-scrollbar",attrs:{border:"",resizable:"","show-overflow":"","highlight-hover-row":"",size:"mini",height:"460",data:t.tableList}},[e("vxe-table-column",{attrs:{type:"seq",width:"60",title:t.$t("reportForm.index")}}),e("vxe-table-column",{attrs:{field:"creater",title:t.$t("reportForm.creater"),width:"100"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-popover",{attrs:{placement:"bottom",trigger:"click"}},[e("div",{staticClass:"parents-wrapper"},t._l(t.parentsList,(function(a){return e("div",{key:a.username},[t._v(t._s(a.username)+"("+t._s(a.usertypeStr)+")")])})),0),e("el-button",{staticStyle:{color:"#000000"},attrs:{slot:"reference",type:"text"},on:{click:function(e){return t.queryParents(a.row.creater)}},slot:"reference"},[t._v(t._s(a.row.creater))])],1)]}}])}),e("vxe-table-column",{attrs:{field:"groupname",title:t.$t("reportForm.groupName"),width:"100"}}),e("vxe-table-column",{attrs:{field:"devicename",title:t.$t("alarm.devName"),width:"100"}}),e("vxe-table-column",{attrs:{field:"deviceid",title:t.$t("alarm.devNum"),width:"80"}}),e("vxe-table-column",{attrs:{field:"simnum",title:t.$t("reportForm.sim"),width:"80"}}),e("vxe-table-column",{attrs:{field:"simiccid",title:"ICCID",width:"80"}}),e("vxe-table-column",{attrs:{field:"devicetypename",title:t.$t("reportForm.deviceType"),width:"100",sortable:""}}),e("vxe-table-column",{attrs:{field:"commission",title:t.$t("bgManage.commission"),width:"100",sortable:""}}),e("vxe-table-column",{attrs:{field:"costprice",title:t.$t("common.cost"),width:"100",sortable:""}}),e("vxe-table-column",{attrs:{field:"saleprice",title:t.$t("common.price"),width:"100",sortable:""}}),e("vxe-table-column",{attrs:{field:"chargeyears",title:t.$t("bgManage.renewYears"),width:"100",sortable:""}}),e("vxe-table-column",{attrs:{field:"preoverduetimeStr",title:t.$t("bgManage.renewBefore"),width:"100"}}),e("vxe-table-column",{attrs:{field:"postoverduetimeStr",title:t.$t("bgManage.renewAfter"),width:"100"}})],1),e("el-row",{staticStyle:{"margin-top":"10px"}},[e("el-col",{attrs:{span:8,offset:3}},[e("el-button",{staticStyle:{width:"100%"},attrs:{type:"primary"},on:{click:t.handleClose}},[t._v(" "+t._s(t.$t("common.determine")))])],1),e("el-col",{attrs:{span:8,offset:2}},[e("el-button",{staticStyle:{width:"100%"},attrs:{type:"primary",loading:t.exportLoading1},on:{click:t.exportData}},[t._v(" "+t._s(t.$t("common.exportData")))])],1)],1)],1)},u=[],d=a("6e52"),p=a("0c87"),h={name:"RenewDeviceList",props:{value:{type:Boolean,default:!1}},data:function(){return{exportLoading1:!1,tableList:[]}},mixins:[p["a"]],watch:{value:function(t){t||(this.tableList=[])}},computed:{title:function(){var t=this.tableList[0];return t?this.$t("bgManage.renewList")+(t?"  "+t.chargetimeStr:""):this.$t("bgManage.renewList")}},methods:{handleClose:function(){this.$emit("input",!1)},exportData:function(){var t=[[this.$t("reportForm.index"),this.$t("reportForm.creater"),this.$t("reportForm.groupName"),this.$t("alarm.devName"),this.$t("alarm.devNum"),this.$t("reportForm.sim"),"ICCID",this.$t("reportForm.deviceType"),this.$t("bgManage.commission"),this.$t("common.cost"),this.$t("common.price"),this.$t("bgManage.renewYears"),this.$t("bgManage.renewBefore"),this.$t("bgManage.renewAfter")]],e=this.$refs.xTable.getTableData().visibleData;if(0!=e.length){e.forEach((function(e,a){var i=[];i.push(a+1),i.push(e.creater),i.push(e.groupname),i.push(e.devicename),i.push(e.deviceid),i.push(e.simnum?e.simnum:""),i.push(e.simiccid?e.simiccid:""),i.push(e.devicetypename),i.push(e.commission),i.push(e.costprice),i.push(e.saleprice),i.push(e.chargeyears),i.push(e.preoverduetimeStr),i.push(e.postoverduetimeStr),t.push(i)}));var a={title:this.title,data:t,dateRange:null};this.exportLoading1=!0,new ExcelCls(a).exportExcel(this)}},queryCommissionDevices:function(t){var e=this;Object(n["kb"])(t).then((function(t){var a=t.records;a&&a.length?(a.forEach((function(t){var e=t.deviceid,a=d["a"].deviceInfos[e];t.creater=a.creater,t.groupname=a.groupname,t.chargetimeStr=c["a"].longToLocalDateTimeStr(t.chargetime),t.postoverduetimeStr=c["a"].format(new Date(t.postoverduetime),"yyyy-MM-dd"),t.preoverduetimeStr=c["a"].format(new Date(t.preoverduetime),"yyyy-MM-dd")})),e.tableList=a):e.tableList=[]}))}}},b=h,f=a("2877"),v=Object(f["a"])(b,m,u,!1,null,null,null),g=v.exports,y=(a("498a"),function(){var t=this,e=t._self._c;return e("vxe-modal",{attrs:{title:t.$t("bgManage.withdrawalCommission"),className:"modal-padding0",value:t.value,width:"360px"},on:{hide:t.handleClose,close:t.handleClose}},[e("div",{staticStyle:{padding:"0px 10px"}},[e("el-row",[e("el-col",{attrs:{span:14}},[e("LabelWrap",{attrs:{label:t.$t("bgManage.withdrawalAmount")}},[e("el-input",{attrs:{clearable:""},on:{input:t.onInput},model:{value:t.inputAmount,callback:function(e){t.inputAmount="string"===typeof e?e.trim():e},expression:"inputAmount"}})],1)],1),e("el-col",{attrs:{span:10}},[e("div",{staticClass:"commission-number"},[t._v(t._s(t.$t("bgManage.commission"))+": "+t._s(t.commission))])])],1)],1),e("el-row",{staticClass:"transfer-commission",attrs:{gutter:10}},[e("el-col",{staticClass:"transfer-commission-item",attrs:{span:12},nativeOn:{click:function(e){t.type="bonuspoints"}}},[e("el-card",{attrs:{shadow:"bonuspoints"==t.type?"always":"never"}},[e("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[e("span",[t._v(t._s(t.$t("bgManage.basicAccount")))]),e("div",{staticClass:"transfer-commission-item-icon"},[e("i",{staticClass:"el-icon-success",style:{opacity:"bonuspoints"==t.type?1:0}})])]),e("el-row",{attrs:{gutter:10}},[e("el-col",{attrs:{span:4}},[e("img",{staticStyle:{width:"24px"},attrs:{src:t.douzi}})]),e("el-col",{staticClass:"transfer-commission-item-balance",attrs:{span:16}},[e("span",{domProps:{textContent:t._s(t.bonuspoints)}})])],1),e("div",{staticClass:"transfer-commission-item-commission"},["bonuspoints"==t.type?e("b",{staticStyle:{color:"#f8c50a"}},[t._v(" + "+t._s(t.inputAmount))]):e("b",[t._v(" + 0 ")])])],1)],1),e("el-col",{staticClass:"transfer-commission-item",attrs:{span:12},nativeOn:{click:function(e){t.type="addvaluepoints"}}},[e("el-card",{attrs:{shadow:"addvaluepoints"==t.type?"always":"never"}},[e("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[e("span",[t._v(" "+t._s(t.$t("reportForm.package")))]),e("div",{staticClass:"transfer-commission-item-icon"},[e("i",{staticClass:"el-icon-success",style:{opacity:"addvaluepoints"==t.type?1:0}})])]),e("el-row",{attrs:{gutter:10}},[e("el-col",{attrs:{span:4}},[e("img",{staticStyle:{width:"24px"},attrs:{src:t.douzi}})]),e("el-col",{staticClass:"transfer-commission-item-balance",attrs:{span:16}},[e("span",{domProps:{textContent:t._s(t.addvaluepoints)}})])],1),e("div",{staticClass:"transfer-commission-item-commission"},["addvaluepoints"==t.type?e("b",{staticStyle:{color:"#f8c50a"}},[t._v(" + "+t._s(t.inputAmount))]):e("b",[t._v(" + 0 ")])])],1)],1)],1),e("el-row",[e("el-col",{attrs:{span:12,offset:6}},[e("el-button",{staticStyle:{width:"100%"},attrs:{type:"primary",loading:t.loading},on:{click:t.handleSubmit}},[t._v(t._s(t.$t("bgManage.withdraw")))])],1)],1)],1)}),w=[],x=a("201d"),$=a("2f62"),C=a("a1db"),_={name:"TransferCommissionDialog",props:{value:{type:Boolean,default:!1}},data:function(){return{douzi:C,loading:!1,inputAmount:"",commission:0,type:"bonuspoints",addvaluepoints:0,bonuspoints:0}},components:{LabelWrap:x["a"]},watch:{value:function(t){var e=this;t&&(this.commission=this.$parent.commission,this.inputAmount=this.commission,Object(n["hb"])({}).then((function(t){var a=t.status,i=t.addvaluepoints,s=t.bonuspoints;0==a&&(e.addvaluepoints=Number(i.toFixed(2)),e.bonuspoints=Number(s.toFixed(2)))})))}},computed:Object(o["a"])({},Object($["b"])(["userName"])),methods:{handleClose:function(){this.$emit("input",!1)},onInput:function(t){if(!isNaN(t)){var e=Number(this.commission);t=Number(t),t>e&&(this.inputAmount=e)}},handleSubmit:function(){var t=this;if(0==isNaN(this.inputAmount)){var e={type:"bonuspoints"==this.type?"commissiontobaseaccount":"commissiontoaddvalueaccount",points:this.inputAmount,fromusername:this.userName,tousername:this.userName};this.loading=!0,Object(n["uc"])(e).then((function(a){var i=a.status,s=a.tobonuspoints,o=a.toaddvaluepoints,n=a.fromcommission;t.loading=!1,0==i?(t.addvaluepoints=Number(o.toFixed(2)),t.bonuspoints=Number(s.toFixed(2)),t.commission=Number(n.toFixed(2)),t.$parent.commission=t.commission,t.$XModal.message({message:t.$t("tips.withdrawalSuccessful")+" "+e.points,status:"success",zIndex:9999})):1==i?t.$XModal.message({message:t.$t("tips.noPermission"),status:"error",zIndex:9999}):2==i&&t.$XModal.message({message:t.$t("tips.balance"),status:"error",zIndex:9999})})).catch((function(e){t.loading=!1}))}}}},D=_,k=(a("62a3"),Object(f["a"])(D,y,w,!1,null,null,null)),M=k.exports,S={name:"Commission",data:function(){return{loading:!1,exportLoading1:!1,renewDevicedialog:!1,transferPointDialog:!1,dateRange:[new Date,new Date],tableList:[],total:0,commission:0}},components:{SelectDate:r["a"],QuickTimeRange:l["a"],RenewDeviceList:g,TransferCommissionDialog:M},computed:Object(o["a"])({},Object($["b"])(["isZh","userName"])),methods:{exportData:function(){var t=[[this.$t("reportForm.index"),this.$t("bgManage.chargeTime"),this.$t("bgManage.chargeUser"),this.$t("bgManage.commission")]],e=this.$refs.xTable.getTableData().visibleData;if(0!=e.length){e.forEach((function(e,a){var i=[];i.push(e.index),i.push(e.createtimeStr?e.createtimeStr:""),i.push(e.otherusername?e.otherusername:""),i.push(e.points?Number(e.points.toFixed(3)):""),t.push(i)}));var a={title:this.$t("bgManage.commission"),data:t,dateRange:this.dateRangeRecords};this.exportLoading1=!0,new ExcelCls(a).exportExcel(this)}},handleQuery:function(){var t=this,e=(this.isZh,this.dateRange),a=c["a"].format(e[0],"yyyy-MM-dd"),i=c["a"].format(e[1],"yyyy-MM-dd"),s={startday:a,endday:i,offset:c["a"].getOffset()};this.loading=!0,this.dateRangeRecords="".concat(a," - ").concat(i),Object(n["Sb"])(this.userName).then((function(e){var a=e.commission;t.commission=Number(a.toFixed(3))})),Object(n["lb"])(s).then((function(e){var a=e.records;t.loading=!1;var i=[],s=0;a&&a.length>0&&(a.sort((function(t,e){return e.createtime-t.createtime})),a.forEach((function(t,e){s+=t.points,t.index=e+1,t.createtimeStr=c["a"].longToLocalDateTimeStr(t.createtime),t.points=Number(t.points.toFixed(3))})),s=Number(s.toFixed(3)),a.push({index:t.$t("monitor.total"),points:s}),i=a),t.tableList=i,t.total=s})).catch((function(e){t.loading=!1}))},handleClickRow:function(t){this.renewDevicedialog=!0,this.$refs.renewDevicedialog.queryCommissionDevices(t.commissionuuid)},cellDblclick:function(t){var e=t.row;this.handleClickRow(e)}},mounted:function(){var t=this;this.dateRangeRecords=null,Object(n["Sb"])(this.userName).then((function(e){var a=e.commission;t.commission=Number(a.toFixed(3))}))}},T=S,F=(a("470b"),Object(f["a"])(T,i,s,!1,null,null,null)),N=F.exports;e["default"]=N},"470b":function(t,e,a){"use strict";a("63d8")},"62a3":function(t,e,a){"use strict";a("71d8")},"63d8":function(t,e,a){},"71d8":function(t,e,a){},"8d09":function(t,e,a){"use strict";a("a818")},a818:function(t,e,a){}}]);