(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-03db47a7"],{"3b13":function(t,e,i){},"5aff":function(t,e,i){"use strict";i.d(e,"b",(function(){return a})),i.d(e,"h",(function(){return o})),i.d(e,"l",(function(){return r})),i.d(e,"k",(function(){return s})),i.d(e,"c",(function(){return l})),i.d(e,"d",(function(){return n})),i.d(e,"e",(function(){return c})),i.d(e,"f",(function(){return d})),i.d(e,"g",(function(){return u})),i.d(e,"m",(function(){return h})),i.d(e,"i",(function(){return m})),i.d(e,"a",(function(){return p})),i.d(e,"j",(function(){return f}));var a="#2D9F28",o="#89C6F2",r="#FFC65E",s="red",l="#1EBEFF",n="#E505F7",c="#40A703",d="#F27908",u="#F180D1",h="#0F1F46",m="#000000",p={backgroundColor:"rgba(255,255,255,0.85)",borderColor:"transparent",textStyle:{fontSize:12,color:"#000"},padding:2},f=function(t,e,i,a,o){var r=t[0],s=o.contentSize,l=o.viewSize;return r+10>l[0]-s[0]?r=r-s[0]-10:r+=10,[r,"0%"]}},7031:function(t,e,i){"use strict";i("3b13")},"80f4":function(t,e,i){"use strict";var a=i("32eb");e["a"]=a["a"]},"813a":function(t,e,i){"use strict";i("cff1")},"945e":function(t,e,i){"use strict";var a=function(){var t=this,e=t._self._c;return e("div",{ref:"chartId",staticClass:"full"})},o=[],r=i("ade3"),s=i("5530"),l=(i("14d9"),i("b0c0"),i("e9c4"),i("a9e3"),i("b680"),i("b64b"),i("d3b7"),i("159b"),i("43c8")),n=i.n(l),c=i("2f62"),d=i("c276"),u=i("5101"),h=i("5aff"),m={name:"FuelLeakOilEcharts",computed:Object(s["a"])({},Object(c["b"])(["isZh","distanceUnit","speedUnit"])),methods:{initChart:function(){var t=this;this.distance=[],this.recvtime=[],this.veo=[],this.totalad=[],this.notRunOil=[],this.oil1=[],this.oil2=[],this.oil3=[],this.oil4=[],this.devStates=[],this.devReissue=[],this.markPointData=[],this.markPointDataOil1=[],this.markPointDataOil2=[],this.markPointDataOil3=[],this.markPointDataOil4=[],this.markPointDataOil99=[],this.disMin=0,this.totalDistanceMin=0;var e=this.$t("reportForm.oil2"),i=this.$t("reportForm.oil3"),a=this.$t("reportForm.oil4");this.selectedLegend=Object(r["a"])(Object(r["a"])(Object(r["a"])({},e,!1),i,!1),a,!1),this.chartsIns=n.a.init(this.$refs.chartId),this.chartsIns.setOption(this.getChartsOption(),!0),this.chartsIns.getZr().on("click",(function(e){var i=[e.offsetX,e.offsetY];if(t.chartsIns.containPixel("grid",i)&&t.recvtime.length){var a=t.chartsIns.convertFromPixel({seriesIndex:0},[e.offsetX,e.offsetY])[0];t.$emit("select-index",a)}}))},updateChartsOption:function(t,e){var i=this,a=[],o=[],r=[],s=[],l=[],n=[],c=[],h=[],m=[],p=[],f=[],b=0;t.forEach((function(t,e){t.totalad=t.totalad/100,t.ad0=t.ad0/100,t.ad1=t.ad1/100,t.ad2=t.ad2/100,t.ad3=t.ad3/100,0==e&&(b=t.totaldistance),n.push(t.ad0),c.push(t.ad1),h.push(t.ad2),m.push(t.ad3),p.push(t.strstatus),f.push(0==t.reissue?i.$t("header.no"):i.$t("header.yes")),s.push(t.totalad),l.push(t.totalnotrunningad),o.push(u["a"].longToLocalDateTimeStr(t.updatetime)),r.push(Number(Object(d["e"])(t.speed).toFixed(0))),a.push(Number(Object(d["d"])(t.totaldistance-b).toFixed(3)))})),this.distance=a,this.recvtime=o,this.veo=r,this.totalad=s,this.notRunOil=l,this.oil1=n,this.oil2=c,this.oil3=h,this.oil4=m,this.devStates=p,this.devReissue=f,e&&(e=JSON.parse(JSON.stringify(e)),e.forEach((function(t){t.eoil=100*t.eoil,t.soil=100*t.soil}))),this.markPointData=Object(d["a"])(t,e,0),this.totalDistanceMin=b,this.chartsIns.setOption(this.getChartsOption(),!0),this.chartsIns.resize()},resize:function(){this.chartsIns.resize()},getChartsOption:function(){var t=this.$t("reportForm.totalOil"),e=this.$t("reportForm.notRunTotalad"),i=this.$t("reportForm.speed"),a=this.$t("reportForm.mileage"),o=this.$t("reportForm.time"),r=this.$t("reportForm.oil1"),l=this.$t("reportForm.oil2"),n=this.$t("reportForm.oil3"),c=this.$t("reportForm.oil4"),u=this.$t("reportForm.status"),m=this.$t("reportForm.reissue"),p=this.distanceUnit,f=this.speedUnit;return{grid:{top:40,left:60,right:60,bottom:20},tooltip:Object(s["a"])(Object(s["a"])({trigger:"axis"},h["a"]),{},{formatter:function(s){var u="<div>".concat(s[0].name,"</div>");for(var m in s){var b=s[m].seriesName,v=s[m].value;b&&b!=o&&(u+=b==a?Object(d["k"])(h["b"],b,v,p):b==i?Object(d["k"])(h["h"],b,v,f):b==t?Object(d["k"])(h["k"],b,v,"L"):b==e?Object(d["k"])(h["c"],b,v,"L"):b==r?Object(d["k"])(h["d"],b,v,""):b==l?Object(d["k"])(h["e"],b,v,""):b==n?Object(d["k"])(h["f"],b,v,""):b==c?Object(d["k"])(h["g"],b,v,""):Object(d["k"])(h["m"],b,v,""))}return'<div style="width:230px">'.concat(u,"</div>")}}),legend:{data:[i,a,t,e,r,l,n,c],selected:this.selectedLegend,x:"left"},xAxis:[{type:"category",boundaryGap:!1,axisLine:{onZero:!1},data:this.recvtime}],yAxis:[{name:this.$t("reportForm.oil"),type:"value",nameTextStyle:10,padding:2,nameGap:5,axisLabel:{formatter:"{value} L"}},{name:a+p,type:"value",nameTextStyle:10,nameGap:2,padding:5,min:this.disMin,axisTick:{show:!1}}],series:[{name:o,type:"line",symbol:"none",yAxisIndex:1,color:"#F0805A",smooth:!0,data:this.recvtime},{name:i,type:"line",symbol:"none",yAxisIndex:1,smooth:!0,color:h["h"],data:this.veo},{name:a,type:"line",symbol:"none",yAxisIndex:1,color:h["b"],smooth:!0,data:this.distance},{smooth:!0,name:t,type:"line",symbol:"none",color:h["k"],data:this.totalad,markPoint:{data:this.markPointData,symbolSize:36,symbolKeepAspect:!0}},{smooth:!0,name:e,type:"line",symbol:"none",color:h["c"],data:this.notRunOil,markPoint:{data:this.markPointDataOil99,symbolSize:36,symbolKeepAspect:!0}},{smooth:!0,name:r,type:"line",symbol:"none",color:h["d"],data:this.oil1,markPoint:{data:this.markPointDataOil1,symbolSize:36,symbolKeepAspect:!0}},{smooth:!0,name:l,type:"line",symbol:"none",color:h["e"],data:this.oil2,markPoint:{data:this.markPointDataOil2,symbolSize:36,symbolKeepAspect:!0}},{smooth:!0,name:n,type:"line",symbol:"none",color:h["f"],data:this.oil3,markPoint:{data:this.markPointDataOil3,symbolSize:36,symbolKeepAspect:!0}},{smooth:!0,name:c,type:"line",symbol:"none",color:h["g"],data:this.oil4,markPoint:{data:this.markPointDataOil4,symbolSize:36,symbolKeepAspect:!0}},{smooth:!0,name:u,type:"line",symbol:"none",color:h["m"],data:this.devStates},{smooth:!0,name:m,type:"line",symbol:"none",color:h["m"],data:this.devReissue}]}}},mounted:function(){var t=this;this.$nextTick((function(){t.initChart()}))}},p=m,f=i("2877"),b=Object(f["a"])(p,a,o,!1,null,null,null);e["a"]=b.exports},"95f3":function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t._self._c;return e("div",{staticClass:"report-form full fuelLeakOil"},[e("div",{staticClass:"report-form-inner"},[e("div",{staticClass:"report-form-inner-header",staticStyle:{height:"35px"}},[e("div",{staticClass:"f_left"},[e("MultiChoiceVehicle",{on:{onSelectDevice:t.onSelectDevice}})],1),e("div",{staticClass:"f_left"},[e("SelectDate",{attrs:{dateType:"daterange"},model:{value:t.dateRange,callback:function(e){t.dateRange=e},expression:"dateRange"}})],1),e("div",{staticClass:"f_left",staticStyle:{width:"100px"}},[e("el-select",{model:{value:t.oilindex,callback:function(e){t.oilindex=e},expression:"oilindex"}},t._l(t.oilIndexList,(function(t){return e("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1),e("div",{staticClass:"f_left",staticStyle:{width:"100px"}},[e("el-select",{model:{value:t.oilstate,callback:function(e){t.oilstate=e},expression:"oilstate"}},[e("el-option",{attrs:{label:t.$t("reportForm.all"),value:99}}),e("el-option",{attrs:{label:t.$t("reportForm.refuel"),value:1}}),e("el-option",{attrs:{label:t.$t("reportForm.leak"),value:-1}})],1)],1),e("div",{staticClass:"f_left"},[e("el-button",{attrs:{loading:t.loading,type:"primary"},on:{click:t.handleQuery}},[t._v(t._s(t.$t("common.query"))+" ")])],1),e("div",{staticClass:"f_left"},[e("el-popover",{attrs:{placement:"bottom",width:"236",trigger:"click"}},[e("div",[e("el-button",{staticStyle:{width:"100px"},attrs:{slot:"reference",type:"primary",plain:"",loading:t.exportLoading1},on:{click:t.exportData},slot:"reference"},[t._v(t._s(t.$t("common.summary")))]),e("el-button",{staticStyle:{width:"100px"},attrs:{slot:"reference",type:"primary",loading:t.exportLoading2,plain:""},on:{click:t.exportDetailData},slot:"reference"},[t._v(t._s(t.$t("reportForm.detailed")))])],1),e("el-button",{attrs:{slot:"reference",type:"primary"},slot:"reference"},[t._v(t._s(t.$t("common.export")))])],1)],1)]),e("div",{staticClass:"report-form-inner-content",staticStyle:{top:"45px"}},[e("div",[e("div",[e("vxe-table",{ref:"xTable",attrs:{"sort-config":t.sortConfig,"menu-config":t.tableMenu,"auto-resize":"",border:"",resizable:"","show-overflow":"","highlight-hover-row":"",height:"auto",data:t.totalList,size:"mini"},on:{"menu-click":t.handleClickTableMenu}},[e("vxe-table-column",{attrs:{type:"seq",width:"55",title:t.$t("reportForm.index"),fixed:"left"}}),e("vxe-table-column",{attrs:{type:"expand",width:"36"},scopedSlots:t._u([{key:"content",fn:function(i){var a=i.row;return[[e("div",{staticStyle:{"padding-left":"60px"}},[e("vxe-table",{attrs:{"menu-config":t.tableMenu,"cell-class-name":t.getCellClassName,border:"",resizable:"","auto-resize":"",height:a.tableHeight,"show-overflow":"","highlight-current-row":"","highlight-hover-row":"",size:"mini",data:a.detaileList},on:{"menu-click":t.handleClickTableMenu,"cell-click":t.handleClickRow}},[e("vxe-table-column",{attrs:{field:"statisticsday",width:"300",title:t.$t("reportForm.time"),sortable:""}}),e("vxe-table-column",{attrs:{field:"oilIndexStr",width:"80",title:t.$t("reportForm.oilIndex"),sortable:""}}),e("vxe-table-column",{attrs:{field:"oilStatus",width:"70",title:t.$t("reportForm.status"),sortable:""}}),e("vxe-table-column",{attrs:{field:"oil",formatter:t.numberToFixed2,align:"right",width:"100",title:t.$t("reportForm.oil"),sortable:""}}),e("vxe-table-column",{attrs:{field:"soil",formatter:t.numberToFixed2,align:"right",width:"100",title:t.$t("reportForm.startOil"),sortable:""}}),e("vxe-table-column",{attrs:{field:"eoil",formatter:t.numberToFixed2,align:"right",width:"100",title:t.$t("reportForm.endOil"),sortable:""}}),e("vxe-table-column",{attrs:{field:"address",title:t.$t("reportForm.address")}})],1)],1)]]}}])}),e("vxe-table-column",{attrs:{field:"devicename",title:t.$t("alarm.devName"),sortable:""}}),e("vxe-table-column",{attrs:{field:"deviceid",title:t.$t("alarm.devNum"),sortable:""}}),e("vxe-table-column",{attrs:{field:"creater",title:t.$t("reportForm.creater"),sortable:""},scopedSlots:t._u([{key:"default",fn:function(i){return[e("el-popover",{attrs:{placement:"bottom",trigger:"click"}},[e("div",{staticClass:"parents-wrapper"},t._l(t.parentsList,(function(i){return e("div",{key:i.username},[t._v(t._s(i.username)+"("+t._s(i.usertypeStr)+")")])})),0),e("el-button",{staticStyle:{color:"#000000"},attrs:{slot:"reference",type:"text"},on:{click:function(e){return t.queryParents(i.row.creater)}},slot:"reference"},[t._v(t._s(i.row.creater))])],1)]}}])}),e("vxe-table-column",{attrs:{field:"groupname",title:t.$t("reportForm.groupName"),sortable:""}}),e("vxe-table-column",{attrs:{field:"begintimeStr",title:t.$t("videoback.startTime"),width:"155",sortable:""}}),e("vxe-table-column",{attrs:{field:"endtimeStr",title:t.$t("videoback.endTime"),width:"155",sortable:""}}),e("vxe-table-column",{attrs:{field:"refuelVolume",formatter:t.numberToFixed2,align:"right",title:t.$t("home.refuelVolume"),sortable:""}}),e("vxe-table-column",{attrs:{field:"leakageFuel",formatter:t.numberToFixed2,align:"right",title:t.$t("home.leakageFuel"),sortable:""}})],1)],1),e("div",[e("div",{staticClass:"fuel-leak-oil-month-map"},[e("ReportMap",{ref:"mapIns"})],1),e("div",{staticClass:"fuel-leak-oil-month-echarts"},[e("FuelLeakOilEcharts",{ref:"echartsIns",on:{"select-index":t.onSelectIndex}})],1)])])])])])},o=[],r=(i("14d9"),i("4e82"),i("a9e3"),i("d3b7"),i("159b"),i("4795"),i("d462")),s=i("e561"),l=i("80f4"),n=i("945e"),c=i("1c31"),d=i("7cf8"),u=i("5101"),h=i("c276"),m=i("6e52"),p=i("4c3c"),f=i("a05b"),b=i("0c87"),v={name:"fuelLeakOil",data:function(){return{deviceid:"",tableTitle:"",dateRange:[new Date,new Date],loading:!1,exportLoading1:!1,exportLoading2:!1,totalList:[],oilindex:"0",oilstate:99,oilIndexList:[{label:this.$t("reportForm.totalDriving"),value:"0"},{label:this.$t("reportForm.tank1"),value:"1"},{label:this.$t("reportForm.tank2"),value:"2"},{label:this.$t("reportForm.tank3"),value:"3"},{label:this.$t("reportForm.tank4"),value:"4"},{label:this.$t("reportForm.totalNotRun"),value:"99"}]}},mixins:[p["a"],f["a"],b["a"]],components:{MultiChoiceVehicle:s["a"],SelectDate:r["a"],ReportMap:l["a"],FuelLeakOilEcharts:n["a"]},watch:{month:function(){this.loading||this.handleQuery()}},methods:{numberToFixed2:h["qb"],onSelectDevice:function(t){this.deviceids=t},getCellClassName:function(t){var e=t.column,i=t.row;if("oilStatus"===e.field){var a=i.oilstate,o=null;switch(a){case-1:o="red-font";break}return o}return null},onSelectIndex:function(t){this.$refs.mapIns.moveingCarMarker(t)},handleClickRow:function(t){var e=this,i=t.row,a=u["a"].longToLocalDateTimeStr(i.begintime-6e5),o=u["a"].longToLocalDateTimeStr(i.endtime+6e5),r={deviceid:i.deviceid,begintime:a,endtime:o,timezone:u["a"].getOffset()};Object(d["Z"])(r).then((function(t){var a=t.records;if(a&&a.length){e.$refs.mapIns.carMarkersAndLineLayerToMap(a,i),e.$refs.echartsIns.updateChartsOption(a,[i]);var o=u["a"].longToLocalDateTimeStr(i.begintime),r=u["a"].longToLocalDateTimeStr(i.endtime),s={deviceid:i.deviceid,begintime:o,endtime:r,timezone:u["a"].getOffset()};Object(d["Z"])(s).then((function(t){var i=t.records;i&&e.$refs.mapIns.addFuleLine(i)}))}else e.$refs.mapIns.markersAndLineLayerToMap([]),e.$refs.echartsIns.updateChartsOption([])}))},handleQuery:function(){var t=this,e=this.deviceids,i=this.dateRange;if(e){var a=u["a"].format(i[0],"yyyy-MM-dd"),o=u["a"].format(i[1],"yyyy-MM-dd"),r={startday:a,endday:o,oilstate:this.oilstate,oilindex:Number(this.oilindex),deviceids:e,offset:u["a"].getOffset()};this.loading=!0,Object(c["eb"])(r).then((function(e){var i=e.records,r=e.addressmap;t.addressmap=r,t.loading=!1;var s=[];i&&i.length&&(i.forEach((function(e){var i=e.deviceid,s=m["a"].deviceInfos[i],l=s.devicename,n=m["a"].getShowName(s.creater),c=s.groupname,d=e.records,p=0,f=0;e.devicename=l,e.creater=n,e.groupname=c,e.detaileList=d,e.tableHeight=0==d.length?72:36*d.length+36,d.sort((function(t,e){return t.begintime-e.begintime})),d.forEach((function(e){e.soil=e.soil/100,e.eoil=e.eoil/100;var a=Number(Math.abs(e.eoil-e.soil)),o="";-1==e.oilstate?(o="".concat(t.$t("reportForm.leak")),f+=Number(a),e.oil=-a):1==e.oilstate&&(o=t.$t("reportForm.refuel"),p+=Number(a),e.oil=a),e.devicename=l,e.deviceid=i,e.oilIndexStr=Object(h["U"])(e.oilindex),e.oilStatus=o,e.statisticsday=u["a"].longToLocalDateTimeStr(e.begintime)+" - "+u["a"].longToLocalDateTimeStr(e.endtime);var s=Object(h["L"])(r,e.slat,e.slon);e.address=s||"-"})),d.length>0?(e.begintimeStr=u["a"].longToLocalDateTimeStr(d[0].begintime),e.endtimeStr=u["a"].longToLocalDateTimeStr(d[d.length-1].endtime)):(e.begintimeStr=a+" 00:00:00",e.endtimeStr=o+" 23:59:59"),e.refuelVolume=Number(p),e.leakageFuel=Number(f)})),i.sort((function(t,e){var i=0;return i=e.refuelVolume+Math.abs(e.leakageFuel)-(t.refuelVolume+Math.abs(t.leakageFuel)),0==i&&(i=e.devicename.localeCompare(t.devicename)),i})),s=i),t.totalList=s,1==s.length&&setTimeout((function(){t.$refs.xTable.setRowExpand(s[0],!0)}),500)})).catch((function(t){console.log(t)}))}else this.$XModal.message({message:this.$t("tips.selectDevice"),status:"error",zIndex:9999})},exportData:function(){if(this.totalList.length>0){var t=[[this.$t("reportForm.index"),this.$t("alarm.devName"),this.$t("alarm.devNum"),this.$t("reportForm.creater"),this.$t("reportForm.groupName"),this.$t("videoback.startTime"),this.$t("videoback.endTime"),this.$t("home.refuelVolume"),this.$t("home.leakageFuel")]];this.totalList.forEach((function(e,i){var a=[];a.push(i+1),a.push(e.devicename),a.push(e.deviceid),a.push(e.creater),a.push(e.groupname),a.push(e.begintimeStr),a.push(e.endtimeStr),a.push(Object(h["qb"])(e.refuelVolume)),a.push(Object(h["qb"])(e.leakageFuel)),t.push(a)}));var e={title:this.$t("reportForm.fuelLeakOil"),data:t};this.exportLoading1=!0,new ExcelCls(e).exportExcel(this)}},exportDetailData:function(){var t=this;if(this.totalList.length>0){var e=[[this.$t("reportForm.index"),this.$t("alarm.devName"),this.$t("alarm.devNum"),this.$t("reportForm.creater"),this.$t("reportForm.groupName"),this.$t("reportForm.time"),this.$t("reportForm.oilIndex"),this.$t("reportForm.status"),this.$t("reportForm.oil"),this.$t("reportForm.startOil"),this.$t("reportForm.endOil"),this.$t("reportForm.address")]],i="",a=this.totalList.length;this.totalList.forEach((function(o,r){var s=o.refuelVolume,l=o.leakageFuel;if(o.records.forEach((function(r,s){1==a&&(i=r.devicename);var l=[];l.push(s+1),l.push(o.devicename),l.push(o.deviceid),l.push(o.creater),l.push(o.groupname),l.push(r.statisticsday),l.push(r.oilIndexStr),-1==r.oilstate?l.push(t.$t("reportForm.leak")):1==r.oilstate&&l.push(t.$t("reportForm.refuel")),l.push(Object(h["qb"])(r.oil)),l.push(Object(h["qb"])(r.soil)),l.push(Object(h["qb"])(r.eoil)),l.push(r.address),e.push(l)})),o.records.length>0){var n=[];n.push(""),n.push(""),n.push(""),n.push(""),n.push(""),n.push(""),n.push(""),n.push(t.$t("reportForm.totalFuelVolume")+":"),n.push(Object(h["qb"])(s)+"L"),n.push(t.$t("reportForm.totalLeakVolume")+":"),n.push(Object(h["qb"])(l)+"L"),n.push(""),e.push(n)}}));var o={title:this.$t("reportForm.fuelLeakOil")+(i?" - "+i:""),data:e};this.exportLoading2=!0,new ExcelCls(o).exportExcel(this)}}},mounted:function(){this.deviceids=[]}},g=v,x=(i("813a"),i("2877")),y=Object(x["a"])(g,a,o,!1,null,null,null),k=y.exports;e["default"]=k},cff1:function(t,e,i){},e561:function(t,e,i){"use strict";var a=i("ea22");e["a"]=a["a"]},ea22:function(t,e,i){"use strict";var a=function(){var t=this,e=t._self._c;return e("div",{staticClass:"multi-choice multi-choice-vehicle"},[e("div",{staticClass:"multi-choice-input"},[e("ZtreeDeviceDropdown",{ref:"ztreeDevice",attrs:{disableShare:t.disableShare,isCheck:"",placeholder:this.$t("tips.selectDevice"),isQueryInitData:t.isQueryInitData,selectDeviceIds:t.multipleDeviceids},on:{onTreeCheck:t.onTreeCheck}})],1)])},o=[],r=i("5530"),s=(i("4795"),i("2f62")),l=i("2df7"),n={name:"MultiChoiceVehicle",props:{disableShare:{type:Boolean,default:!1}},data:function(){return{}},computed:Object(r["a"])({},Object(s["b"])(["isQueryInitData","multipleDeviceids"])),components:{ZtreeDeviceDropdown:l["a"]},methods:Object(r["a"])(Object(r["a"])({},Object(s["c"])(["setMultipleDeviceids"])),{},{onTreeCheck:function(t){this.$emit("onSelectDevice",t),this.setMultipleDeviceids(t)},clearText:function(){var t=this;setTimeout((function(){t.$refs.ztreeDevice.clearText()}),300)}})},c=n,d=(i("7031"),i("2877")),u=Object(d["a"])(c,a,o,!1,null,null,null);e["a"]=u.exports}}]);