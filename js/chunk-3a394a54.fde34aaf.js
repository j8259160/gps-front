(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3a394a54"],{"48f8":function(e,t,a){},5735:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e._self._c;return t("div",{staticClass:"device-types full"},[t("div",{staticClass:"btns"},[t("div",{staticClass:"float_left"},[t("el-button",{attrs:{type:"primary",icon:"el-icon-plus"},on:{click:e.handleClickAdd}},[e._v(e._s(e.$t("systemManage.addDeviceType")))])],1),t("div",{staticClass:"float_left"},[t("LabelWrap",{attrs:{label:e.$t("common.search")}},[t("el-input",{attrs:{clearable:"",type:"text"},model:{value:e.searchText,callback:function(t){e.searchText=t},expression:"searchText"}})],1)],1),t("div",[t("el-button",{attrs:{type:"primary"},on:{click:e.handleClickSearch}},[e._v(e._s(e.$t("common.search")))])],1)]),t("div",{staticClass:"device-types-table"},[t("vxe-table",{attrs:{border:"",resizable:"","show-overflow":"","highlight-current-row":"","highlight-hover-row":"",size:"mini",height:"auto",data:e.tableList},on:{"cell-dblclick":e.handleEdit}},[t("vxe-table-column",{attrs:{field:"typename",title:e.$t("systemManage.typeName"),sortable:""}}),t("vxe-table-column",{attrs:{field:"typecode",title:e.$t("systemManage.typeCode"),sortable:""}}),t("vxe-table-column",{attrs:{field:"supportmodels",title:e.$t("bgManage.factoryType"),sortable:""}}),t("vxe-table-column",{attrs:{field:"defaultidlength",title:e.$t("bgManage.idLength"),width:"90",sortable:""}}),t("vxe-table-column",{attrs:{field:"defaultofflinedelay",title:e.$t("bgManage.offlineDelay"),width:"90",sortable:""}}),t("vxe-table-column",{attrs:{field:"remark",title:e.$t("systemManage.remarkzh")}}),t("vxe-table-column",{attrs:{field:"remarken",title:e.$t("systemManage.remarken")}}),t("vxe-table-column",{attrs:{field:"enabled",title:e.$t("systemManage.isUsed"),width:"90",sortable:""},scopedSlots:e._u([{key:"default",fn:function(a){return[0==a.row.enabled?t("span",[e._v(e._s(e.$t("header.no")))]):t("span",[e._v(e._s(e.$t("header.yes")))])]}}])}),t("vxe-table-column",{attrs:{title:e.$t("reportForm.action"),width:"100"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("div",{staticStyle:{"padding-top":"7px"}},[t("span",{staticStyle:{padding:"0px 10px 0px 0px"}},[t("img",{staticStyle:{width:"20px",cursor:"pointer"},attrs:{src:e.editIcon,title:e.$t("common.edit")},on:{click:function(t){return e.handleEdit(a)}}})]),t("el-popconfirm",{attrs:{placement:"top",icon:"el-icon-info","icon-color":"red","confirm-button-text":e.$t("common.confirm"),"cancel-button-text":e.$t("common.cancel"),title:"确定删除吗？"},on:{confirm:function(t){return e.handleDelete(a)}}},[t("span",{attrs:{slot:"reference"},slot:"reference"},[t("img",{staticStyle:{width:"20px",cursor:"pointer"},attrs:{src:e.deleteIcon,title:e.$t("common.delete")}})])])],1)]}}])})],1)],1),t("TypeInfoDialog",{ref:"typeInfo",attrs:{protocolOptions:e.protocolTypes,isEdit:e.isEdit,functionsDesc:e.functionsDesc},model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}})],1)},n=[],l=a("5530"),i=(a("c975"),a("14d9"),a("d3b7"),a("498a"),a("159b"),a("201d")),o=function(){var e=this,t=e._self._c;return t("vxe-modal",{attrs:{title:e.title,className:"modal-padding0",value:e.value,width:"480px"},on:{hide:e.handleClose,close:e.handleClose}},[t("el-row",{staticClass:"margin_b10"},[t("el-col",{attrs:{span:24}},[t("LabelWrap",{attrs:{label:e.$t("systemManage.typeName")}},[t("el-input",{attrs:{clearable:""},model:{value:e.typename,callback:function(t){e.typename=t},expression:"typename"}})],1)],1)],1),t("el-row",{staticClass:"margin_b10"},[t("el-col",{attrs:{span:24}},[t("LabelWrap",{attrs:{label:e.$t("systemManage.typeCode")}},[t("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"",disabled:e.isEdit},model:{value:e.typecode,callback:function(t){e.typecode=t},expression:"typecode"}},e._l(e.protocolOptions,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1)],1),t("el-row",{staticClass:"margin_b10"},[t("el-col",{attrs:{span:24}},[t("LabelWrap",{attrs:{label:e.$t("bgManage.idLength")}},[t("el-input",{attrs:{clearable:""},model:{value:e.defaultidlength,callback:function(t){e.defaultidlength=e._n("string"===typeof t?t.trim():t)},expression:"defaultidlength"}})],1)],1)],1),t("el-row",{staticClass:"margin_b10"},[t("el-col",{attrs:{span:24}},[t("LabelWrap",{attrs:{label:e.$t("bgManage.offlineDelay")}},[t("el-input",{attrs:{clearable:""},model:{value:e.defaultofflinedelay,callback:function(t){e.defaultofflinedelay=e._n("string"===typeof t?t.trim():t)},expression:"defaultofflinedelay"}})],1)],1)],1),t("el-row",{staticClass:"margin_b10"},[t("el-col",{attrs:{span:24}},[t("LabelWrap",{attrs:{label:e.$t("systemManage.remarkzh")}},[t("el-input",{attrs:{clearable:""},model:{value:e.remark,callback:function(t){e.remark=t},expression:"remark"}})],1)],1)],1),t("el-row",{staticClass:"margin_b10"},[t("el-col",{attrs:{span:24}},[t("LabelWrap",{attrs:{label:e.$t("systemManage.remarken")}},[t("el-input",{attrs:{clearable:""},model:{value:e.remarken,callback:function(t){e.remarken=t},expression:"remarken"}})],1)],1)],1),t("el-row",{staticClass:"margin_b10"},[t("el-col",{attrs:{span:24}},[t("div",{staticClass:"supportmodels"},[t("div",{staticClass:"supportmodels-label"},[e._v(" "+e._s(e.$t("bgManage.factoryType"))+" ")]),t("div",{staticClass:"supportmodels-value"},[t("el-input",{attrs:{clearable:"",type:"textarea",rows:2,autosize:{minRows:2,maxRows:4}},model:{value:e.supportmodels,callback:function(t){e.supportmodels=t},expression:"supportmodels"}})],1)])])],1),t("el-row",{staticClass:"margin_b10"},[t("el-col",{attrs:{span:24}},[t("LabelWrap",{attrs:{label:e.$t("systemManage.isUsed")}},[t("div",{staticStyle:{padding:"5px 0px 0px 18px"}},[t("el-checkbox",{model:{value:e.checked,callback:function(t){e.checked=t},expression:"checked"}})],1)])],1)],1),t("el-row",{staticClass:"margin_b10"},[t("el-col",{attrs:{span:24}},[t("LabelWrap",{attrs:{label:e.$t("monitor.deviceIcon")}},[t("SelectIcon",{staticStyle:{border:"1px solid transparent"},model:{value:e.icon,callback:function(t){e.icon=t},expression:"icon"}})],1)],1)],1),t("el-row",{staticClass:"margin_b10 functions"},[t("el-col",{attrs:{span:2}},[e._v(" "+e._s(e.$t("common.functions"))+" ")]),t("el-col",{attrs:{span:22}},[t("el-checkbox-group",{model:{value:e.functionsCheck,callback:function(t){e.functionsCheck=t},expression:"functionsCheck"}},e._l(e.functionsDesc,(function(a){return t("el-checkbox",{key:a.mask,attrs:{label:a.mask}},[t("span",[e._v(e._s(a.functionname))])])})),1)],1)],1),e.isEdit?t("el-row",[t("el-col",{attrs:{span:8,offset:8}},[t("el-button",{staticStyle:{width:"100%"},attrs:{type:"primary"},on:{click:e.handleEdit}},[e._v(e._s(e.$t("common.determine")))])],1)],1):t("el-row",[t("el-col",{attrs:{span:8,offset:8}},[t("el-button",{staticStyle:{width:"100%"},attrs:{type:"primary"},on:{click:e.handleAdd}},[e._v(e._s(e.$t("common.determine")))])],1)],1)],1)},c=[],r=a("b562"),d=a("5fbc"),u={name:"TypeInfoDialog",props:{value:{type:Boolean,default:!1},isEdit:{type:Boolean,default:!1},protocolOptions:{type:Array,default:function(){return[]}},functionsDesc:{type:Array,default:function(){return[]}}},components:{LabelWrap:i["a"],SelectIcon:d["a"]},data:function(){return{icon:0,typename:"",typecode:"",supportmodels:"",defaultofflinedelay:10,defaultidlength:11,remark:"",remarken:"",functionsCheck:[],checked:!1}},computed:{title:function(){return this.isEdit?this.$t("systemManage.editDeviceType"):this.$t("systemManage.addDeviceType")}},watch:{value:function(e){e&&!1===this.isEdit&&(""==this.typecode&&this.protocolOptions.length>0&&(this.typecode=this.protocolOptions[0].value),this.icon=0,this.typename="",this.defaultidlength=11,this.remark="",this.remarken="",this.functionsCheck=[])}},methods:{handleClose:function(){this.$emit("input",!1)},setFunctionsLong:function(e){for(var t=[],a=this.functionsDesc,s=0;s<a.length;++s){var n=a[s],l=n.mask;(l&e)==l&&t.push(l)}return t},getFunctionsLong:function(){var e=0;return this.functionsCheck.forEach((function(t){e|=t})),e},setTypeInfo:function(e){var t=e.row;this.typename=t.typename,this.icon=t.icon,this.typecode=t.typecode,this.defaultidlength=t.defaultidlength,this.defaultofflinedelay=t.defaultofflinedelay,this.remark=t.remark,this.remarken=t.remarken,this.functionsCheck=this.setFunctionsLong(t.functionslong),this.supportmodels=t.supportmodels,this.checked=0!=t.enabled,this.row=t},handleEdit:function(){var e=this,t=this.$parent,a=this.row,s={icon:this.icon,devicetypeid:a.devicetypeid,typecode:this.typecode,newtypename:this.typename,oldtypename:a.typename,defaultidlength:this.defaultidlength,functionslong:this.getFunctionsLong(),remark:this.remark,remarken:this.remarken,defaultofflinedelay:this.defaultofflinedelay,supportmodels:this.supportmodels,enabled:this.checked?1:0};Object(r["x"])(s).then((function(n){var l=n.status;0==l?(e.handleClose(),a.enabled=s.enabled,a.icon=s.icon,a.typecode=s.typecode,a.typename=s.newtypename,a.defaultidlength=s.defaultidlength,a.remark=s.remark,a.remarken=s.remarken,a.functionslong=s.functionslong,a.defaultofflinedelay=s.defaultofflinedelay,a.supportmodels=s.supportmodels,t.tableList.forEach((function(e){e.devicetypeid==a.devicetypeid&&(e.supportmodels=s.supportmodels)})),t.cacehList.forEach((function(e){e.devicetypeid==a.devicetypeid&&(e.supportmodels=s.supportmodels)})),e.$XModal.message({message:e.$t("tips.editSucc"),status:"success",zIndex:9999})):e.$XModal.message({message:e.$t("tips.editFail"),status:"error",zIndex:9999})}))},handleAdd:function(){var e=this,t={icon:this.icon,typecode:this.typecode,typename:this.typename,defaultidlength:this.defaultidlength,functionslong:this.getFunctionsLong(),remark:this.remark,remarken:this.remarken,defaultofflinedelay:this.defaultofflinedelay,enabled:this.checked?1:0};Object(r["b"])(t).then((function(t){var a=t.status;0==a?(e.handleClose(),e.$parent.queryDeviceTypes(),e.$XModal.message({message:e.$t("tips.addSucc"),status:"success",zIndex:9999})):e.$XModal.message({message:e.$t("tips.addFail"),status:"error",zIndex:9999})}))}}},p=u,f=a("2877"),m=Object(f["a"])(p,o,c,!1,null,null,null),h=m.exports,y=a("2f62"),b=a("61fc"),g=a("e173"),v={name:"DeviceTypes",data:function(){return{editIcon:b,deleteIcon:g,searchText:"",tableList:[],protocolTypes:[],functionsDesc:[],dialog:!1,isEdit:!1}},computed:Object(l["a"])({},Object(y["b"])(["isZh"])),components:{TypeInfoDialog:h,LabelWrap:i["a"]},methods:{handleEdit:function(e){this.$refs.typeInfo.setTypeInfo(e),this.isEdit=!0,this.dialog=!0},handleDelete:function(e){var t=this,a=e.rowIndex,s=e.row.devicetypeid;Object(r["o"])(s).then((function(e){var n=e.status;if(0==n){t.$delete(t.tableList,a);var l=[];t.cacehList.forEach((function(e){e.devicetypeid!=s&&l.push(e)})),t.cacehList=l,t.$XModal.message({message:t.$t("tips.deleteSucc"),status:"success",zIndex:9999})}else t.$XModal.message({message:t.$t("tips.deleteFail"),status:"error",zIndex:9999})}))},handleClickAdd:function(){this.isEdit=!1,this.dialog=!0},handleClickSearch:function(){var e=this.searchText.trim();e=e.toLocaleLowerCase();var t=[];this.cacehList.forEach((function(a){var s=a.typecode?a.typecode:"",n=a.typename?a.typename:"",l=a.supportmodels?String(a.supportmodels):"",i=a.remark?a.remark:"",o=a.remarken?a.remarken:"";s=s.toLocaleLowerCase(),n=n.toLocaleLowerCase(),l=l.toLocaleLowerCase(),i=i.toLocaleLowerCase(),o=o.toLocaleLowerCase(),-1==s.indexOf(e)&&-1==n.indexOf(e)&&-1==l.indexOf(e)&&-1==i.indexOf(e)&&-1==o.indexOf(e)||t.push(a)})),this.tableList=t},queryDeviceTypes:function(){var e=this;Object(r["R"])().then((function(t){var a=t.devicetypes;if(a){e.cacehList=a;var s=[];a.forEach((function(e){s.push(Object(l["a"])({},e))})),e.tableList=s}}))},queryProtocolTypes:function(){var e=this;Object(r["J"])().then((function(t){var a=t.types;if(a){var s=[];a.forEach((function(e){s.push({label:e,value:e})})),e.protocolTypes=s}}))},queryFunctionsDesc:function(){var e=this,t=this.isZh;Object(r["U"])().then((function(a){var s=a.records;s&&(t||s.forEach((function(e){e.functionname=e.functionnameen})),e.functionsDesc=s)}))}},mounted:function(){var e=this;this.cacehList=[],this.$nextTick((function(){e.queryDeviceTypes(),e.queryProtocolTypes(),e.queryFunctionsDesc()}))}},k=v,x=(a("ef26"),Object(f["a"])(k,s,n,!1,null,null,null)),w=x.exports;t["default"]=w},ef26:function(e,t,a){"use strict";a("48f8")}}]);