(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-dda1b1e8"],{"0595":function(e,t,a){"use strict";var i=function(){var e=this,t=e._self._c;return t("div",{staticClass:"quick-time-range"},[t("div",{staticClass:"quick-time-range-wrapper"},e._l(e.list,(function(a){return t("div",{key:a.type,style:{color:a.type==e.type?"#409EFF":""},on:{click:function(t){return e.selectDate(a.type)}}},[e._v(e._s(a.label))])})),0),t("div",{staticClass:"quick-time-range-space"}),t("div",{staticClass:"quick-time-range-btn",on:{click:function(t){e.isCollapse=!e.isCollapse}}},[e.isCollapse?t("i",{staticClass:"el-icon-arrow-right"}):t("i",{staticClass:"el-icon-arrow-left"})])])},r=[],s=a("5101"),n={name:"QuickTimeRange",props:{value:{type:Array,default:function(){return[]}},dateType:{type:String,default:"date"}},watch:{isCollapse:function(){this.setList()}},data:function(){return{isCollapse:!0,type:0,list:[]}},methods:{setList:function(){this.isCollapse?this.list=[{label:this.$t("reportForm.toDay"),type:0},{label:this.$t("reportForm.yesterDay"),type:1},{label:this.$t("reportForm.recent3Days"),type:3}]:this.list=[{label:this.$t("reportForm.recent7Days"),type:7},{label:this.$t("reportForm.recent10Days"),type:10},{label:this.$t("reportForm.recent30Days"),type:30}]},selectDate:function(e){var t="datetimerange"==this.dateType,a=[],i=new Date,r=new Date;switch(t&&(i=new Date(s["a"].format(new Date,"yyyy-MM-dd")+" 00:00:00"),r=new Date(s["a"].format(new Date,"yyyy-MM-dd")+" 23:59:59")),e){case 0:a=[new Date(s["a"].format(i,"yyyy-MM-dd")+" 00:00:00"),new Date(s["a"].format(r,"yyyy-MM-dd")+" 23:59:59")];break;case 1:i.setTime(i.getTime()-864e5),r.setTime(r.getTime()-864e5),a=[i,r];break;case 3:i.setTime(i.getTime()-2592e5),a=[i,r];break;case 7:i.setTime(i.getTime()-6048e5),a=[i,r];break;case 10:i.setTime(i.getTime()-864e6),a=[i,r];break;case 30:i.setTime(i.getTime()-2592e6),a=[i,r];break}this.type=e,this.$emit("input",a)}},mounted:function(){var e=this;this.$nextTick((function(){e.setList()}))}},o=n,l=(a("8d09"),a("2877")),c=Object(l["a"])(o,i,r,!1,null,null,null);t["a"]=c.exports},"8d09":function(e,t,a){"use strict";a("a818")},"94f5":function(e,t,a){"use strict";a("cff7")},a818:function(e,t,a){},c596:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e._self._c;return t("div",{staticClass:"transfer-records"},[t("div",{staticClass:"transfer-records-header"},[t("div",{staticClass:"f_left"},[t("SelectDate",{model:{value:e.dateRange,callback:function(t){e.dateRange=t},expression:"dateRange"}})],1),t("div",{staticClass:"f_left"},[t("QuickTimeRange",{model:{value:e.dateRange,callback:function(t){e.dateRange=t},expression:"dateRange"}})],1),t("div",{staticClass:"f_left"},[t("el-button",{attrs:{loading:e.loading,type:"primary"},on:{click:e.handleQuery}},[e._v(e._s(e.$t("common.query")))])],1),t("div",{staticClass:"f_right"},[t("el-button",{attrs:{type:"primary",loading:e.exportLoading2},on:{click:e.exportDataDetail}},[e._v(e._s(e.$t("bgManage.exportDetail")))])],1),t("div",{staticClass:"f_right"},[t("el-button",{attrs:{type:"primary",loading:e.exportLoading1},on:{click:e.exportData}},[e._v(e._s(e.$t("common.exportData")))])],1),t("div",{staticClass:"f_right"},[t("span",[e._v(e._s(e.$t("bgManage.totalGoldenBeans")))]),e._v(" : "),t("span",{domProps:{textContent:e._s(e.bonuspoints)}})])]),t("div",{staticClass:"transfer-records-table"},[t("vxe-table",{attrs:{border:"",resizable:"","auto-resize":"","show-overflow":"","highlight-hover-row":"",size:"mini",height:"auto",data:e.tableList,"row-class-name":e.rowClassName}},[t("vxe-table-column",{attrs:{type:"seq",width:"60",title:e.$t("reportForm.index")}}),t("vxe-table-column",{attrs:{field:"assigntypeStr",title:e.$t("bgManage.type"),width:"80"}}),t("vxe-table-column",{attrs:{field:"eventtypeStr",title:e.$t("bgManage.event"),width:"100"}}),t("vxe-table-column",{attrs:{field:"createtimeStr",title:e.$t("bgManage.operationTime"),width:"155",sortable:""}}),t("vxe-table-column",{attrs:{field:"otherusername",title:e.$t("bgManage.operationAccount")}}),t("vxe-table-column",{attrs:{field:"points",title:e.$t("bgManage.operatingGoldenBeans"),sortable:""}}),t("vxe-table-column",{attrs:{field:"prepoints",title:e.$t("bgManage.beforeJindou"),sortable:""}}),t("vxe-table-column",{attrs:{field:"postpoints",title:e.$t("bgManage.afterJindou"),sortable:""}}),t("vxe-table-column",{attrs:{field:"chargeyears",title:e.$t("bgManage.renewYears"),width:"100"}}),t("vxe-table-column",{attrs:{field:"packagesStr",sortable:"",title:e.$t("systemManage.packages"),width:"120"}}),t("vxe-table-column",{attrs:{field:"remark",title:e.$t("reportForm.remarks"),width:"100"}}),t("vxe-table-column",{attrs:{title:e.$t("bgManage.deviceList"),width:"100"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(t){return e.handleClickRow(a.row)}}},[e._v(e._s(e.$t("common.see")))])]}}])})],1)],1),t("div",{staticClass:"transfer-records-footer"},[e._v(" "+e._s(e.$t("reportForm.total"))+" "),t("span",{domProps:{textContent:e._s(e.total)}}),e._v(", "+e._s(e.$t("bgManage.switchOut"))+": "),t("span",{domProps:{textContent:e._s(e.switchOut)}}),e._v(", "+e._s(e.$t("bgManage.switchIn"))+": "),t("span",{domProps:{textContent:e._s(e.switchIn)}})]),t("DeviceListDialog",{ref:"dialog",attrs:{packages:e.packages},model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}})],1)},r=[],s=(a("99af"),a("d81d"),a("14d9"),a("4e82"),a("a9e3"),a("b680"),a("d3b7"),a("159b"),a("6e52")),n=a("b562"),o=a("e285"),l=function(){var e=this,t=e._self._c;return t("vxe-modal",{attrs:{title:e.title,value:e.value,className:"modal-padding0",width:"980px"},on:{hide:e.handleClose,close:e.handleClose}},[t("vxe-table",{staticClass:"mytable-scrollbar",attrs:{loading:e.loading,"menu-config":e.tableMenu,border:"",resizable:"","show-overflow":"","highlight-hover-row":"",size:"mini",height:"460",data:e.tableList},on:{"menu-click":e.handleClickTableMenu}},[t("vxe-table-column",{attrs:{type:"seq",width:"60",title:e.$t("reportForm.index")}}),t("vxe-table-column",{attrs:{field:"creater",title:e.$t("reportForm.creater"),width:"100"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-popover",{attrs:{placement:"bottom",trigger:"click"}},[t("div",{staticClass:"parents-wrapper"},e._l(e.parentsList,(function(a){return t("div",{key:a.username},[e._v(e._s(a.username)+"("+e._s(a.usertypeStr)+")")])})),0),t("el-button",{staticStyle:{color:"#000000"},attrs:{slot:"reference",type:"text"},on:{click:function(t){return e.queryParents(a.row.creater)}},slot:"reference"},[e._v(e._s(a.row.creater))])],1)]}}])}),t("vxe-table-column",{attrs:{field:"groupname",title:e.$t("reportForm.groupName"),width:"100"}}),t("vxe-table-column",{attrs:{field:"devicename",title:e.$t("alarm.devName"),width:"100"}}),t("vxe-table-column",{attrs:{field:"deviceid",title:e.$t("alarm.devNum"),width:"80"}}),t("vxe-table-column",{attrs:{field:"simnum",title:e.$t("reportForm.sim"),width:"80"}}),t("vxe-table-column",{attrs:{field:"simiccid",title:"ICCID",width:"80"}}),t("vxe-table-column",{attrs:{field:"devicetypename",title:e.$t("reportForm.deviceType"),width:"100",sortable:""}}),t("vxe-table-column",{attrs:{field:"chargepoints",title:e.$t("bgManage.goldenBeanNumber"),width:"100"}}),t("vxe-table-column",{attrs:{field:"chargeyears",title:e.$t("bgManage.renewYears"),width:"100",sortable:""}}),t("vxe-table-column",{attrs:{field:"peryearpoints",title:e.$t("bgManage.totalAmount"),width:"100",sortable:""}}),t("vxe-table-column",{attrs:{field:"preoverduetimeStr",title:e.$t("bgManage.renewBefore"),width:"100"}}),t("vxe-table-column",{attrs:{field:"postoverduetimeStr",title:e.$t("bgManage.renewAfter"),width:"100"}}),t("vxe-table-column",{attrs:{field:"packagesStr",sortable:"",title:e.$t("systemManage.packages"),width:"120"}})],1),t("el-row",{staticStyle:{"margin-top":"10px"}},[t("el-col",{attrs:{span:8,offset:3}},[t("el-button",{staticStyle:{width:"100%"},attrs:{type:"primary"},on:{click:e.handleClose}},[e._v(" "+e._s(e.$t("common.determine")))])],1),t("el-col",{attrs:{span:8,offset:2}},[t("el-button",{staticStyle:{width:"100%"},attrs:{type:"primary",loading:e.exportLoading1},on:{click:e.exportData}},[e._v(" "+e._s(e.$t("common.exportData")))])],1)],1)],1)},c=[],u=a("5101"),p=a("a05b"),d=a("0c87"),h=a("c276"),g={name:"DeviceListDialog",props:{value:{type:Boolean,default:!1},packages:{type:Array,default:function(){return[]}}},data:function(){return{loading:!1,exportLoading1:!1,tableList:[]}},watch:{value:function(e){e||(this.tableList=[])}},computed:{title:function(){var e=this.tableList[0];return e?this.$t("bgManage.renewList")+(e?"  "+e.chargetimeStr:""):this.$t("bgManage.renewList")}},mixins:[p["a"],d["a"]],methods:{handleClose:function(){this.$emit("input",!1)},exportData:function(){var e=[[this.$t("reportForm.index"),this.$t("reportForm.creater"),this.$t("reportForm.groupName"),this.$t("alarm.devName"),this.$t("alarm.devNum"),this.$t("reportForm.sim"),"ICCID",this.$t("reportForm.deviceType"),this.$t("bgManage.goldenBeanNumber"),this.$t("bgManage.renewYears"),this.$t("bgManage.totalAmount"),this.$t("bgManage.renewTime"),this.$t("bgManage.renewBefore"),this.$t("bgManage.renewAfter"),this.$t("systemManage.packages")]];if(0!=this.tableList.length){this.tableList.forEach((function(t,a){var i=[];i.push(a+1),i.push(t.creater),i.push(t.groupname),i.push(t.devicename),i.push(t.deviceid),i.push(t.simnum?t.simnum:""),i.push(t.simiccid?t.simiccid:""),i.push(t.devicetypename),i.push(t.chargepoints),i.push(t.chargeyears),i.push(t.peryearpoints),i.push(t.chargetimeStr),i.push(t.preoverduetimeStr),i.push(t.postoverduetimeStr),i.push(t.packagesStr),e.push(i)}));var t={title:this.$t("bgManage.renewList"),data:e,dateRange:null};this.exportLoading1=!0,new ExcelCls(t).exportExcel(this)}},queryChargeDevices:function(e){var t=this;this.loading=!0;var a=this.packages;Object(o["jb"])(e).then((function(e){var i=e.records;i&&i.length?(i.forEach((function(e){var t=e.deviceid,i=s["a"].deviceInfos[t];e.creater=i?i.creater:"",e.groupname=i?i.groupname:"",e.chargetimeStr=0!=e.chargetime?u["a"].longToLocalDateTimeStr(e.chargetime):"-",e.postoverduetimeStr=0!=e.postoverduetime?u["a"].format(new Date(e.postoverduetime),"yyyy-MM-dd"):"-",e.preoverduetimeStr=0!=e.preoverduetime?u["a"].format(new Date(e.preoverduetime),"yyyy-MM-dd"):"-",Object(h["tb"])(e,a,e.packageids)})),t.tableList=i):t.tableList=[]})).finally((function(){t.loading=!1}))}}},m=g,b=a("2877"),f=Object(b["a"])(m,l,c,!1,null,null,null),v=f.exports,y=a("2ddc"),w=a("0595"),$={name:"transferRecords",data:function(){return{loading:!1,dialog:!1,exportLoading1:!1,exportLoading2:!1,dateRange:[new Date,new Date],tableList:[],packages:[],bonuspoints:"",total:0,switchOut:0,switchIn:0,resultCount:0,devicechargeuuidLength:0}},components:{SelectDate:y["a"],QuickTimeRange:w["a"],DeviceListDialog:v},methods:{exportData:function(){var e=[[this.$t("reportForm.index"),this.$t("bgManage.event"),this.$t("bgManage.type"),this.$t("bgManage.operationTime"),this.$t("bgManage.operationAccount"),this.$t("bgManage.operatingGoldenBeans"),this.$t("bgManage.beforeJindou"),this.$t("bgManage.afterJindou"),this.$t("bgManage.renewYears"),this.$t("systemManage.packages"),this.$t("reportForm.remarks")]];this.tableList.forEach((function(t,a){var i=[];i.push(++a),i.push(t.eventtypeStr),i.push(t.assigntypeStr),i.push(t.createtimeStr),i.push(t.otherusername),i.push(t.points),i.push(t.prepoints),i.push(t.postpoints),i.push(t.chargeyears),i.push(t.packagesStr),i.push(t.remark),e.push(i)}));var t={title:this.$t("bgManage.transferRecords"),data:e,dateRange:this.dateRangeRecords};this.exportLoading1=!0,new ExcelCls(t).exportExcel(this)},exportDataDetail:function(){var e=this,t=this.tableList.map((function(e){if(Number(e.points)<0)return e.devicechargeuuid}));if(t.length>0){var a=this.$loading({lock:!0,text:"0 / "+t.length,spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"});this.devicechargeuuidLength=t.length,this.resultCount=0;var i=[];t.forEach((function(t){Object(o["jb"])(t).then((function(t){if(e.resultCount++,a.text=e.resultCount+" / "+e.devicechargeuuidLength,t.records&&(i=i.concat(t.records)),e.devicechargeuuidLength==e.resultCount){a.close();var r=[[e.$t("reportForm.index"),e.$t("reportForm.creater"),e.$t("reportForm.groupName"),e.$t("alarm.devName"),e.$t("alarm.devNum"),e.$t("reportForm.sim"),"ICCID",e.$t("reportForm.deviceType"),e.$t("bgManage.goldenBeanNumber"),e.$t("bgManage.renewYears"),e.$t("bgManage.totalAmount"),e.$t("bgManage.renewTime"),e.$t("systemManage.packages"),e.$t("bgManage.renewBefore"),e.$t("bgManage.renewAfter")]],n=e.packages,o=0;i.forEach((function(e,t){var a=e.deviceid,i=s["a"].deviceInfos[a];e.creater=i?i.creater:"",e.groupname=i?i.groupname:"",e.chargetimeStr=0!=e.chargetime?u["a"].longToLocalDateTimeStr(e.chargetime):"-",e.postoverduetimeStr=0!=e.postoverduetime?u["a"].format(new Date(e.postoverduetime),"yyyy-MM-dd"):"-",e.preoverduetimeStr=0!=e.preoverduetime?u["a"].format(new Date(e.preoverduetime),"yyyy-MM-dd"):"-",o+=e.peryearpoints,Object(h["tb"])(e,n,e.packageids);var l=[];l.push(t+1),l.push(e.creater),l.push(e.groupname),l.push(e.devicename),l.push(e.deviceid),l.push(e.simnum?e.simnum:""),l.push(e.simiccid?e.simiccid:""),l.push(e.devicetypename),l.push(e.chargepoints),l.push(e.chargeyears),l.push(e.peryearpoints),l.push(e.chargetimeStr),l.push(e.packagesStr),l.push(e.preoverduetimeStr),l.push(e.postoverduetimeStr),r.push(l)}));var l=[];l.push(""),l.push(""),l.push(""),l.push(""),l.push(""),l.push(""),l.push(""),l.push(""),l.push(""),l.push(""),l.push(o),l.push(""),l.push(""),l.push(""),l.push(""),r.push(l);var c={title:e.$t("bgManage.renewList"),data:r,dateRange:null};e.exportLoading2=!0,new ExcelCls(c).exportExcel(e)}}))}))}},rowClassName:function(e){var t=e.row;e.rowIndex;return 0===t.assigntype?"row-blue":"row-red"},handleQuery:function(){var e=this,t=this.packages,a=this.dateRange,i=u["a"].format(a[0],"yyyy-MM-dd"),r=u["a"].format(a[1],"yyyy-MM-dd"),s={startday:i,endday:r,offset:u["a"].getOffset(),notifytype:0};this.loading=!0,this.dateRangeRecords="".concat(i," - ").concat(r),Object(o["Eb"])(s).then((function(a){var i=a.records;if(e.loading=!1,i&&i.length){e.tableList=[];var r=0,s=0,n=0;i.sort((function(e,t){return t.createtime-e.createtime})),i.forEach((function(a){r+=a.points,a.eventtypeStr=Object(h["z"])(a.eventtype),a.assigntypeStr=0===a.assigntype?e.$t("bgManage.switchIn"):e.$t("bgManage.switchOut"),a.createtimeStr=u["a"].longToLocalDateTimeStr(a.createtime),a.points=Number(a.points.toFixed(2)),a.prepoints=Number(a.prepoints.toFixed(2)),a.postpoints=Number(a.postpoints.toFixed(2)),0===a.assigntype?s+=a.points:n+=a.points,Object(h["tb"])(a,t,a.packageids)})),e.tableList=i,e.total=Number(r.toFixed(2)),e.switchIn=Number(s.toFixed(2)),e.switchOut=Math.abs(Number(n.toFixed(2)))}else e.tableList=[],e.total=0,e.switchIn=0,e.switchOut=0})).catch((function(t){e.loading=!1}))},handleClickRow:function(e){this.dialog=!0,this.$refs.dialog.queryChargeDevices(e.devicechargeuuid)}},mounted:function(){var e=this;this.dateRangeRecords=null,Object(n["Z"])({filterenabled:0}).then((function(t){var a=t.packages;a=a||[],e.packages=a,Object(o["hb"])().then((function(t){var a=t.bonuspoints;e.bonuspoints=Number(a.toFixed(2))}))}))}},x=$,M=(a("94f5"),Object(b["a"])(x,i,r,!1,null,null,null)),k=M.exports;t["default"]=k},cff7:function(e,t,a){}}]);