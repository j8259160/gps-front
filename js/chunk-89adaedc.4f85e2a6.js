(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-89adaedc"],{"1a58":function(t,e,r){"use strict";r.r(e);var a=function(){var t=this,e=t._self._c;return e("div",{staticClass:"report-form full new-add-device"},[e("div",{staticClass:"report-form-inner"},[e("div",{staticClass:"report-form-inner-header",staticStyle:{height:"34px","text-align":"center"}},[e("el-button-group",[e("el-button",{attrs:{type:7==t.days?"primary":""},on:{click:function(e){t.days=7}}},[t._v(t._s(t.$t("reportForm.sevenDays")))]),e("el-button",{attrs:{type:30==t.days?"primary":""},on:{click:function(e){t.days=30}}},[t._v(t._s(t.$t("reportForm.oneMonth")))]),e("el-button",{attrs:{type:90==t.days?"primary":""},on:{click:function(e){t.days=90}}},[t._v(t._s(t.$t("reportForm.threeMonths")))]),e("el-button",{attrs:{type:180==t.days?"primary":""},on:{click:function(e){t.days=180}}},[t._v(t._s(t.$t("reportForm.sixMonths")))])],1)],1),e("div",{staticClass:"new-add-device-charts"},[e("div",{staticClass:"new-add-device-charts-left"},[e("NewAddEcharts",{ref:"echartsIns"})],1),e("div",{staticClass:"new-add-device-charts-right"},[e("el-card",{staticClass:"box-card",staticStyle:{height:"290px"}},t._l(t.recordRankingArr,(function(r){return e("div",{key:r.creater,staticClass:"text item"},[t._v(t._s(r.creater)+": "+t._s(r.count))])})),0)],1)]),e("div",{staticClass:"report-form-inner-content",staticStyle:{top:"340px"}},[e("vxe-table",{attrs:{"sort-config":t.sortConfig,"menu-config":t.tableMenu,border:"",resizable:"","auto-resize":"","show-overflow":"","highlight-hover-row":"",size:"mini",height:"auto",data:t.totalList},on:{"menu-click":t.handleClickTableMenu}},[e("vxe-table-column",{attrs:{type:"seq",width:"60",title:t.$t("reportForm.index")}}),e("vxe-table-column",{attrs:{field:"creater",title:t.$t("reportForm.creater"),sortable:""},scopedSlots:t._u([{key:"default",fn:function(r){return[e("el-popover",{attrs:{placement:"bottom",trigger:"click"}},[e("div",{staticClass:"parents-wrapper"},t._l(t.parentsList,(function(r){return e("div",{key:r.username},[t._v(t._s(r.username)+"("+t._s(r.usertypeStr)+")")])})),0),e("el-button",{staticStyle:{color:"#000000"},attrs:{slot:"reference",type:"text"},on:{click:function(e){return t.queryParents(r.row.creater)}},slot:"reference"},[t._v(t._s(r.row.creater))])],1)]}}])}),e("vxe-table-column",{attrs:{field:"devicename",title:t.$t("alarm.devName"),sortable:""}}),e("vxe-table-column",{attrs:{field:"deviceid",title:t.$t("alarm.devNum"),sortable:""}}),e("vxe-table-column",{attrs:{field:"deviceType",title:t.$t("reportForm.deviceType"),sortable:""}}),e("vxe-table-column",{attrs:{field:"addTime",title:t.$t("reportForm.addTime"),sortable:""}})],1)],1)])])},n=[],s=r("5530"),i=(r("14d9"),r("4e82"),r("a9e3"),r("d3b7"),r("159b"),r("1c31")),o=r("5101"),c=r("2f62"),d=function(){var t=this,e=t._self._c;return e("div",{ref:"chartId",staticClass:"full"})},l=[],u=r("43c8"),h=r.n(u),f={name:"NewAddEcharts",computed:Object(s["a"])({},Object(c["b"])(["isZh"])),methods:{initChart:function(){this.chartsIns=h.a.init(this.$refs.chartId),this.chartsIns.setOption(this.getChartsOption([],[]),!0)},updateChartsOption:function(t,e){this.chartsIns.setOption(this.getChartsOption(t,e),!0),this.chartsIns.resize()},getChartsOption:function(t,e){return{title:{text:""},tooltip:{trigger:"axis"},grid:{top:"8%",left:"4%",right:"4%",bottom:"4%",containLabel:!0},toolbox:{show:!1,feature:{saveAsImage:{}}},xAxis:{type:"category",boundaryGap:!1,data:t},yAxis:{type:"value"},series:[{name:this.$t("reportForm.newAddDevice"),type:"line",stack:this.$t("monitor.total"),data:e,smooth:!0}]}}},mounted:function(){var t=this;this.$nextTick((function(){t.initChart()}))}},p=f,v=r("2877"),m=Object(v["a"])(p,d,l,!1,null,null,null),y=m.exports,b=r("4c3c"),g=r("a05b"),w=r("0c87"),x={name:"newAddDevice",data:function(){return{days:0,totalList:[],recordRankingArr:[]}},watch:{days:function(t){this.queryAddDevices()}},mixins:[b["a"],g["a"],w["a"]],components:{NewAddEcharts:y},computed:Object(s["a"])({},Object(c["b"])(["deviceTypes"])),methods:{queryAddDevices:function(){var t=this,e={offset:o["a"].getOffset(),days:this.days},r=this.deviceTypes;Object(i["n"])(e).then((function(e){var a=e.devices,n=[],s=t.getLatestDate(),i=[],c={},d=[];a&&(a.forEach((function(t){var e=r[t.devicetype].typename;t.deviceType=e,t.addTime=o["a"].longToLocalDateTimeStr(t.createtime);var a=t.creater;t.creater=cacheMgr.getShowName(a),c[a]?c[a].count++:c[a]={showname:t.creater,count:1}})),n=a,s.forEach((function(t){var e=0;a.forEach((function(r){var a=o["a"].format(new Date(r.createtime),"yyyy-MM-dd");t==a&&e++})),i.push(e)})),d=t.getRecordRankingArr(c)),t.totalList=n,t.recordRankingArr=d,t.$refs.echartsIns.updateChartsOption(s,i)}))},getLatestDate:function(){for(var t=Number(this.days),e=[],r=o["a"].format(new Date(Date.now()-24*(t-1)*3600*1e3),"yyyy-MM-dd"),a=0;a<t;a++){var n=o["a"].addDay(new Date(r),a),s=o["a"].format(n,"yyyy-MM-dd");e.push(s)}return e},getRecordRankingArr:function(t){var e=[];for(var r in t){var a=t[r];e.push({creater:a.showname,count:a.count})}return e.sort((function(t,e){return e.count-t.count})),e.length>5&&(e.length=5),e}},mounted:function(){var t=this;this.$nextTick((function(){t.days=7}))}},_=x,k=(r("cd55"),Object(v["a"])(_,a,n,!1,null,null,null)),C=k.exports;e["default"]=C},6663:function(t,e,r){},cd55:function(t,e,r){"use strict";r("6663")}}]);