(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4fb3196a"],{"0595":function(t,e,i){"use strict";var a=function(){var t=this,e=t._self._c;return e("div",{staticClass:"quick-time-range"},[e("div",{staticClass:"quick-time-range-wrapper"},t._l(t.list,(function(i){return e("div",{key:i.type,style:{color:i.type==t.type?"#409EFF":""},on:{click:function(e){return t.selectDate(i.type)}}},[t._v(t._s(i.label))])})),0),e("div",{staticClass:"quick-time-range-space"}),e("div",{staticClass:"quick-time-range-btn",on:{click:function(e){t.isCollapse=!t.isCollapse}}},[t.isCollapse?e("i",{staticClass:"el-icon-arrow-right"}):e("i",{staticClass:"el-icon-arrow-left"})])])},r=[],o=i("5101"),s={name:"QuickTimeRange",props:{value:{type:Array,default:function(){return[]}},dateType:{type:String,default:"date"}},watch:{isCollapse:function(){this.setList()}},data:function(){return{isCollapse:!0,type:0,list:[]}},methods:{setList:function(){this.isCollapse?this.list=[{label:this.$t("reportForm.toDay"),type:0},{label:this.$t("reportForm.yesterDay"),type:1},{label:this.$t("reportForm.recent3Days"),type:3}]:this.list=[{label:this.$t("reportForm.recent7Days"),type:7},{label:this.$t("reportForm.recent10Days"),type:10},{label:this.$t("reportForm.recent30Days"),type:30}]},selectDate:function(t){var e="datetimerange"==this.dateType,i=[],a=new Date,r=new Date;switch(e&&(a=new Date(o["a"].format(new Date,"yyyy-MM-dd")+" 00:00:00"),r=new Date(o["a"].format(new Date,"yyyy-MM-dd")+" 23:59:59")),t){case 0:i=[new Date(o["a"].format(a,"yyyy-MM-dd")+" 00:00:00"),new Date(o["a"].format(r,"yyyy-MM-dd")+" 23:59:59")];break;case 1:a.setTime(a.getTime()-864e5),r.setTime(r.getTime()-864e5),i=[a,r];break;case 3:a.setTime(a.getTime()-2592e5),i=[a,r];break;case 7:a.setTime(a.getTime()-6048e5),i=[a,r];break;case 10:a.setTime(a.getTime()-864e6),i=[a,r];break;case 30:a.setTime(a.getTime()-2592e6),i=[a,r];break}this.type=t,this.$emit("input",i)}},mounted:function(){var t=this;this.$nextTick((function(){t.setList()}))}},l=s,n=(i("8d09"),i("2877")),c=Object(n["a"])(l,a,r,!1,null,null,null);e["a"]=c.exports},"3b13":function(t,e,i){},"57c9":function(t,e,i){"use strict";var a=i("0595");e["a"]=a["a"]},7031:function(t,e,i){"use strict";i("3b13")},"7c2e":function(t,e,i){},"80f4":function(t,e,i){"use strict";var a=i("32eb");e["a"]=a["a"]},"8d09":function(t,e,i){"use strict";i("a818")},a818:function(t,e,i){},e561:function(t,e,i){"use strict";var a=i("ea22");e["a"]=a["a"]},e585:function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t._self._c;return e("div",{staticClass:"report-form full"},[e("div",{staticClass:"report-form-inner"},[e("el-scrollbar",{staticStyle:{width:"100%"}},[e("div",{staticClass:"report-form-inner-header",staticStyle:{height:"45px"}},[e("div",{staticClass:"f_left"},[e("MultiChoiceVehicle",{on:{onSelectDevice:t.onSelectDevice}})],1),e("div",{staticClass:"f_left"},[e("SelectDate",{model:{value:t.dateRange,callback:function(e){t.dateRange=e},expression:"dateRange"}})],1),e("div",{staticClass:"f_left"},[e("QuickTimeRange",{model:{value:t.dateRange,callback:function(e){t.dateRange=e},expression:"dateRange"}})],1),e("div",{staticClass:"f_left",staticStyle:{width:"100px"}},[e("el-select",{staticStyle:{width:"100px"},model:{value:t.oilindex,callback:function(e){t.oilindex=e},expression:"oilindex"}},t._l(t.oilIndexList,(function(t){return e("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1),e("div",{staticClass:"f_left"},[e("el-button",{attrs:{loading:t.loading,type:"primary"},on:{click:t.handleQuery}},[t._v(t._s(t.$t("common.query")))])],1),e("div",{staticClass:"f_left"},[e("el-popover",{attrs:{placement:"bottom",width:"236",trigger:"click"}},[e("div",[e("el-button",{staticStyle:{width:"100px"},attrs:{slot:"reference",type:"primary",plain:"",loading:t.exportLoading1},on:{click:t.exportData},slot:"reference"},[t._v(t._s(t.$t("common.summary")))]),e("el-button",{staticStyle:{width:"100px"},attrs:{slot:"reference",type:"primary",loading:t.exportLoading2,plain:""},on:{click:t.exportDetailData},slot:"reference"},[t._v(t._s(t.$t("reportForm.detailed")))])],1),e("el-button",{attrs:{slot:"reference",type:"primary"},slot:"reference"},[t._v(t._s(t.$t("common.export")))])],1)],1)])]),e("div",{staticStyle:{width:"100%",height:"300px"}},[e("FuelOilEcharts",{attrs:{chartList:t.chartList}})],1),e("div",{staticClass:"report-form-inner-content",staticStyle:{top:"346px"}},[e("el-tabs",{model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[e("el-tab-pane",{attrs:{label:t.$t("reportForm.addOilStatistics")+"(".concat(t.totalList.length,")"),name:"tabTotal"}}),e("el-tab-pane",{attrs:{label:"",name:"details"}})],1),e("div",{directives:[{name:"show",rawName:"v-show",value:"details"==t.activeName,expression:"activeName == 'details'"}],staticStyle:{position:"absolute",left:"0px",right:"0px",top:"10px","text-align":"center"}},[e("b",{domProps:{textContent:t._s(t.tableTitle)}}),t._v(" ("+t._s(t.detailsList.length)+") "),e("span",[t._v(t._s(t.$t("reportForm.totalFuelVolume"))+":"+t._s(t.totalFuelVolume)+"L")])])],1),e("div",{staticClass:"report-form-inner-content",staticStyle:{top:"390px"}},[e("div",{style:t.statisticsStyle},[e("vxe-table",{attrs:{"sort-config":t.sortConfig,"menu-config":t.tableMenu,border:"",resizable:"","show-overflow":"","auto-resize":"","highlight-hover-row":"",size:"mini",height:"auto",data:t.totalList},on:{"menu-click":t.handleClickTableMenu}},[e("vxe-table-column",{attrs:{type:"seq",width:"60",title:t.$t("reportForm.index")}}),e("vxe-table-column",{attrs:{title:t.$t("reportForm.action"),width:"70"},scopedSlots:t._u([{key:"default",fn:function(i){return[e("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(e){return t.handleClickRow(i.row)}}},[t._v(t._s(t.$t("reportForm.details")))])]}}])}),e("vxe-table-column",{attrs:{field:"devicename",title:t.$t("alarm.devName"),sortable:""}}),e("vxe-table-column",{attrs:{field:"deviceid",title:t.$t("alarm.devNum"),sortable:""}}),e("vxe-table-column",{attrs:{field:"dateStr",title:t.$t("reportForm.time"),width:"160",sortable:""}}),e("vxe-table-column",{attrs:{field:"creater",title:t.$t("reportForm.creater"),sortable:""},scopedSlots:t._u([{key:"default",fn:function(i){return[e("el-popover",{attrs:{placement:"bottom",trigger:"click"}},[e("div",{staticClass:"parents-wrapper"},t._l(t.parentsList,(function(i){return e("div",{key:i.username},[t._v(t._s(i.username)+"("+t._s(i.usertypeStr)+")")])})),0),e("el-button",{staticStyle:{color:"#000000"},attrs:{slot:"reference",type:"text"},on:{click:function(e){return t.queryParents(i.row.creater)}},slot:"reference"},[t._v(t._s(i.row.creater))])],1)]}}])}),e("vxe-table-column",{attrs:{field:"groupName",title:t.$t("reportForm.groupName"),sortable:""}}),e("vxe-table-column",{attrs:{field:"fuelVolume",formatter:t.numberToFixed2,align:"right",title:t.$t("reportForm.fuelVolume"),sortable:""}}),e("vxe-table-column",{attrs:{field:"fuelCount",title:t.$t("reportForm.count"),sortable:""}})],1)],1),e("div",{style:t.detailsStyle},[e("vxe-table",{attrs:{border:"","menu-config":t.tableMenu,resizable:"","show-overflow":"","auto-resize":"","highlight-hover-row":"",size:"mini",height:"auto",data:t.detailsList},on:{"menu-click":t.handleClickTableMenu}},[e("vxe-table-column",{attrs:{type:"seq",width:"60",title:t.$t("reportForm.index")}}),e("vxe-table-column",{attrs:{field:"oilIndexStr",title:t.$t("reportForm.oilIndex"),width:"80",sortable:""}}),e("vxe-table-column",{attrs:{field:"oil",formatter:t.numberToFixed2,align:"right",title:t.$t("reportForm.fuelVolume"),width:"100",sortable:""}}),e("vxe-table-column",{attrs:{field:"soil",formatter:t.numberToFixed2,align:"right",title:t.$t("reportForm.startOil"),width:"100",sortable:""}}),e("vxe-table-column",{attrs:{field:"eoil",formatter:t.numberToFixed2,align:"right",title:t.$t("reportForm.endOil"),width:"100",sortable:""}}),e("vxe-table-column",{attrs:{field:"begintimeStr",title:t.$t("reportForm.startTime"),width:"145",sortable:""}}),e("vxe-table-column",{attrs:{field:"endtimeStr",title:t.$t("reportForm.endTime"),width:"145",sortable:""}}),e("vxe-table-column",{attrs:{field:"address",title:t.$t("reportForm.address"),width:"260",sortable:""},scopedSlots:t._u([{key:"default",fn:function(i){return[e("span",{staticStyle:{"text-decoration":"underline",cursor:"pointer",color:"#388cfe"},domProps:{textContent:t._s(i.row.address)},on:{click:function(e){return t.seeMap(i.row)}}})]}}])}),e("vxe-table-column",{attrs:{field:"threshold",title:t.$t("reportForm.threshold"),width:"80",sortable:""}}),e("vxe-table-column",{attrs:{field:"marker",title:t.$t("reportForm.remarks"),width:"120",sortable:""}}),e("vxe-table-column",{attrs:{field:"mauneditStr",title:t.$t("reportForm.artificialEdit"),width:"120",sortable:""}}),e("vxe-table-column",{attrs:{title:t.$t("reportForm.action"),width:"100"},scopedSlots:t._u([{key:"default",fn:function(i){return[e("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(e){return t.editRemark(i.row)}}},[t._v(t._s(t.$t("reportForm.editRemark")))])]}}])})],1)],1)]),e("vxe-modal",{attrs:{title:t.$t("reportForm.editRemark"),className:"modal-padding0",value:t.remarkDialog,width:"360px"},on:{hide:function(e){t.remarkDialog=!1},close:function(e){t.remarkDialog=!1}}},[e("el-row",{attrs:{gutter:10}},[e("el-col",{staticStyle:{"text-align":"center","line-height":"32px"},attrs:{span:4}},[t._v(" "+t._s(t.$t("reportForm.remarks"))+" ")]),e("el-col",{attrs:{span:18}},[e("el-input",{attrs:{clearable:""},model:{value:t.remark,callback:function(e){t.remark=e},expression:"remark"}})],1)],1),e("div",{staticStyle:{height:"10px"}}),e("el-row",{attrs:{gutter:10}},[e("el-col",{attrs:{span:18,offset:4}},[e("el-button",{staticStyle:{width:"100%"},attrs:{type:"primary"},on:{click:t.editOilRecord}},[t._v(t._s(t.$t("common.confirm")))])],1)],1)],1),e("vxe-modal",{attrs:{title:t.$t("reportForm.seeMap"),className:"modal-padding0",value:t.mapDialog,width:"560px"},on:{hide:function(e){t.mapDialog=!1},close:function(e){t.mapDialog=!1}}},[e("div",{staticStyle:{width:"100%",height:"400px"}},[e("ReportMap",{ref:"mapIns"})],1)])],1)])},r=[],o=(i("99af"),i("14d9"),i("4e82"),i("a9e3"),i("b680"),i("d3b7"),i("159b"),i("4795"),i("6e52")),s=i("e561"),l=i("d462"),n=i("57c9"),c=i("80f4"),u=function(){var t=this,e=t._self._c;return e("div",{staticClass:"full"},[e("el-carousel",{attrs:{trigger:"click",autoplay:!1}},t._l(t.chartList,(function(t,i){return e("el-carousel-item",{key:i},[e("div",{staticClass:"full",attrs:{id:"fuel-oil"+i}})])})),1),e("div",{directives:[{name:"show",rawName:"v-show",value:0==t.chartList.length,expression:"chartList.length == 0"}],staticClass:"fuel-oil-mask"},[e("span",[t._v(t._s(t.$t("tips.noData")))])])],1)},d=[],m=i("5530"),h=(i("b0c0"),i("43c8")),p=i.n(h),f=i("2f62"),v={name:"FuelOilEcharts",props:{chartList:{type:Array,default:function(){return[]}}},computed:Object(m["a"])({},Object(f["b"])(["isZh"])),watch:{chartList:function(t){var e=this;setTimeout((function(){e.updateChartsOption(t)}),100)}},methods:{initChart:function(){},updateChartsOption:function(t){var e=0,i=t.length;while(e<i){var a=p.a.init(document.getElementById("fuel-oil"+e)),r=t[e];a.setOption(this.getChartsOption(r.data,r.oil),!0),e++}},getChartsOption:function(t,e){var i=this.$t("reportForm.fuelVolume");return{tooltip:{trigger:"axis",formatter:function(t,e){var a=t[0].name+"<br/>";for(var r in t)t[r].seriesName==i&&(a+=t[r].seriesName+" : "+t[r].value+"L<br/>");return a}},legend:{data:[i],y:13,x:"center"},grid:{x:100,y:40,x2:80,y2:30},xAxis:[{type:"category",axisLabel:{show:!0,interval:0,rotate:0,margin:8,textStyle:{fontSize:12}},data:t}],yAxis:[{type:"value",position:"bottom",nameLocation:"end",boundaryGap:[0,.2],axisLabel:{formatter:"{value}"}}],series:[{name:i,type:"bar",itemStyle:{normal:{label:{show:!0,textStyle:{fontSize:"12",fontFamily:"微软雅黑",fontWeight:"bold"}}}},data:e}]}}},mounted:function(){var t=this;this.$nextTick((function(){t.initChart()}))}},b=v,g=i("2877"),y=Object(g["a"])(b,u,d,!1,null,null,null),x=y.exports,$=i("5101"),k=i("1c31"),w=i("7cf8"),F=i("c276"),D=i("4c3c"),S=i("a05b"),C=i("0c87"),_={name:"fuelOil",data:function(){return{loading:!1,activeName:"tabTotal",tableTitle:"",totalFuelVolume:"",dateRange:[new Date,new Date],totalList:[],detailsList:[],chartList:[],oilindex:"0",oilIndexList:[],remark:"",remarkDialog:!1,exportLoading1:!1,exportLoading2:!1,mapDialog:!1}},watch:{dateRange:function(){this.loading||this.handleQuery()}},mixins:[D["a"],S["a"],C["a"]],components:{MultiChoiceVehicle:s["a"],SelectDate:l["a"],QuickTimeRange:n["a"],ReportMap:c["a"],FuelOilEcharts:x},computed:{statisticsStyle:function(){return{zIndex:"tabTotal"==this.activeName?999:0}},detailsStyle:function(){return{zIndex:"details"==this.activeName?999:0}}},methods:{numberToFixed2:F["qb"],onSelectDevice:function(t){this.deviceids=t},handleClickRow:function(t){t.records.length?(this.detailsList=t.records,this.tableTitle=t.devicename+"-"+t.deviceid,this.totalFuelVolume=t.fuelVolume,this.activeName="details"):this.$t("tips.noData")},seeMap:function(t){var e=this;this.mapDialog=!0;var i={deviceid:t.deviceid,begintime:t.begintimeStr,endtime:t.endtimeStr,interval:0,timezone:$["a"].getOffset()};Object(w["Z"])(i).then((function(t){var i=t.records;i&&setTimeout((function(){e.$refs.mapIns.markersAndLineLayerToMap(i)}),300)}))},editRemark:function(t){this.remarkDialog=!0,this.remark=t.marker,this.editRow=t},editOilRecord:function(){var t=this,e=this.editRow,i={oilrecordid:e.oilrecordid,marker:this.remark,deviceid:e.deviceid,oilindex:e.oilindex};Object(k["h"])(i).then((function(a){var r=a.status;0==r&&(e.marker=i.marker,t.remarkDialog=!1)}))},handleQuery:function(){var t=this,e=this.deviceids,i=this.dateRange;if(0!=e.length)if(0!=i.length){"details"==this.activeName&&(this.activeName="tabTotal",this.totalList=[],this.detailsList=[]);var a=$["a"].format(i[0],"yyyy-MM-dd"),r=$["a"].format(i[1],"yyyy-MM-dd"),s={startday:a,endday:r,offset:$["a"].getOffset(),devices:e,oilstate:1,oilindex:Number(this.oilindex)};this.loading=!0,this.queryDetailDateRange=s.startday+"  "+s.endday,Object(k["db"])(s).then((function(e){var i=e.addressmap,s=e.records;t.loading=!1;var l=[],n=[];if(s){var c="".concat(a," - ").concat(r);s.forEach((function(e,a){a%4==0&&n.push({data:[],oil:[]});var r=n.length-1,s=e.deviceid,l=o["a"].deviceInfos[s],u=l.devicename,d=l.groupname;e.devicename=u,e.creater=o["a"].getShowName(l.creater),e.groupName=d,e.fuelCount=e.records.length,e.fuelVolume=0,e.dateStr=c,e.records.forEach((function(a){a.deviceid=s,a.devicename=u,a.oilIndexStr=Object(F["U"])(a.oilindex),a.eoil=a.eoil/100,a.soil=a.soil/100,a.oil=Math.abs(a.eoil-a.soil),a.begintimeStr=$["a"].longToLocalDateTimeStr(a.begintime),a.endtimeStr=$["a"].longToLocalDateTimeStr(a.endtime),a.address=Object(F["L"])(i,a.slat,a.slon),a.mauneditStr=0==a.maunedit?t.$t("header.no"):t.$t("header.yes"),e.fuelVolume+=a.oil})),n[r].data.push(u),n[r].oil.push(Number(e.fuelVolume.toFixed(2)))})),s.sort((function(t,e){var i=0;return i=e.fuelVolume-t.fuelVolume,0==i&&(i=e.devicename.localeCompare(t.devicename)),i})),l=s}t.totalList=l,t.chartList=n}))}else this.$XModal.message({message:this.$t("tips.selectTime"),status:"error",zIndex:9999});else this.$XModal.message({message:this.$t("tips.selectDevice"),status:"error",zIndex:9999})},exportData:function(){var t=[[this.$t("reportForm.index"),this.$t("alarm.devName"),this.$t("alarm.devNum"),this.$t("reportForm.time"),this.$t("reportForm.creater"),this.$t("reportForm.groupName"),this.$t("reportForm.fuelVolume"),this.$t("reportForm.count")]];if(0!=this.totalList.length){this.totalList.forEach((function(e,i){var a=[];a.push(i+1),a.push(e.devicename),a.push(e.deviceid),a.push(e.dateStr),a.push(e.creater),a.push(e.groupName),a.push(Object(F["qb"])(e.fuelVolume)),a.push(e.fuelCount),t.push(a)}));var e={title:this.$t("reportForm.fuelOil")+this.$t("common.summary"),data:t,dateRange:this.queryDetailDateRange};this.exportLoading1=!0,new ExcelCls(e).exportExcel(this)}},exportDetailData:function(){var t=this,e=[[this.$t("reportForm.index"),this.$t("alarm.devName"),this.$t("alarm.devNum"),this.$t("reportForm.oilIndex"),this.$t("reportForm.fuelVolume"),this.$t("reportForm.startOil"),this.$t("reportForm.endOil"),this.$t("reportForm.startTime"),this.$t("reportForm.endTime"),this.$t("reportForm.address"),this.$t("reportForm.threshold"),this.$t("reportForm.remarks"),this.$t("reportForm.artificialEdit"),this.$t("monitor.coordinate")]];if(0!=this.totalList.length){var i="",a=this.totalList.length;this.totalList.forEach((function(r,o){var s=r.records.length>0;r.records.forEach((function(t,r){1==a&&(i=t.devicename);var o=[];o.push(r+1),o.push(t.devicename),o.push(t.deviceid),o.push(t.oilIndexStr),o.push(Object(F["qb"])(t.oil)),o.push(Object(F["qb"])(t.soil)),o.push(Object(F["qb"])(t.eoil)),o.push(t.begintimeStr),o.push(t.endtimeStr),o.push(t.address?t.address:""),o.push(t.threshold),o.push(t.marker?t.marker:""),o.push(t.mauneditStr),o.push(t.slon+","+t.slat),e.push(o)}));var l=[];l.push(s?"":1),l.push(s?"":r.devicename),l.push(s?"":r.deviceid),l.push(t.$t("reportForm.total")),l.push(r.fuelVolume),l.push(""),l.push(""),l.push(""),l.push(""),l.push(""),l.push(""),l.push(""),l.push(""),l.push(""),e.push(l),l=[],l.push(""),l.push(""),l.push(""),l.push(""),l.push(""),l.push(""),l.push(""),l.push(""),l.push(""),l.push(""),l.push(""),l.push(""),l.push(""),l.push(""),e.push(l)}));var r={title:this.$t("reportForm.fuelOil")+this.$t("reportForm.detailed")+(i?" - "+i:""),data:e,dateRange:this.queryDetailDateRange};this.exportLoading2=!0,new ExcelCls(r).exportExcel(this)}}},mounted:function(){var t=this;this.deviceids=[],this.queryDetailDateRange=null,this.$nextTick((function(){t.oilIndexList=[{label:t.$t("reportForm.totalDriving"),value:"0"},{label:t.$t("reportForm.tank1"),value:"1"},{label:t.$t("reportForm.tank2"),value:"2"},{label:t.$t("reportForm.tank3"),value:"3"},{label:t.$t("reportForm.tank4"),value:"4"},{label:t.$t("reportForm.totalNotRun"),value:"99"}]}))}},T=_,L=(i("fdae"),Object(g["a"])(T,a,r,!1,null,null,null)),O=L.exports;e["default"]=O},ea22:function(t,e,i){"use strict";var a=function(){var t=this,e=t._self._c;return e("div",{staticClass:"multi-choice multi-choice-vehicle"},[e("div",{staticClass:"multi-choice-input"},[e("ZtreeDeviceDropdown",{ref:"ztreeDevice",attrs:{disableShare:t.disableShare,isCheck:"",placeholder:this.$t("tips.selectDevice"),isQueryInitData:t.isQueryInitData,selectDeviceIds:t.multipleDeviceids},on:{onTreeCheck:t.onTreeCheck}})],1)])},r=[],o=i("5530"),s=(i("4795"),i("2f62")),l=i("2df7"),n={name:"MultiChoiceVehicle",props:{disableShare:{type:Boolean,default:!1}},data:function(){return{}},computed:Object(o["a"])({},Object(s["b"])(["isQueryInitData","multipleDeviceids"])),components:{ZtreeDeviceDropdown:l["a"]},methods:Object(o["a"])(Object(o["a"])({},Object(s["c"])(["setMultipleDeviceids"])),{},{onTreeCheck:function(t){this.$emit("onSelectDevice",t),this.setMultipleDeviceids(t)},clearText:function(){var t=this;setTimeout((function(){t.$refs.ztreeDevice.clearText()}),300)}})},c=n,u=(i("7031"),i("2877")),d=Object(u["a"])(c,a,r,!1,null,null,null);e["a"]=d.exports},fdae:function(t,e,i){"use strict";i("7c2e")}}]);