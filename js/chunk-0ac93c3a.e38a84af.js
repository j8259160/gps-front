(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0ac93c3a"],{"0a2e":function(e,t,i){"use strict";i("3aa2")},"3aa2":function(e,t,i){},6706:function(e,t,i){"use strict";i("8be6")},"8be6":function(e,t,i){},"8ecb":function(e,t,i){"use strict";var a=function(){var e=this,t=e._self._c;return t("vxe-modal",{attrs:{title:e.$t("bgManage.batchSetDeviceExpiration"),className:"vxe-modal-visible modal-padding0",value:e.value,width:"366px"},on:{hide:e.handleClose,close:e.handleClose}},[t("div",[e.isZh?t("el-row",{staticClass:"renew-row"},[t("el-col",{staticClass:"renew-col-label",attrs:{span:8}},[e._v(" "+e._s(e.$t("missing.selectedDevice"))+": ")]),t("el-col",{staticClass:"renew-col-value",attrs:{span:4}},[t("b",[t("span",{domProps:{textContent:e._s(e.tableList.length)}})])])],1):e._e(),t("el-row",{staticClass:"renew-row"},[t("el-col",{staticClass:"renew-col-label",staticStyle:{"text-align":"left","padding-left":"30px"},attrs:{offset:2,span:10}},[t("el-radio",{attrs:{label:0},model:{value:e.radio,callback:function(t){e.radio=t},expression:"radio"}},[e._v(" "+e._s(e.$t("bgManage.specifyDate")))])],1),t("el-col",{staticClass:"renew-col-value",attrs:{span:9}},[t("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date","picker-options":e.unicoPickerOptions,clearable:!1},model:{value:e.date,callback:function(t){e.date=t},expression:"date"}})],1)],1),t("el-row",{staticClass:"renew-row"},[t("el-col",{staticClass:"renew-col-label",staticStyle:{"text-align":"left","padding-left":"30px"},attrs:{offset:2,span:10}},[t("el-radio",{attrs:{label:2},model:{value:e.radio,callback:function(t){e.radio=t},expression:"radio"}},[e._v(" "+e._s(e.$t("bgManage.increaseDay")))])],1),t("el-col",{staticClass:"renew-col-value",attrs:{span:9}},[t("el-input-number",{staticStyle:{width:"100%"},attrs:{"controls-position":"right",min:1,max:365},model:{value:e.addDays,callback:function(t){e.addDays=t},expression:"addDays"}})],1)],1),t("el-row",{staticClass:"renew-row"},[t("el-col",{staticClass:"renew-col-label",staticStyle:{"text-align":"left","padding-left":"30px"},attrs:{offset:2,span:10}},[t("el-radio",{attrs:{label:3},model:{value:e.radio,callback:function(t){e.radio=t},expression:"radio"}},[e._v(" "+e._s(e.$t("bgManage.reduceDay")))])],1),t("el-col",{staticClass:"renew-col-value",attrs:{span:9}},[t("el-input-number",{staticStyle:{width:"100%"},attrs:{"controls-position":"right",min:1,max:365},model:{value:e.reduceDays,callback:function(t){e.reduceDays=t},expression:"reduceDays"}})],1)],1),t("el-row",{staticClass:"renew-row"},[t("el-col",{staticClass:"renew-col-label",staticStyle:{"text-align":"left","padding-left":"30px"},attrs:{offset:2,span:10}},[t("el-radio",{attrs:{label:1},model:{value:e.radio,callback:function(t){e.radio=t},expression:"radio"}},[e._v(" "+e._s(e.$t("bgManage.syncPlatformExpirationDate")))])],1)],1),t("el-row",{staticStyle:{margin:"20px 0px 10px 0px"}},[t("el-col",{attrs:{span:8,offset:8}},[t("el-button",{staticStyle:{width:"100%"},attrs:{type:"primary",loading:e.loading},on:{click:e.batchOperate}},[e._v(e._s(e.$t("common.submitSave")))])],1)],1)],1)])},s=[],o=i("5530"),c=(i("d81d"),i("a9e3"),i("d3b7"),i("159b"),i("5867")),r=i("e285"),l=i("6e52"),n=i("2f62"),d=i("5101"),p={name:"ExpireTimeDialog",props:{value:{type:Boolean,default:!1},tableList:{type:Array,default:function(){return[]}}},mixins:[c["a"]],data:function(){return{loading:!1,radio:0,date:new Date(new Date(d["a"].format(new Date,"yyyy-MM-dd")).getTime()+31536e6),addDays:30,reduceDays:30}},computed:Object(o["a"])({},Object(n["b"])(["isZh"])),methods:{handleClose:function(){this.$emit("input",!1),this.loading&&(this.loading=!0)},batchOperate:function(){var e=this,t=this.tableList.map((function(e){var t=e.deviceid;return t}));if(t.length>0){var i={deviceids:t,action:"modifyexpiretime"};switch(this.radio){case 0:i.modifyexpiretimetype="expiretime",i.expiretime=this.date.getTime();break;case 1:i.modifyexpiretimetype="syncoverduetime";break;case 2:i.modifyexpiretimetype="diffday",i.diffday=Number(this.addDays);break;case 3:i.modifyexpiretimetype="diffday",i.diffday=-Number(this.reduceDays);break}this.loading=!0,Object(r["m"])(i).then((function(t){var a=t.status,s=t.successrecords,o=t.cause;0==a?(s.forEach((function(e){var t=e.device,i=e.deviceid,a=l["a"].deviceInfos[i];a.expirenotifytime=t.expirenotifytime,a.isfree=t.isfree})),e.$XModal.message({message:e.$t("tips.saveSucc"),status:"success",zIndex:9999}),e.$emit("onRenewSucc",i),e.handleClose()):e.$XModal.message({message:e.$t("tips.saveFail")+":"+o,status:"error",zIndex:9999})})).finally((function(){e.loading=!1}))}else this.$XModal.message({message:this.$t("tips.selectDevice"),status:"error",zIndex:9999})}}},m=p,u=(i("6706"),i("2877")),h=Object(u["a"])(m,a,s,!1,null,null,null);t["a"]=h.exports},ebbc:function(e,t,i){"use strict";i.r(t);i("c975");var a=function(){var e=this,t=e._self._c;return t("div",{staticClass:"expire-mgr full"},[t("div",{staticClass:"expire-mgr-left"},[t("div",{staticClass:"expire-mgr-left-title"},[t("i",{staticClass:"circle"}),t("b",[e._v(e._s(e.$t("common.selectDevice")))]),t("input",{staticStyle:{display:"none"},attrs:{type:"file",id:"import-add-file"}})]),t("div",{staticClass:"expire-mgr-left-content"},[t("SearchDeviceZtree",{ref:"deviceZtree",attrs:{showClear:""},on:{onTreeCheck:e.onTreeCheck}})],1)]),t("div",{staticClass:"expire-mgr-right"},[t("div",{staticStyle:{position:"absolute",top:"0px",left:"0px",right:"0px","z-index":"999","border-right":"1px solid #e4e7ed","border-left":"1px solid #e4e7ed","border-top":"1px solid #e4e7ed","overflow-x":"auto","overflow-y":"hidden"}},[t("div",{staticClass:"expire-mgr-right-title"},[t("div",{staticClass:"f_left radio-wrap2",staticStyle:{width:"120px"}},[t("div",[t("div",{staticStyle:{"padding-left":"10px"},on:{click:function(t){return e.handleSelectRadio("0")}}},[t("el-radio",{attrs:{label:"0"},model:{value:e.radio,callback:function(t){e.radio=t},expression:"radio"}},[e._v(e._s(e.$t("monitor.all"))+"("+e._s(e.totalCount)+")")])],1),t("div",{staticStyle:{"padding-left":"10px"},on:{click:function(t){return e.handleSelectRadio("-2")}}},[t("el-radio",{attrs:{label:"-2"},model:{value:e.radio,callback:function(t){e.radio=t},expression:"radio"}},[e._v(e._s(e.$t("common.notActive"))+"("+e._s(e.notActiveCount)+")")])],1)])]),t("div",{staticClass:"f_left radio-title"},[t("div",[e._v(e._s(e.$t("bgManage.dueSoon")))])]),t("div",{staticClass:"f_left radio-wrap4"},[t("div",{staticStyle:{"padding-top":"14px"}},[t("div",{on:{click:function(t){return e.handleSelectRadio("30")}}},[t("el-radio",{attrs:{label:"30"},model:{value:e.radio,callback:function(t){e.radio=t},expression:"radio"}},[e._v(e._s(e.$t("common.within30Days"))+"("+e._s(e.effective30)+")")])],1),t("div",{on:{click:function(t){return e.handleSelectRadio("60")}}},[t("el-radio",{attrs:{label:"60"},model:{value:e.radio,callback:function(t){e.radio=t},expression:"radio"}},[e._v(e._s(e.$t("common.within60Days"))+"("+e._s(e.effective60)+")")])],1),t("div",{on:{click:function(t){return e.handleSelectRadio("90")}}},[t("el-radio",{attrs:{label:"90"},model:{value:e.radio,callback:function(t){e.radio=t},expression:"radio"}},[e._v(e._s(e.$t("common.within90Days"))+"("+e._s(e.effective90)+")")])],1)])]),t("div",{staticClass:"f_left radio-title"},[t("div",[e._v(e._s(e.$t("device.expired")))])]),t("div",{staticClass:"f_left radio-wrap4"},[t("div",{staticStyle:{"padding-top":"4px"}},[t("div",{on:{click:function(t){return e.handleSelectRadio("-30")}}},[t("el-radio",{attrs:{label:"-30"},model:{value:e.radio,callback:function(t){e.radio=t},expression:"radio"}},[e._v(e._s(e.$t("common.within30Days"))+"("+e._s(e.invalid30)+")")])],1),t("div",{on:{click:function(t){return e.handleSelectRadio("-60")}}},[t("el-radio",{attrs:{label:"-60"},model:{value:e.radio,callback:function(t){e.radio=t},expression:"radio"}},[e._v(e._s(e.$t("common.within60Days"))+"("+e._s(e.invalid60)+")")])],1),t("div",{on:{click:function(t){return e.handleSelectRadio("-90")}}},[t("el-radio",{attrs:{label:"-90"},model:{value:e.radio,callback:function(t){e.radio=t},expression:"radio"}},[e._v(e._s(e.$t("common.within90Days"))+"("+e._s(e.invalid90)+")")])],1),t("div",{on:{click:function(t){return e.handleSelectRadio("-91")}}},[t("el-radio",{attrs:{label:"-91"},model:{value:e.radio,callback:function(t){e.radio=t},expression:"radio"}},[e._v(e._s(e.$t("common.exceed90Days"))+"("+e._s(e.exceed90)+")")])],1)])]),t("div",{staticClass:"f_left",staticStyle:{"margin-left":"10px"}},[t("div",{staticClass:"hover-btn",staticStyle:{"margin-top":"4px"}},[t("el-button",{staticClass:"other",attrs:{type:"primary"},on:{click:e.handleSettingDate}},[e._v(e._s(e.$t("bgManage.setOverdueTime")))])],1),t("div",{staticClass:"hover-btn",staticStyle:{"margin-top":"4px"}},[t("el-button",{staticClass:"other",staticStyle:{width:"94px"},attrs:{type:"primary"},on:{click:e.dwonloadTemp}},[e._v(e._s(e.$t("insure.templateDownload")))])],1),t("div",{staticClass:"hover-btn",staticStyle:{"margin-top":"4px"}},[t("el-button",{staticClass:"other",staticStyle:{padding:"0 2.5px"},attrs:{type:"primary"},on:{click:e.importDevicesExcel}},[t("span",{staticStyle:{"font-size":"11px"}},[e._v(" "+e._s(e.$t("common.importExpiretime")))])])],1)]),t("div",{staticClass:"f_left",staticStyle:{padding:"0px 0px 0px 10px"}},[t("div",{staticClass:"hover-btn",staticStyle:{"margin-top":"4px"}},[t("el-button",{staticClass:"other",staticStyle:{width:"94px"},attrs:{type:"primary"},on:{click:function(t){e.importDialog=!0}}},[e._v(e._s(e.$t("common.importQuery")))])],1),t("div",{staticClass:"hover-btn",staticStyle:{"margin-top":"4px"}},[t("el-popover",{attrs:{placement:"bottom",width:"236",trigger:"click"}},[t("div",[t("el-button",{staticStyle:{width:"100px"},attrs:{type:"primary",size:"mini",plain:"",loading:e.exportLoading1},on:{click:e.exportAllData}},[e._v(e._s(e.$t("monitor.all")))]),t("el-button",{staticStyle:{width:"100px"},attrs:{type:"primary",size:"mini",plain:"",loading:e.exportLoading2},on:{click:e.exportData}},[e._v(e._s(e.$t("missing.checked")))])],1),t("el-button",{staticClass:"other",staticStyle:{width:"94px"},attrs:{slot:"reference",type:"primary",size:"mini"},slot:"reference"},[e._v(e._s(e.$t("common.exportData")))])],1)],1),t("div",{staticClass:"hover-btn",staticStyle:{"padding-top":"4px"}},[t("el-button",{staticClass:"other",staticStyle:{width:"94px"},attrs:{type:"primary"},on:{click:e.clearTable}},[e._v(e._s(e.$t("common.clearList")))])],1)])])]),t("div",{staticClass:"expire-mgr-right-table",staticStyle:{bottom:"40px"}},[t("vxe-table",{ref:"xTable",attrs:{"sort-config":e.sortConfig,"menu-config":e.tableMenu,"cell-class-name":e.getActonStatusClassName,"auto-resize":"",border:"",resizable:"","show-overflow":"","highlight-hover-row":"","highlight-current-row":"",size:"mini",height:"auto",data:e.tableList},on:{"menu-click":e.handleClickTableMenu,"checkbox-all":e.selectAllEvent,"checkbox-change":e.selectChangeEvent,"cell-click":e.cellclick,"filter-change":e.onFilterChange,"cell-dblclick":e.cellDblclick}},[t("vxe-table-column",{attrs:{type:"checkbox",width:"50"}}),t("vxe-table-column",{attrs:{type:"seq",width:"60",title:e.$t("reportForm.index")}}),t("vxe-table-column",{attrs:{field:"devicename",width:"140",title:e.$t("alarm.devName"),sortable:""}}),t("vxe-table-column",{attrs:{field:"deviceid",width:"140",title:e.$t("alarm.devNum"),sortable:""}}),t("vxe-table-column",{attrs:{field:"simnum",title:e.$t("common.simnum"),sortable:"",width:"140"}}),t("vxe-table-column",{attrs:{field:"roleStr",title:e.$t("bgManage.useState"),sortable:"",width:"115"}}),e.isHasRecharge?t("vxe-table-column",{attrs:{field:"overdueTime",title:e.$t("alarm.overdueTime"),width:"110",sortable:""}}):e._e(),t("vxe-table-column",{attrs:{field:"expirenotifyTime",title:e.$t("alarm.expireTime"),width:"110",sortable:""}}),t("vxe-table-column",{attrs:{field:"firstloctimeStr",title:e.$t("bgManage.firstloctimeStr"),width:"125",sortable:""}}),t("vxe-table-column",{attrs:{field:"lastValidpoistiontime",title:e.$t("bgManage.lastOnlineTime"),width:"110",sortable:""}}),t("vxe-table-column",{attrs:{field:"initloctimeStr",title:e.$t("reportForm.initLocTime"),width:"130",sortable:""}}),t("vxe-table-column",{attrs:{field:"createTime",title:e.$t("alarm.createTime"),width:"125",sortable:""}}),t("vxe-table-column",{attrs:{field:"deviceType",filters:e.typeOptions,"filter-multiple":!1,"filter-method":e.filterTypeMethod,sortable:"",title:e.$t("reportForm.deviceType"),width:"115"}}),e.isHasDeviceTag?t("vxe-table-column",{attrs:{field:"devicetag",title:e.$t("monitor.deviceTag"),filters:e.tagOptions,"filter-multiple":!1,"filter-method":e.filterTagMethod,width:"110",sortable:""}}):e._e(),t("vxe-table-column",{attrs:{field:"creater",width:"140",title:e.$t("reportForm.creater"),sortable:""}}),t("vxe-table-column",{attrs:{field:"groupname",width:"120",title:e.$t("reportForm.groupName"),sortable:""}}),t("vxe-table-column",{attrs:{field:"simiccid",title:"ICCID",width:"140",sortable:""}}),e.permissionList.indexOf("monitor-viewsimdetail")>-1?t("vxe-table-column",{attrs:{title:e.$t("common.simDetail"),width:"85"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("el-button",{attrs:{type:"text"},on:{click:function(t){return e.handleSeeSim(i)}}},[e._v(e._s(e.$t("common.see")))])]}}],null,!1,1974703607)}):e._e(),t("vxe-table-column",{attrs:{field:"packagesStr",sortable:"",title:e.$t("systemManage.packages"),width:"200"}})],1)],1),t("div",{staticStyle:{position:"absolute",left:"0px",right:"0px",bottom:"0px",height:"40px","padding-top":"8px"}},[t("div",{staticStyle:{float:"left","line-height":"28px"}},[t("span",{staticStyle:{"font-size":"14px",color:"#409eff"}},[e._v(" "+e._s(e.$t("missing.checked"))+e._s(e.selectList.length))])]),t("div",{staticStyle:{float:"left"}},[t("el-pagination",{attrs:{"current-page":e.currentPage,"page-sizes":[10,20,30,40,50,100,200,500],"page-size":e.pageSize,layout:"sizes, prev, pager, next",total:e.tableTotal},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange,"update:currentPage":function(t){e.currentPage=t},"update:current-page":function(t){e.currentPage=t}}})],1)])]),t("ExpireTimeDialog",{attrs:{tableList:e.selectList},on:{onRenewSucc:e.onRenewSucc},model:{value:e.expireDialog,callback:function(t){e.expireDialog=t},expression:"expireDialog"}}),t("ImportDeviceidsDialog",{on:{"on-import":e.onImportDevice},model:{value:e.importDialog,callback:function(t){e.importDialog=t},expression:"importDialog"}}),t("CustomerServiceDialog",{model:{value:e.serviceDialog,callback:function(t){e.serviceDialog=t},expression:"serviceDialog"}}),t("EditDevice",{attrs:{deviceid:e.deviceid,info:e.currentRow},on:{editSucc:e.onEditSucc},model:{value:e.editDialog,callback:function(t){e.editDialog=t},expression:"editDialog"}}),t("TransferDeviceDialog",{attrs:{selectList:e.selectList},on:{transferSucc:e.transferSucc},model:{value:e.transferDialog,callback:function(t){e.transferDialog=t},expression:"transferDialog"}}),t("ImportDeviceDialog",{ref:"importDevice",on:{importSucc:e.onImportSucc},model:{value:e.importDeviceDialog,callback:function(t){e.importDeviceDialog=t},expression:"importDeviceDialog"}}),t("NotFindDialog",{ref:"notFind",model:{value:e.notFindDialog,callback:function(t){e.notFindDialog=t},expression:"notFindDialog"}})],1)},s=[],o=i("5530"),c=(i("99af"),i("caad"),i("baa5"),i("14d9"),i("fb6a"),i("4e82"),i("a434"),i("a9e3"),i("b64b"),i("d3b7"),i("07ac"),i("2532"),i("498a"),i("159b"),i("4795"),i("2f62")),r=i("8ecb"),l=function(){var e=this,t=e._self._c;return t("vxe-modal",{attrs:{value:e.value,className:"modal-padding0",width:"320px"},on:{hide:e.handleClose,close:e.handleClose}},[t("template",{slot:"title"},[t("span",{staticStyle:{color:"red"},domProps:{textContent:e._s(e.$t("tips.contactRenewTip"))}})]),t("div",{staticClass:"margin_b10"},[t("el-row",[t("el-col",{attrs:{span:6}},[t("div",{staticStyle:{padding:"5px 0px 0px 10px"}},[e._v(e._s(e.$t("common.name"))+":")])]),t("el-col",{attrs:{span:12}},[t("div",{staticStyle:{padding:"5px 0px 0px 10px"}},[t("span",{staticStyle:{"padding-right":"6px"},domProps:{textContent:e._s(e.myInfo.creatername)}}),t("i",{staticClass:"el-icon-document-copy",staticStyle:{"font-size":"14px",cursor:"pointer"},on:{click:function(t){return e.handleClick(e.myInfo.creatername)}}})])])],1)],1),t("div",{staticClass:"margin_b10"},[t("el-row",[t("el-col",{attrs:{span:6}},[t("div",{staticStyle:{padding:"5px 0px 0px 10px"}},[e._v(e._s(e.$t("common.email"))+":")])]),t("el-col",{attrs:{span:12}},[t("div",{staticStyle:{padding:"5px 0px 0px 10px"}},[t("span",{staticStyle:{"padding-right":"6px"},domProps:{textContent:e._s(e.myInfo.createremail)}}),t("i",{staticClass:"el-icon-document-copy",staticStyle:{"font-size":"14px",cursor:"pointer"},on:{click:function(t){return e.handleClick(e.myInfo.createremail)}}})])])],1)],1),t("div",{staticClass:"margin_b10"},[t("el-row",[t("el-col",{attrs:{span:6}},[t("div",{staticStyle:{padding:"5px 0px 0px 10px"}},[e._v(e._s(e.$t("common.phone"))+":")])]),t("el-col",{attrs:{span:12}},[t("div",{staticStyle:{padding:"5px 0px 0px 10px"}},[t("span",{staticStyle:{"padding-right":"6px"},domProps:{textContent:e._s(e.myInfo.createrphone)}}),t("i",{staticClass:"el-icon-document-copy",staticStyle:{"font-size":"14px",cursor:"pointer"},on:{click:function(t){return e.handleClick(e.myInfo.createrphone)}}})])])],1)],1),t("div",{staticClass:"margin_b10"},[t("el-row",[t("el-col",{attrs:{span:6}},[t("div",{staticStyle:{padding:"5px 0px 0px 10px"}},[e._v(e._s(e.$t("common.wechat"))+":")])]),t("el-col",{attrs:{span:12}},[t("div",{staticStyle:{padding:"5px 0px 0px 10px"}},[t("span",{staticStyle:{"padding-right":"6px"},domProps:{textContent:e._s(e.myInfo.createrwechat)}}),t("i",{staticClass:"el-icon-document-copy",staticStyle:{"font-size":"14px",cursor:"pointer"},on:{click:function(t){return e.handleClick(e.myInfo.createrwechat)}}})])])],1)],1)],2)},n=[],d=i("201d"),p={name:"CustomerServiceDialog",props:{value:{type:Boolean,default:!1}},data:function(){return{}},computed:Object(o["a"])({},Object(c["b"])(["myInfo"])),components:{LabelWrap:d["a"]},methods:{handleClose:function(){this.$emit("input",!1)},handleClick:function(e){window.onClikCopyDevice(e)}}},m=p,u=i("2877"),h=Object(u["a"])(m,l,n,!1,null,null,null),v=h.exports,f=function(){var e=this,t=e._self._c;return t("vxe-modal",{attrs:{title:e.$t("bgManage.batchSetDeviceExpiration"),className:"vxe-modal-visible modal-padding0",value:e.value,width:"666px"},on:{hide:e.handleClose,close:e.handleClose}},[t("div",[t("div",[t("vxe-table",{ref:"xTable",attrs:{"cell-class-name":e.getActonStatusClassName,"auto-resize":"",border:"",resizable:"","show-overflow":"","highlight-hover-row":"","highlight-current-row":"",size:"mini",height:"400",data:e.tableList}},[t("vxe-table-column",{attrs:{type:"seq",width:"60",title:e.$t("reportForm.index")}}),t("vxe-table-column",{attrs:{field:"devicename",width:"140",title:e.$t("alarm.devName"),sortable:""}}),t("vxe-table-column",{attrs:{field:"deviceid",width:"140",title:e.$t("alarm.devNum"),sortable:""}}),t("vxe-table-column",{attrs:{field:"expirenotifyTime",title:e.$t("alarm.expireTime"),sortable:""}}),t("vxe-table-column",{attrs:{field:"adjustExpirenotifyTime",title:e.$t("common.adjustExpirenotifyTime"),sortable:""}})],1)],1),t("el-row",{staticStyle:{margin:"20px 0px 10px 0px"}},[t("el-col",{attrs:{span:8,offset:8}},[t("el-button",{staticStyle:{width:"100%"},attrs:{type:"primary",loading:e.loading},on:{click:e.batchOperate}},[e._v(e._s(e.$t("common.submitSave")))])],1)],1)],1)])},g=[],x=i("e285"),b=i("6e52"),y=i("c276"),D={name:"ImportDeviceDialog",props:{value:{type:Boolean,default:!1}},data:function(){return{loading:!1,tableList:[]}},computed:Object(o["a"])({},Object(c["b"])(["isZh"])),methods:{getActonStatusClassName:y["n"],setTableList:function(e){this.tableList=e},handleClose:function(){this.$emit("input",!1)},batchOperate:function(){var e=this,t=[],i=[];if(this.tableList.forEach((function(e){e.adjustExpirenotifyTime&&(t.push(e.deviceid),i.push(new Date(e.adjustExpirenotifyTime).getTime()))})),t.length>0){var a={deviceids:t,matchtime:i,action:"modifyexpiretime",modifyexpiretimetype:"matchtime"};this.loading=!0,Object(x["m"])(a).then((function(t){var i=t.status,s=t.successrecords,o=t.cause;0==i?(s.forEach((function(e){var t=e.device,i=e.deviceid,a=b["a"].deviceInfos[i];a.expirenotifytime=t.expirenotifytime,a.isfree=t.isfree})),e.$XModal.message({message:e.$t("tips.saveSucc"),status:"success",zIndex:9999}),e.$emit("importSucc",a),e.handleClose()):e.$XModal.message({message:e.$t("tips.saveFail")+":"+o,status:"error",zIndex:9999})})).finally((function(){e.loading=!1}))}else this.$XModal.message({message:this.$t("tips.selectDevice"),status:"error",zIndex:9999})}}},w=D,S=Object(u["a"])(w,f,g,!1,null,null,null),$=S.exports,k=i("5bca"),T=i("8913"),C=i("ae31"),_=i("7e15"),M=i("f1b2"),L=i("5101"),E=i("a05b"),I=i("4c3c"),O=i("b562"),j=i("7cf8"),F=i("e173"),R={name:"DeviceExpire",data:function(){return{totalColumns:["creater","groupname","devicename","deviceid","simnum","deviceType","roleStr","overdueTime","expirenotifyTime","lastValidpoistiontime","initloctimeStr","firstloctimeStr","createTime","simiccid"],deleteIcon:F,radio:"0",exportLoading1:!1,exportLoading2:!1,expireDialog:!1,importDialog:!1,serviceDialog:!1,transferDialog:!1,tableList:[],selectList:[],editDialog:!1,notFindDialog:!1,importDeviceDialog:!1,deviceid:"",currentRow:{},totalCount:0,notActiveCount:0,notRecharged:0,effective30:0,effective60:0,effective90:0,invalid30:0,invalid60:0,invalid90:0,exceed90:0,currentPage:1,pageSize:200,tableTotal:0,typeOptions:[],tagOptions:[]}},mixins:[E["a"],I["a"]],components:{SearchDeviceZtree:_["a"],ExpireTimeDialog:r["a"],ImportDeviceidsDialog:k["a"],CustomerServiceDialog:v,EditDevice:M["a"],TransferDeviceDialog:C["a"],ImportDeviceDialog:$,NotFindDialog:T["a"]},computed:Object(o["a"])(Object(o["a"])({},Object(c["b"])(["isZh","deviceTypes","permissionList"])),{},{userType:function(){return this.$store.state.user.userType},isHasRecharge:function(){return-1!=this.permissionList.indexOf("manage-manageoverdue-recharge")},isHasDeviceTag:function(){return this.permissionList.includes("monitor-editdevice-viewdevicetag")}}),watch:{expireDialog:function(e){if(0==e){var t=this.$refs.xTable.getCheckboxRecords();this.selectList=t}}},methods:{getActonStatusClassName:y["n"],importDevicesExcel:function(){var e=this.fileEl;e.value="",e.click()},dwonloadTemp:function(){var e=document.createElement("a");e.href=this.isZh?"./xlsxtemplates/expiretime.xlsx":"./xlsxtemplates/expiretime_en.xlsx",e.download="expiretime.xlsx",e.click()},filterTypeMethod:function(e){var t=e.value,i=e.row;return t==i.devicetype},filterTagMethod:function(e){var t=e.value,i=e.row;return t==i.devicetag},onFilterChange:function(){var e=this,t=this.$refs.xTable.getTableData(),i=t.visibleData;setTimeout((function(){e.$refs.xTable.setAllCheckboxRow(!0),e.selectList=i}),30)},setTypeOptions:function(e){var t=this.$i18n.locale,i=[],a={},s=this.deviceTypes,o={},c=e.concat([]);c.sort((function(e,t){return e.devicetype-t.devicetype})),c.forEach((function(e){var c=e.devicetag;c&&(a[c]||(a[c]={label:c,value:c}));var r=e.devicetype;if(void 0==o[r]){o[r]=1;var l=s[r];i.push({label:l.typename+"-"+("zh"==t?l.remark:l.remarken),typename:l.typename,value:l.devicetypeid})}else o[r]++})),i.forEach((function(e){e.label+="("+o[e.value]+")"})),this.typeOptions=i,this.tagOptions=Object.values(a)},clearTable:function(){this.tableList=[],this.$refs.deviceZtree.checkAllNodes(!1)},transferSucc:function(){var e=this.tableList;this.$refs.deviceZtree.updateZtreeIns(),this.selectList.forEach((function(t){for(var i=t.deviceid,a=0;a<e.length;a++){var s=e[a];if(s.deviceid==i){s=b["a"].deviceInfos[i],t.creater=s.creater,t.groupname=s.groupname;break}}}))},handleSeeSim:function(e){var t=this,i=e.row.deviceid,a=this.$loading({lock:!0,text:this.$t("missing.loading"),spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"});Object(j["V"])(i).then((function(e){var i=e.status,a=e.accessurl;if(0==i){var s=document.createElement("a");s.setAttribute("target","_blank"),s.href=a,s.click()}else 1==i?t.$XModal.message({message:t.$t("tips.noPermission"),status:"success",zIndex:9999}):2==i?t.$XModal.message({message:t.$t("tips.deviceNotIncludedSim"),status:"success",zIndex:9999}):3==i&&t.$XModal.message({message:t.$t("tips.notFoundSim"),status:"success",zIndex:9999})})).finally((function(){a.close()}))},handleSelectRadio:function(e){this.setTableList(e)},handleSizeChange:function(e){this.pageSize=e,this.splitCacheToTableList()},handleCurrentChange:function(){this.splitCacheToTableList()},splitCacheToTableList:function(){var e=this,t=this.currentPage-1,i=this.pageSize,a=t*i;this.tableList=this.cacheList.slice(a,a+i),this.$refs.xTable.scrollTo(0,0),setTimeout((function(){e.$refs.xTable.setAllCheckboxRow(!0),e.selectList=e.tableList}),30)},cellclick:function(e){var t=e.row,i=t.isfree;5==i&&(this.serviceDialog=!0)},onEditSucc:function(e){var t=b["a"].deviceInfos[e.deviceid];t.offlinedelay=e.offlinedelay,this.row.devicename=e.devicename,this.$refs.deviceZtree.updateNodes([e.deviceid])},cellDblclick:function(e){var t=e.column,i=e.row;"devicename"==t.property&&(this.row=i,this.currentRow={creater:i.creater},this.deviceid=i.deviceid,this.editDialog=!0)},handleSettingDate:function(){this.expireDialog=!0},selectAllEvent:function(e){e.checked;var t=e.records;this.selectList=t},selectChangeEvent:function(e){e.checked;var t=e.records;this.selectList=t},handleDelete:function(e){var t=e.rowIndex,i=e.row.deviceid;this.$delete(this.tableList,t);var a=[];this.cacheDeviceids.forEach((function(e){e!=i&&a.push(e)})),this.cacheDeviceids=a,this.$refs.deviceZtree.cancelCheckNode(i),this.calcStateCount()},exportAllData:function(){if(0!=this.cacheDeviceids.length){var e=this.isHasDeviceTag,t=this.isHasRecharge,i=[[this.$t("reportForm.index"),this.$t("reportForm.creater"),this.$t("reportForm.groupName"),this.$t("alarm.devName"),this.$t("alarm.devNum"),this.$t("common.simnum"),this.$t("reportForm.deviceType"),this.$t("monitor.deviceTag"),this.$t("systemManage.packages"),this.$t("bgManage.useState"),this.$t("alarm.createTime"),this.$t("reportForm.initLocTime"),this.$t("bgManage.firstloctimeStr"),this.$t("bgManage.lastOnlineTime")]];0==e&&i[0].splice(7,1),t?(i[0].push(this.$t("alarm.overdueTime")),i[0].push(this.$t("alarm.expireTime")),i[0].push("ICCID")):(i[0].push(this.$t("alarm.expireTime")),i[0].push("ICCID"));var a=this.packages,s=this.deviceTypes,o=b["a"].deviceInfos;this.cacheDeviceids.forEach((function(e,c){var r=o[e],l=s[r.devicetype],n=l.typename,d=L["a"].format(new Date(r.createtime),"yyyy-MM-dd"),p=0!=r.initloctime?L["a"].format(new Date(r.initloctime),"yyyy-MM-dd"):"-",m=0!=r.firstloctime?L["a"].format(new Date(r.firstloctime),"yyyy-MM-dd"):"-",u=0!=r.lastactivetime?L["a"].format(new Date(r.lastactivetime),"yyyy-MM-dd"):"-",h=Object(y["X"])(r),v=0==r.expirenotifytime?"-":L["a"].format(new Date(r.expirenotifytime),"yyyy-MM-dd");Object(y["tb"])(r,a,r.packageids);var f=[];f.push(c+1),f.push(r.creater),f.push(r.groupname),f.push(r.devicename),f.push(r.deviceid),f.push(r.simnum?r.simnum:""),f.push(n),f.push(r.devicetag),f.push(r.packagesStr),f.push(Object(y["u"])(r.isfree).stateStr),f.push(d),f.push(p),f.push(m),f.push(u),t&&f.push(h),f.push(v),f.push(r.simiccid?r.simiccid:""),i.push(f)}));var c={title:this.$t("bgManage.deviceExpire"),data:i,exportMaxLength:1e5};this.exportLoading1=!0,new ExcelCls(c).exportExcel(this)}},exportData:function(){if(0!=this.tableList.length){var e=this.isHasDeviceTag,t=this.isHasRecharge,i=this.$refs.xTable.getTableData().visibleData,a=[[this.$t("reportForm.index"),this.$t("reportForm.creater"),this.$t("reportForm.groupName"),this.$t("alarm.devName"),this.$t("alarm.devNum"),this.$t("common.simnum"),this.$t("reportForm.deviceType"),this.$t("monitor.deviceTag"),this.$t("systemManage.packages"),this.$t("bgManage.useState"),this.$t("alarm.createTime"),this.$t("reportForm.initLocTime"),this.$t("bgManage.firstloctimeStr"),this.$t("bgManage.lastOnlineTime")]];0==e&&a[0].splice(7,1),t?(a[0].push(this.$t("alarm.overdueTime")),a[0].push(this.$t("alarm.expireTime")),a[0].push("ICCID")):(a[0].push(this.$t("alarm.expireTime")),a[0].push("ICCID")),i.forEach((function(i,s){var o=[];o.push(s+1),o.push(i.creater),o.push(i.groupname),o.push(i.devicename),o.push(i.deviceid),o.push(i.simnum?i.simnum:""),o.push(i.deviceType),e&&o.push(i.devicetag),o.push(i.packagesStr),o.push(Object(y["u"])(i.isfree).stateStr),o.push(i.createTime),o.push(i.initloctimeStr),o.push(i.firstloctimeStr),o.push(i.lastValidpoistiontime),t&&o.push(i.overdueTime),o.push(i.expirenotifyTime),o.push(i.simiccid?i.simiccid:""),a.push(o)}));var s={title:this.$t("bgManage.deviceExpire"),data:a,exportMaxLength:1e5};this.exportLoading2=!0,new ExcelCls(s).exportExcel(this)}},onImportDevice:function(e){this.radio="0";var t=[],i=[],a=b["a"].deviceInfos,s=Object(y["t"])(a),o=s.simMap,c=s.iccidMap;e.forEach((function(e){var s=Object(y["ob"])(a,o,c,e);s?t.push(s.deviceid):i.push(e)})),this.cacheDeviceids=t,this.calcStateCount(),this.setTableList(this.radio),i.length>0&&(this.notFindDialog=!0,this.$refs.notFind.setDeviceids(this.$t("tips.deviceNotFound"),i))},onRenewSucc:function(e){this.calcStateCount();var t=[];this.tableList.forEach((function(e){var i=b["a"].deviceInfos[e.deviceid];e.isfree=i.isfree,e.expirenotifyTime=L["a"].format(new Date(i.expirenotifytime),"yyyy-MM-dd"),t.push(e)})),this.cacheList.forEach((function(e){var t=b["a"].deviceInfos[e.deviceid];e.isfree=t.isfree,e.expirenotifytime=t.expirenotifytime,e.expirenotifyTime=L["a"].format(new Date(t.expirenotifytime),"yyyy-MM-dd")})),this.tableList=t,this.$refs.deviceZtree.updateNodes(e.deviceids)},onImportSucc:function(e){var t=this,i=e.deviceids,a=this.packages,s=[],o=this.deviceTypes;i.forEach((function(e){var i=b["a"].deviceInfos[e];if(i){var c=t.getRowData(i,o);Object(y["tb"])(c,a,i.packageids),s.push(c)}})),this.currentPage=1,this.tableTotal=s.length,this.cacheList=s,this.cacheDeviceids=i,this.calcStateCount(),this.setTypeOptions(s),this.splitCacheToTableList()},noRepeat:function(e){for(var t=0;t<e.length-1;t++)for(var i=t+1;i<e.length;i++)e[t]===e[i]&&(e.splice(i,1),i--);return e},onTreeCheck:function(e){this.cacheDeviceids=e,this.calcStateCount(),this.setTableList(this.radio)},calcStateCount:function(){var e=0,t=0,i=0,a=0,s=0,o=0,c=0,r=0,l=0,n=Date.now(),d=864e5,p=30*d,m=60*d,u=90*d;this.cacheDeviceids.forEach((function(d){var h=b["a"].deviceInfos[d];if(h){var v=h.expirenotifytime-n;0==h.firstloctime?e++:(0==h.overduetime&&t++,v>=0?(v<p&&i++,p<=v&&v<=m&&a++,m<=v&&v<=u&&s++):0!==h.firstloctime&&0!==h.expirenotifytime&&(v=Math.abs(v),v>u&&l++,v<p&&o++,p<=v&&v<=m&&c++,m<=v&&v<=u&&r++))}})),this.notActiveCount=e,this.notRecharged=t,this.effective30=i,this.effective60=a,this.effective90=s,this.invalid30=o,this.invalid60=c,this.invalid90=r,this.exceed90=l,this.totalCount=this.cacheDeviceids.length},setTableList:function(e){var t=[];switch(e){case"-1":t=this.getNotRechargedTableList();break;case"0":t=this.getAllTableList();break;case"-2":t=this.getUnactiveTableList();break;case"30":case"60":case"90":t=this.getFastExpirationTableList(Number(e));break;case"-30":case"-60":case"-90":case"-91":t=this.getExpirationTableList(Number(e));break}this.currentPage=1,this.tableTotal=t.length,this.cacheList=t,this.setTypeOptions(t),this.splitCacheToTableList()},getAllTableList:function(){var e=this,t=this.packages,i=[],a=this.deviceTypes;return this.cacheDeviceids.forEach((function(s){var o=b["a"].deviceInfos[s];if(o){var c=e.getRowData(o,a);Object(y["tb"])(c,t,o.packageids),i.push(c)}})),i},getUnactiveTableList:function(){var e=this,t=this.packages,i=[],a=this.deviceTypes;return this.cacheDeviceids.forEach((function(s){var o=b["a"].deviceInfos[s];if(o&&0==o.firstloctime){var c=e.getRowData(o,a);Object(y["tb"])(c,t,o.packageids),i.push(c)}})),i},getNotRechargedTableList:function(){var e=this,t=this.packages,i=[],a=this.deviceTypes;return this.cacheDeviceids.forEach((function(s){var o=b["a"].deviceInfos[s];if(o){if(0==o.firstloctime)return;if(0!==o.overduetime)return;var c=e.getRowData(o,a);Object(y["tb"])(c,t,o.packageids),i.push(c)}})),i},getFastExpirationTableList:function(e){var t=this,i=this.packages,a=Date.now(),s=[],o=this.deviceTypes,c=2592e6,r=5184e6,l=7776e6;return this.cacheDeviceids.forEach((function(n){var d=b["a"].deviceInfos[n];if(d){var p=d.expirenotifytime,m=p-a;if(0==d.firstloctime)return;if(m>=0)if(30==e&&m<=c){var u=t.getRowData(d,o);Object(y["tb"])(u,i,d.packageids),s.push(u)}else if(60==e&&c<=m&&m<=r){var h=t.getRowData(d,o);Object(y["tb"])(h,i,d.packageids),s.push(h)}else if(90==e&&r<=m&&m<=l){var v=t.getRowData(d,o);Object(y["tb"])(v,i,d.packageids),s.push(v)}}})),s},getExpirationTableList:function(e){var t=this,i=this.packages,a=24*e*3600*1e3,s=Date.now(),o=[],c=this.deviceTypes,r=2592e6,l=5184e6,n=7776e6;return this.cacheDeviceids.forEach((function(d){var p=b["a"].deviceInfos[d];if(p){var m=p.expirenotifytime-s;if(0!==p.firstloctime&&0!==p.expirenotifytime&&m<0){var u=!1;if(m=Math.abs(m),a=Math.abs(a),"-91"==e?m>7776e6&&(u=!0):m<=a&&("-30"==e?m<=r&&(u=!0):"-60"==e?r<=m&&m<=l&&(u=!0):"-90"==e&&l<=m&&m<=n&&(u=!0)),u){var h=t.getRowData(p,c);Object(y["tb"])(h,i,p.packageids),o.push(h)}}}})),o},getRowData:function(e,t){var i=0==e.expirenotifytime?"-":L["a"].format(new Date(e.expirenotifytime),"yyyy-MM-dd"),a=t[e.devicetype],s=a.typename;return{creater:e.creater,deviceid:e.deviceid,devicename:e.devicename,groupname:e.groupname,deviceType:s,isfree:e.isfree,devicetype:e.devicetype,roleStr:Object(y["u"])(e.isfree).stateStr,createTime:L["a"].format(new Date(e.createtime),"yyyy-MM-dd"),initloctimeStr:e.initloctime?L["a"].format(new Date(e.initloctime),"yyyy-MM-dd"):"-",firstloctimeStr:0!=e.firstloctime?L["a"].format(new Date(e.firstloctime),"yyyy-MM-dd"):"-",lastValidpoistiontime:0!=e.lastactivetime?L["a"].format(new Date(e.lastactivetime),"yyyy-MM-dd"):"-",overdueTime:Object(y["X"])(e),expirenotifyTime:i,simnum:e.simnum?e.simnum:"",simiccid:e.simiccid?e.simiccid:"",devicetag:e.devicetag}},readWorkbookFromLocalFile:function(e,t){var i=new FileReader;i.onload=function(e){var i=e.target.result,a=new ExcelJS.Workbook;a.xlsx.load(i).then((function(){t&&t(a)}))},i.readAsBinaryString(e)},parserExcelData:function(e){var t=this,i=b["a"].deviceInfos,a=(this.deviceTypes,Object(y["t"])(i)),s=a.simMap,o=a.iccidMap;try{var c=[];e.eachRow({includeEmpty:!0},(function(e,t){if(t>1){var a={};e.eachCell({includeEmpty:!0},(function(e,t){if(e.text)switch(t){case 1:var c=Object(y["ob"])(i,s,o,e.text.trim(),!0);if(!c)return;a.deviceid=c.deviceid;break;case 2:var r="-";if("string"==typeof e.value&&(e.value=e.value.trim()),e.value instanceof Date)r=L["a"].format(e.value,"yyyy-MM-dd");else if(e.value&&"string"==typeof e.value){var l=new Date(e.value);r=L["a"].format(l,"yyyy-MM-dd")}else{var n=new Date;n.setFullYear(n.getFullYear()+1),r=L["a"].format(n,"yyyy-MM-dd")}a.adjustExpirenotifyTime=r}})),2==Object.keys(a).length&&c.push(a)}})),c.length>0&&(c.forEach((function(e){var t=i[e.deviceid];e.devicename=t.devicename;var a=0==t.expirenotifytime?"-":L["a"].format(new Date(t.expirenotifytime),"yyyy-MM-dd");e.expirenotifyTime=a})),t.importDeviceDialog=!0,t.$refs.importDevice.setTableList(c))}catch(r){console.log(r),t.$XModal.message({message:t.$t("insure.importExcelFailTips"),status:"error",zIndex:9999})}},init:function(){var e=this;this.packages=[],this.cacheDeviceids=[],Object(O["Z"])({filterenabled:0}).then((function(t){var i=t.packages;i=i||[],i.forEach((function(e){e.packagename=Object(y["Y"])(e)})),e.packages=i})),this.$nextTick((function(){var t=document.getElementById("import-add-file");t.onchange=function(t){var i=t.srcElement.value.lastIndexOf("."),a=t.srcElement.value.slice(i);if(-1!=a.indexOf("xlsx")){var s=t.target.files[0];e.readWorkbookFromLocalFile(s,(function(t){var i="设备到期时间",a=t.getWorksheet(i);void 0==a&&(i="expiretime",a=t.getWorksheet(i)),e.parserExcelData(a),e.isSpin=!1}))}else e.$XModal.message({message:e.$t("insure.importExcelTips"),status:"error",zIndex:9999})},e.fileEl=t}))}},mounted:function(){this.init()}},z=R,N=(i("0a2e"),Object(u["a"])(z,a,s,!1,null,null,null)),A=N.exports;t["default"]=A}}]);