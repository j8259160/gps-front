(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0237fd95"],{"062a":function(e,t,i){},"10da":function(e,t,i){"use strict";i("062a")},a262:function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e._self._c;return t("div",{staticClass:"removed-device full"},[t("div",{staticClass:"removed-device-header"},[t("div",{staticClass:"f_left",staticStyle:{width:"210px"}},[t("LabelWrap",{attrs:{label:e.$t("bgManage.queryDevice"),showLabel:!1}},[t("el-input",{attrs:{clearable:"","prefix-icon":"el-icon-search",placeholder:e.$t("bgManage.pleaseEnterSearchDeviceid")},model:{value:e.queryText,callback:function(t){e.queryText=t},expression:"queryText"}})],1)],1),t("div",{staticClass:"f_left"},[t("el-button",{attrs:{type:"primary",loading:e.loading},on:{click:e.handleClickQuery}},[e._v(e._s(e.$t("common.query")))])],1),t("div",{staticClass:"f_right",staticStyle:{"padding-top":"3px"}},[t("el-button",{staticStyle:{height:"28px"},attrs:{size:"mini",loading:e.exportLoading},on:{click:e.exportDataAll}},[e._v(e._s(e.$t("device.exportAllDevice")))])],1),t("div",{staticClass:"f_right",staticStyle:{"padding-top":"3px"}},[t("el-button",{staticStyle:{height:"28px"},attrs:{size:"mini",loading:e.exportLoading1},on:{click:e.exportData}},[e._v(e._s(e.$t("device.exportCurrentDevice")))])],1),t("div",{staticClass:"f_right"},[t("el-radio",{attrs:{label:"60"},model:{value:e.queryType,callback:function(t){e.queryType=t},expression:"queryType"}},[e._v(e._s(e.$t("device.daysDelete60"))),"60"==e.queryType?t("span",[e._v("("+e._s(e.totalcount)+")")]):e._e()])],1),t("div",{staticClass:"f_right"},[t("el-radio",{attrs:{label:"7"},model:{value:e.queryType,callback:function(t){e.queryType=t},expression:"queryType"}},[e._v(e._s(e.$t("device.daysDelete7"))),"7"==e.queryType?t("span",[e._v("("+e._s(e.totalcount)+")")]):e._e()])],1),t("div",{staticClass:"f_right",staticStyle:{width:"auto"}},[t("el-radio",{attrs:{label:"0"},model:{value:e.queryType,callback:function(t){e.queryType=t},expression:"queryType"}},[e._v(e._s(e.$t("device.allDeleteDevice"))),"0"==e.queryType?t("span",[e._v("("+e._s(e.totalcount)+")")]):e._e()])],1)]),t("div",{staticClass:"removed-device-content",staticStyle:{top:"39px"}},[t("vxe-table",{attrs:{"sort-config":e.sortConfig,"menu-config":e.tableMenu,border:"","auto-resize":"",resizable:"","show-overflow":"","highlight-current-row":"",size:"mini",height:"auto",data:e.tableList,"cell-style":e.cellStyle},on:{"menu-click":e.handleClickTableMenu}},[t("vxe-table-column",{attrs:{title:e.$t("reportForm.action"),width:"78",fixed:"left"},scopedSlots:e._u([{key:"default",fn:function(i){return[-1==i.row.actionStatus||3==i.row.actionStatus||4==i.row.actionStatus||5==i.row.actionStatus?t("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.restoreRemovedDevices(i)}}},[e._v(e._s(e.$t("bgManage.revert")))]):t("el-button",{attrs:{type:"primary",disabled:"",size:"mini"},on:{click:function(t){return e.restoreRemovedDevices(i)}}},[e._v(e._s(e.$t("bgManage.revert")))])]}}])}),t("vxe-table-column",{attrs:{type:"seq",width:"60",title:e.$t("reportForm.index")}}),t("vxe-table-column",{attrs:{field:"remover",sortable:"",title:e.$t("bgManage.remover"),width:"100"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("el-popover",{attrs:{placement:"bottom",trigger:"click"}},[t("div",{staticClass:"parents-wrapper"},e._l(e.parentsList,(function(i){return t("div",{key:i.username},[e._v(e._s(i.username)+"("+e._s(i.usertypeStr)+")")])})),0),t("el-button",{staticStyle:{color:"#000000"},attrs:{slot:"reference",type:"text"},on:{click:function(t){return e.queryParents(i.row.remover)}},slot:"reference"},[e._v(e._s(i.row.remover))])],1)]}}])}),t("vxe-table-column",{attrs:{field:"removetimeStr",sortable:"",title:e.$t("reportForm.deleteTime"),width:"150"}}),t("vxe-table-column",{attrs:{field:"devicename",sortable:"",width:"120",title:e.$t("alarm.devName")}}),t("vxe-table-column",{attrs:{field:"deviceid",sortable:"",width:"120",title:e.$t("alarm.devNum")}}),t("vxe-table-column",{attrs:{field:"deviceType",sortable:"",title:e.$t("reportForm.deviceType"),width:"100"}}),t("vxe-table-column",{attrs:{field:"lastValidpoistiontime",title:e.$t("bgManage.lastOnlineTime"),width:"110",sortable:""}}),t("vxe-table-column",{attrs:{field:"firstLocTime",title:e.$t("reportForm.firstLocTime"),width:"110"}}),t("vxe-table-column",{attrs:{field:"addTime",title:e.$t("reportForm.addTime"),width:"110"}}),t("vxe-table-column",{attrs:{field:"expireTime",title:e.$t("alarm.expireTime"),width:"110"}}),t("vxe-table-column",{attrs:{title:e.$t("reportForm.creater"),field:"creater",width:"120",sortable:""},scopedSlots:e._u([{key:"default",fn:function(i){return[t("el-popover",{attrs:{placement:"bottom",trigger:"click"}},[t("div",{staticClass:"parents-wrapper"},e._l(e.parentsList,(function(i){return t("div",{key:i.username},[e._v(e._s(i.username)+"("+e._s(i.usertypeStr)+")")])})),0),t("el-button",{staticStyle:{color:"#000000"},attrs:{slot:"reference",type:"text"},on:{click:function(t){return e.queryParents(i.row.creater)}},slot:"reference"},[e._v(e._s(i.row.creater))])],1)]}}])}),t("vxe-table-column",{attrs:{field:"actionStatus",width:"120",title:e.$t("reportForm.status"),"edit-render":{name:"$select",options:e.statusList,props:{multiple:!1}}}})],1)],1),t("div",{staticStyle:{position:"absolute",left:"0px",right:"10px",bottom:"0px"}},[t("el-pagination",{attrs:{currentPage:e.currentPage,"current-page":e.currentChangePage,"page-sizes":[20,40,60,80],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.totalcount},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)])},r=[],o=i("5530"),s=(i("14d9"),i("a9e3"),i("d3b7"),i("159b"),i("0139")),n=i("e285"),c=i("2f62"),l=i("5101"),u=i("6e52"),d=i("c276"),p=i("4c3c"),v=i("a05b"),m=i("61fc"),h=i("e173"),y=i("7b49"),f={name:"RemovedDevices",data:function(){return{editIcon:m,deleteIcon:h,moreIcon:y,loading:!1,exportLoading1:!1,editDialog:!1,recordsDialog:!1,oilMarkDiglog:!1,editDiglog:!1,weightDialog:!1,ioDialog:!1,queryText:"",queryType:"0",tableList:[],parentsList:[],totalcount:0,deviceid:"",deviceName:"",currentRow:{},pageSize:20,currentPage:1,exportLoading:!1,statusList:[]}},mixins:[p["a"],v["a"]],components:{LabelWrap:s["a"]},computed:Object(o["a"])({},Object(c["b"])(["deviceTypes","isQueryInitData"])),watch:{isQueryInitData:function(e){if(e){var t={count:this.pageSize,keyword:this.queryText,offset:0,all:!1,removedays:0};this.queryRemovedDevices(t)}},queryType:function(){this.totalcount=0;var e={count:this.pageSize,keyword:this.queryText,offset:0,all:!1,removedays:Number(this.queryType)};this.queryRemovedDevices(e)}},destroyed:function(){this.tableList=null},methods:Object(o["a"])(Object(o["a"])({},Object(c["c"])(["setIsReloadRootuser","setReportTagList"])),{},{queryParents:function(e){var t=this;this.parentsList=[],Object(n["Bb"])(e).then((function(e){var i=e.status,a=e.records;0==i&&(a.forEach((function(e){e.usertypeStr=Object(d["cb"])(t.isZh,e.usertype)})),t.parentsList=a)}))},cellStyle:function(e){var t=e.row,i=(e.rowIndex,e.column);e.columnIndex;if("actionStatus"===i.property){if(0==t.actionStatus||1==t.actionStatus||2==t.actionStatus)return{color:"green"};if(5==t.actionStatus)return{color:"red"}}},exportData:function(){var e=[[this.$t("reportForm.index"),this.$t("bgManage.remover"),this.$t("reportForm.deleteTime"),this.$t("alarm.devName"),this.$t("alarm.devNum"),this.$t("reportForm.deviceType"),this.$t("bgManage.lastOnlineTime"),this.$t("reportForm.firstLocTime"),this.$t("reportForm.addTime"),this.$t("alarm.expireTime"),this.$t("reportForm.creater")]];if(0!=this.tableList.length){this.tableList.forEach((function(t,i){var a=[];a.push(++i),a.push(t.remover),a.push(t.removetimeStr),a.push(t.devicename),a.push(t.deviceid),a.push(t.deviceType),a.push(t.lastValidpoistiontime),a.push(t.firstLocTime),a.push(t.addTime),a.push(t.expireTime),a.push(t.creater),e.push(a)}));var t={title:this.$t("bgManage.removedDevices"),data:e,dateRange:null,exportMaxLength:1e5};this.exportLoading1=!0,new ExcelCls(t).exportExcel(this)}},restoreRemovedDevices:function(e){var t=this,i=e.row,a={deviceids:[i.deviceid]};Object(n["kc"])(a).then((function(e){var a=e.status,r=e.devices,o=e.cause;if(0==a&&r){var s=r[0];if(s){i.actionStatus=s.status,0!=i.actionStatus&&1!=i.actionStatus&&2!=i.actionStatus||(t.setReportTagList([]),t.setIsReloadRootuser(!0));var n="";switch(s.status){case 0:n=t.$t("device.recoveryWasSuccessful");break;case-1:n=t.$t("device.notOperated");break;case 1:n=t.$t("device.restoreToDefaultGrouping");break;case 2:n=t.$t("device.restoreToYourOwnAccount");break;case 3:n=t.$t("tips.deviceNotFound");break;case 4:n=t.$t("tips.deviceAlreadyExists");break;case 5:n=t.$t("tips.failedToAddNewDevice");break}t.$XModal.message({message:n,status:"success",zIndex:9999})}}else t.$XModal.message({message:t.$t("device.actionFail")+": "+o,status:"error",zIndex:9999})})).catch((function(e){console.log(e)}))},exportDataAll:function(){var e=this,t=[[this.$t("reportForm.index"),this.$t("bgManage.remover"),this.$t("reportForm.deleteTime"),this.$t("alarm.devName"),this.$t("alarm.devNum"),this.$t("reportForm.deviceType"),this.$t("reportForm.addTime"),this.$t("alarm.expireTime"),this.$t("reportForm.creater")]],i=this.deviceTypes;u["a"].deviceInfos;this.exportLoading=!0,Object(n["Ib"])({all:!0,keyword:""}).then((function(a){var r=a.devices;if(e.exportLoading=!1,r){r.forEach((function(e,a){var r=[],o=l["a"].format(new Date(e.createtime),"yyyy-MM-dd"),s=i[e.devicetype].typename,n=l["a"].format(new Date(e.expirenotifytime),"yyyy-MM-dd"),c=l["a"].longToLocalDateTimeStr(e.removetime);r.push(++a),r.push(e.remover),r.push(c),r.push(e.devicename),r.push(e.deviceid),r.push(s),r.push(o),r.push(n),r.push(e.creater),t.push(r)}));var o={title:e.$t("bgManage.removedDevices"),data:t,dateRange:null,exportMaxLength:1e5};new ExcelCls(o).exportExcel(e)}})).catch((function(t){console.log(t),e.exportLoading=!1}))},handleEdit:function(e){this.currentRow=e.row,this.deviceid=e.row.deviceid,this.deviceName=e.row.devicename,this.editDialog=!0},handleClickQuery:function(){var e={count:this.pageSize,keyword:this.queryText,offset:0,all:!1,removedays:Number(this.queryType)};this.queryRemovedDevices(e)},queryRemovedDevices:function(e){var t=this;this.loading=!0;var i=this.deviceTypes;Object(n["Ib"])(e).then((function(e){var a=e.devices,r=e.totalcount;t.totalcount=r,a.forEach((function(e){var t=0==e.firstloctime?"-":l["a"].format(new Date(e.firstloctime),"yyyy-MM-dd"),a=0!=e.lastactivetime?l["a"].format(new Date(e.lastactivetime),"yyyy-MM-dd"):"-",r=i[e.devicetype]?i[e.devicetype].typename:"";e.addTime=l["a"].format(new Date(e.createtime),"yyyy-MM-dd"),e.expireTime=l["a"].format(new Date(e.expirenotifytime),"yyyy-MM-dd"),e.removetimeStr=l["a"].longToLocalDateTimeStr(e.removetime),e.deviceType=r,e.actionStatus=-1,e.firstLocTime=t,e.lastValidpoistiontime=a})),t.tableList=a,t.loading=!1})).catch((function(e){console.log(e),t.loading=!1}))},currentChangePage:function(e){var t={count:this.pageSize,keyword:this.queryText,offset:e-1,all:!1,removedays:0};this.queryRemovedDevices(t)},handleSizeChange:function(e){this.pageSize=e,this.currentChangePage(this.currentPage)},handleCurrentChange:function(e){this.currentChangePage(e)}}),mounted:function(){var e=this;if(this.isQueryInitData){var t={count:this.pageSize,keyword:this.queryText,offset:0,all:!1,removedays:0};this.queryRemovedDevices(t)}this.$nextTick((function(){e.statusList=[{label:e.$t("device.notOperated"),value:-1},{label:e.$t("device.recoveryWasSuccessful"),value:0},{label:e.$t("device.restoreToDefaultGrouping"),value:1},{label:e.$t("device.restoreToYourOwnAccount"),value:2},{label:e.$t("tips.deviceNotFound"),value:3},{label:e.$t("tips.deviceAlreadyExists"),value:4},{label:e.$t("tips.failedToAddNewDevice"),value:5}]}))}},g=f,b=(i("10da"),i("2877")),x=Object(b["a"])(g,a,r,!1,null,null,null),T=x.exports;t["default"]=T}}]);