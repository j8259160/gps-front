(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-792823dc"],{"0595":function(e,t,i){"use strict";var r=function(){var e=this,t=e._self._c;return t("div",{staticClass:"quick-time-range"},[t("div",{staticClass:"quick-time-range-wrapper"},e._l(e.list,(function(i){return t("div",{key:i.type,style:{color:i.type==e.type?"#409EFF":""},on:{click:function(t){return e.selectDate(i.type)}}},[e._v(e._s(i.label))])})),0),t("div",{staticClass:"quick-time-range-space"}),t("div",{staticClass:"quick-time-range-btn",on:{click:function(t){e.isCollapse=!e.isCollapse}}},[e.isCollapse?t("i",{staticClass:"el-icon-arrow-right"}):t("i",{staticClass:"el-icon-arrow-left"})])])},a=[],s=i("5101"),o={name:"QuickTimeRange",props:{value:{type:Array,default:function(){return[]}},dateType:{type:String,default:"date"}},watch:{isCollapse:function(){this.setList()}},data:function(){return{isCollapse:!0,type:0,list:[]}},methods:{setList:function(){this.isCollapse?this.list=[{label:this.$t("reportForm.toDay"),type:0},{label:this.$t("reportForm.yesterDay"),type:1},{label:this.$t("reportForm.recent3Days"),type:3}]:this.list=[{label:this.$t("reportForm.recent7Days"),type:7},{label:this.$t("reportForm.recent10Days"),type:10},{label:this.$t("reportForm.recent30Days"),type:30}]},selectDate:function(e){var t="datetimerange"==this.dateType,i=[],r=new Date,a=new Date;switch(t&&(r=new Date(s["a"].format(new Date,"yyyy-MM-dd")+" 00:00:00"),a=new Date(s["a"].format(new Date,"yyyy-MM-dd")+" 23:59:59")),e){case 0:i=[new Date(s["a"].format(r,"yyyy-MM-dd")+" 00:00:00"),new Date(s["a"].format(a,"yyyy-MM-dd")+" 23:59:59")];break;case 1:r.setTime(r.getTime()-864e5),a.setTime(a.getTime()-864e5),i=[r,a];break;case 3:r.setTime(r.getTime()-2592e5),i=[r,a];break;case 7:r.setTime(r.getTime()-6048e5),i=[r,a];break;case 10:r.setTime(r.getTime()-864e6),i=[r,a];break;case 30:r.setTime(r.getTime()-2592e6),i=[r,a];break}this.type=e,this.$emit("input",i)}},mounted:function(){var e=this;this.$nextTick((function(){e.setList()}))}},n=o,l=(i("8d09"),i("2877")),c=Object(l["a"])(n,r,a,!1,null,null,null);t["a"]=c.exports},"3b13":function(e,t,i){},"3b40":function(e,t,i){"use strict";i("868b")},"57c9":function(e,t,i){"use strict";var r=i("0595");t["a"]=r["a"]},7031:function(e,t,i){"use strict";i("3b13")},"868b":function(e,t,i){},"8d09":function(e,t,i){"use strict";i("a818")},"95d5":function(e,t,i){"use strict";i.r(t);var r=function(){var e=this,t=e._self._c;return t("div",{staticClass:"report-form full"},[t("div",{staticClass:"report-form-inner"},[t("div",{staticClass:"report-form-inner-header",staticStyle:{height:"35px"}},[t("div",{staticClass:"f_left"},[t("MultiChoiceVehicle",{on:{onSelectDevice:e.onSelectDevice}})],1),t("div",{staticClass:"f_left"},[t("SelectDate",{model:{value:e.dateRange,callback:function(t){e.dateRange=t},expression:"dateRange"}})],1),t("div",{staticClass:"f_left"},[t("QuickTimeRange",{model:{value:e.dateRange,callback:function(t){e.dateRange=t},expression:"dateRange"}})],1),t("div",{staticClass:"f_left"},[t("el-button",{attrs:{loading:e.loading,type:"primary"},on:{click:e.handleQuery}},[e._v(e._s(e.$t("common.query")))])],1),t("div",{staticClass:"f_left"},[t("el-popover",{attrs:{placement:"bottom",width:"236",trigger:"click"}},[t("div",[t("el-button",{staticStyle:{width:"100px"},attrs:{slot:"reference",type:"primary",loading:e.exportLoading1,plain:""},on:{click:e.exportAllData},slot:"reference"},[e._v(e._s(e.$t("reportForm.onlySummary")))]),t("el-button",{staticStyle:{width:"100px"},attrs:{slot:"reference",type:"primary",loading:e.exportLoading2,plain:""},on:{click:e.exportDetailData},slot:"reference"},[e._v(e._s(e.$t("reportForm.SummaryAndDetail")))])],1),t("el-button",{attrs:{slot:"reference",type:"primary"},slot:"reference"},[e._v(e._s(e.$t("common.export")))])],1)],1)]),t("div",{staticClass:"report-form-inner-content",staticStyle:{top:"39px"}},[t("vxe-table",{ref:"xTable",attrs:{"sort-config":e.sortConfig,"menu-config":e.tableMenu,border:"",resizable:"","auto-resize":"","show-overflow":"","highlight-hover-row":"",size:"mini",height:"auto",data:e.totalList},on:{"menu-click":e.handleClickTableMenu}},[t("vxe-table-column",{attrs:{type:"seq",width:"60",title:e.$t("reportForm.index")}}),t("vxe-table-column",{attrs:{type:"expand",width:"36"},scopedSlots:e._u([{key:"content",fn:function(i){var r=i.row;i.rowIndex;return[[t("div",{staticStyle:{"padding-left":"60px"}},[t("vxe-table",{attrs:{"menu-config":e.tableMenu,border:"",resizable:"","auto-resize":"",height:r.tableHeight,"show-overflow":"","highlight-hover-row":"",size:"mini",data:r.records},on:{"menu-click":e.handleClickTableMenu}},[t("vxe-table-column",{attrs:{type:"seq",width:"40"}}),t("vxe-table-column",{attrs:{field:"workingDuration",align:"right",width:"140",title:e.$t("reportForm.workingDuration"),sortable:""}}),t("vxe-table-column",{attrs:{field:"mileage",formatter:e.numberToFixed2,align:"right",width:"100",title:e.$t("reportForm.mileage")+e.distanceUnit,sortable:""}}),t("vxe-table-column",{attrs:{field:"cardinsertTime",width:"156",title:e.$t("reportForm.cardinsertTime"),sortable:""}}),t("vxe-table-column",{attrs:{field:"cardPullTime",width:"156",title:e.$t("reportForm.cardPullTime"),sortable:""}}),t("vxe-table-column",{attrs:{field:"cardinsertAddress",title:e.$t("reportForm.cardinsertAddress")}}),t("vxe-table-column",{attrs:{field:"cardPullAddress",title:e.$t("reportForm.cardPullAddress")}}),t("vxe-table-column",{attrs:{field:"devicename",title:e.$t("alarm.devName"),sortable:""}}),t("vxe-table-column",{attrs:{field:"deviceid",title:e.$t("alarm.devNum"),sortable:""}})],1)],1)]]}}])}),t("vxe-table-column",{attrs:{field:"driverName",title:e.$t("reportForm.driverName"),sortable:""}}),t("vxe-table-column",{attrs:{field:"certificationcode",width:"180",title:e.$t("reportForm.certificationcode"),sortable:""}}),t("vxe-table-column",{attrs:{field:"workingDuration",align:"right",width:"140",title:e.$t("reportForm.workingDuration"),sortable:""}}),t("vxe-table-column",{attrs:{field:"mileage",formatter:e.numberToFixed2,align:"right",width:"100",title:e.$t("reportForm.mileage")+e.distanceUnit,sortable:""}})],1)],1)])])},a=[],s=i("5530"),o=(i("14d9"),i("4e82"),i("d3b7"),i("159b"),i("4795"),i("6e52")),n=i("e561"),l=i("d462"),c=i("57c9"),d=i("5101"),u=i("c276"),m=i("1c31"),h=i("4c3c"),p=i("a05b"),f=i("2f62"),v={name:"driverWorkDetails",data:function(){return{loading:!1,exportLoading2:!1,exportLoading1:!1,dateRange:[new Date,new Date],totalList:[]}},components:{MultiChoiceVehicle:n["a"],SelectDate:l["a"],QuickTimeRange:c["a"]},computed:Object(s["a"])({},Object(f["b"])(["distanceUnit"])),watch:{dateRange:function(){this.loading||this.handleQuery()}},mixins:[h["a"],p["a"]],methods:{numberToFixed2:u["qb"],onSelectDevice:function(e){this.deviceids=e},handleClickRow:function(e){var t=e.row;console.log(t)},handleQuery:function(){var e=this,t=this.deviceids,i=this.dateRange;if(0!=t.length)if(0!=i.length){var r=d["a"].format(i[0],"yyyy-MM-dd"),a=d["a"].format(i[1],"yyyy-MM-dd"),s={startday:r,endday:a,offset:d["a"].getOffset(),deviceids:t,needaddress:1};this.loading=!0,Object(m["L"])(s).then((function(t){var i=t.records,r=t.addressmap;e.loading=!1;var a=[];i&&i.forEach((function(e){var t=e.records?e.records:[],i="",s="",n=0,l=0;t.sort((function(e,t){return t.uptime-e.uptime})),t.forEach((function(e){var t=e.deviceid,a=o["a"].deviceInfos[t],c=a?a.devicename:t;i=e.drivername,s=e.certificationcode,e.cardinsertTime=e.uptime>0?d["a"].longToLocalDateTimeStr(e.uptime):"-",e.cardPullTime=e.downtime>0?d["a"].longToLocalDateTimeStr(e.downtime):"-";var m=Object(u["L"])(r,e.uplat,e.uplon);e.cardinsertAddress=m||"-";var h=Object(u["L"])(r,e.downlat,e.downlon);e.cardPullAddress=h||"-";var p=e.downtime-e.uptime,f=Object(u["d"])(e.downdistance-e.updistance);e.workingDuration=Object(u["Pb"])(p,!1),e.mileage=f,f>0&&(n+=f),p>0&&(l+=p),e.devicename=c})),a.push({records:t,driverName:i,certificationcode:s,mileage:n,workingDuration:Object(u["Pb"])(l,!1),duration:l,tableHeight:0==t.length?72:36*t.length+36})})),e.totalList=a,1==a.length&&setTimeout((function(){e.$refs.xTable.setRowExpand(a[0],!0)}),500)}))}else this.$XModal.message({message:this.$t("tips.selectTime"),status:"error",zIndex:9999});else this.$XModal.message({message:this.$t("tips.selectDevice"),status:"error",zIndex:9999})},exportAllData:function(){var e=this,t=this.$refs.xTable.getTableData().visibleData;if(t.length>0){var i=[[this.$t("reportForm.index"),this.$t("reportForm.driverName"),this.$t("reportForm.certificationcode"),this.$t("reportForm.workingDuration"),this.$t("reportForm.mileage")+this.distanceUnit]];t.forEach((function(t,r){var a=[];a.push(r+1),a.push(t.driverName?t.driverName:""),a.push(t.certificationcode?t.certificationcode:""),a.push(t.workingDuration?t.workingDuration:"0"),a.push(t.mileage?e.numberToFixed2(t.mileage):""),i.push(a)}));var r={title:this.$t("reportForm.driverWorkDetails"),data:i,dateRange:this.queryDateRange};this.exportLoading1=!0,new ExcelCls(r).exportExcel(this)}},exportDetailData:function(){var e=this.$refs.xTable.getTableData().visibleData;if(e.length>0){var t=[[this.$t("reportForm.index"),this.$t("reportForm.driverName"),this.$t("reportForm.certificationcode"),this.$t("reportForm.workingDuration"),this.$t("reportForm.mileage")+this.distanceUnit,this.$t("reportForm.cardinsertTime"),this.$t("reportForm.cardPullTime"),this.$t("reportForm.cardinsertAddress"),this.$t("reportForm.cardPullAddress"),this.$t("alarm.devName"),this.$t("alarm.devNum")]];e.forEach((function(e){e.records.forEach((function(i,r){var a=[];a.push(r+1),a.push(e.driverName?e.driverName:""),a.push(i.certificationcode?i.certificationcode:""),a.push(i.workingDuration?i.workingDuration:""),a.push(i.mileage?Object(u["qb"])(i.mileage):""),a.push(i.cardinsertTime?i.cardinsertTime:""),a.push(i.cardPullTime?i.cardPullTime:""),a.push(i.cardinsertAddress?i.cardinsertAddress:""),a.push(i.cardPullAddress?i.cardPullAddress:""),a.push(i.devicename),a.push(i.deviceid),t.push(a)}));var i=[];i.push(""),i.push(""),i.push(""),i.push(e.workingDuration?e.workingDuration:"0"),i.push(e.mileage?e.mileage:"0"),i.push(""),i.push(""),i.push(""),i.push(""),i.push(""),i.push(""),t.push(i),i=[],i.push(""),i.push(""),i.push(""),i.push(""),i.push(""),i.push(""),i.push(""),i.push(""),i.push(""),i.push(""),i.push(""),t.push(i)}));var i={title:this.$t("reportForm.driverWorkDetails"),data:t,dateRange:this.queryDateRange};this.exportLoading2=!0,new ExcelCls(i).exportExcel(this)}}},mounted:function(){this.deviceids=[]}},g=v,b=(i("3b40"),i("2877")),y=Object(b["a"])(g,r,a,!1,null,null,null),D=y.exports;t["default"]=D},a818:function(e,t,i){},e561:function(e,t,i){"use strict";var r=i("ea22");t["a"]=r["a"]},ea22:function(e,t,i){"use strict";var r=function(){var e=this,t=e._self._c;return t("div",{staticClass:"multi-choice multi-choice-vehicle"},[t("div",{staticClass:"multi-choice-input"},[t("ZtreeDeviceDropdown",{ref:"ztreeDevice",attrs:{disableShare:e.disableShare,isCheck:"",placeholder:this.$t("tips.selectDevice"),isQueryInitData:e.isQueryInitData,selectDeviceIds:e.multipleDeviceids},on:{onTreeCheck:e.onTreeCheck}})],1)])},a=[],s=i("5530"),o=(i("4795"),i("2f62")),n=i("2df7"),l={name:"MultiChoiceVehicle",props:{disableShare:{type:Boolean,default:!1}},data:function(){return{}},computed:Object(s["a"])({},Object(o["b"])(["isQueryInitData","multipleDeviceids"])),components:{ZtreeDeviceDropdown:n["a"]},methods:Object(s["a"])(Object(s["a"])({},Object(o["c"])(["setMultipleDeviceids"])),{},{onTreeCheck:function(e){this.$emit("onSelectDevice",e),this.setMultipleDeviceids(e)},clearText:function(){var e=this;setTimeout((function(){e.$refs.ztreeDevice.clearText()}),300)}})},c=l,d=(i("7031"),i("2877")),u=Object(d["a"])(c,r,a,!1,null,null,null);t["a"]=u.exports}}]);