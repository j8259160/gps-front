(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4d365574"],{"0595":function(t,e,i){"use strict";var s=function(){var t=this,e=t._self._c;return e("div",{staticClass:"quick-time-range"},[e("div",{staticClass:"quick-time-range-wrapper"},t._l(t.list,(function(i){return e("div",{key:i.type,style:{color:i.type==t.type?"#409EFF":""},on:{click:function(e){return t.selectDate(i.type)}}},[t._v(t._s(i.label))])})),0),e("div",{staticClass:"quick-time-range-space"}),e("div",{staticClass:"quick-time-range-btn",on:{click:function(e){t.isCollapse=!t.isCollapse}}},[t.isCollapse?e("i",{staticClass:"el-icon-arrow-right"}):e("i",{staticClass:"el-icon-arrow-left"})])])},a=[],n=i("5101"),o={name:"QuickTimeRange",props:{value:{type:Array,default:function(){return[]}},dateType:{type:String,default:"date"}},watch:{isCollapse:function(){this.setList()}},data:function(){return{isCollapse:!0,type:0,list:[]}},methods:{setList:function(){this.isCollapse?this.list=[{label:this.$t("reportForm.toDay"),type:0},{label:this.$t("reportForm.yesterDay"),type:1},{label:this.$t("reportForm.recent3Days"),type:3}]:this.list=[{label:this.$t("reportForm.recent7Days"),type:7},{label:this.$t("reportForm.recent10Days"),type:10},{label:this.$t("reportForm.recent30Days"),type:30}]},selectDate:function(t){var e="datetimerange"==this.dateType,i=[],s=new Date,a=new Date;switch(e&&(s=new Date(n["a"].format(new Date,"yyyy-MM-dd")+" 00:00:00"),a=new Date(n["a"].format(new Date,"yyyy-MM-dd")+" 23:59:59")),t){case 0:i=[new Date(n["a"].format(s,"yyyy-MM-dd")+" 00:00:00"),new Date(n["a"].format(a,"yyyy-MM-dd")+" 23:59:59")];break;case 1:s.setTime(s.getTime()-864e5),a.setTime(a.getTime()-864e5),i=[s,a];break;case 3:s.setTime(s.getTime()-2592e5),i=[s,a];break;case 7:s.setTime(s.getTime()-6048e5),i=[s,a];break;case 10:s.setTime(s.getTime()-864e6),i=[s,a];break;case 30:s.setTime(s.getTime()-2592e6),i=[s,a];break}this.type=t,this.$emit("input",i)}},mounted:function(){var t=this;this.$nextTick((function(){t.setList()}))}},r=o,l=(i("8d09"),i("2877")),c=Object(l["a"])(r,s,a,!1,null,null,null);e["a"]=c.exports},"0f70":function(t,e,i){"use strict";i("1e72")},"1e72":function(t,e,i){},"57c9":function(t,e,i){"use strict";var s=i("0595");e["a"]=s["a"]},"5aff":function(t,e,i){"use strict";i.d(e,"b",(function(){return s})),i.d(e,"h",(function(){return a})),i.d(e,"l",(function(){return n})),i.d(e,"k",(function(){return o})),i.d(e,"c",(function(){return r})),i.d(e,"d",(function(){return l})),i.d(e,"e",(function(){return c})),i.d(e,"f",(function(){return d})),i.d(e,"g",(function(){return h})),i.d(e,"m",(function(){return u})),i.d(e,"i",(function(){return m})),i.d(e,"a",(function(){return p})),i.d(e,"j",(function(){return f}));var s="#2D9F28",a="#89C6F2",n="#FFC65E",o="red",r="#1EBEFF",l="#E505F7",c="#40A703",d="#F27908",h="#F180D1",u="#0F1F46",m="#000000",p={backgroundColor:"rgba(255,255,255,0.85)",borderColor:"transparent",textStyle:{fontSize:12,color:"#000"},padding:2},f=function(t,e,i,s,a){var n=t[0],o=a.contentSize,r=a.viewSize;return n+10>r[0]-o[0]?n=n-o[0]-10:n+=10,[n,"0%"]}},7424:function(t,e,i){"use strict";i.r(e);var s=function(){var t=this,e=t._self._c;return e("div",{staticClass:"report-form full"},[e("div",{staticClass:"report-form-inner"},[e("div",{staticClass:"report-form-inner-header",staticStyle:{height:"35px"}},[e("div",{staticClass:"f_left"},[e("SingleChoiceVehicle",{attrs:{placeholder:this.$t("tips.selectSingleDevice"),width:"230px"},model:{value:t.deviceid,callback:function(e){t.deviceid=e},expression:"deviceid"}})],1),e("div",{staticClass:"f_left"},[e("SelectDate",{model:{value:t.dateRange,callback:function(e){t.dateRange=e},expression:"dateRange"}})],1),e("div",{staticClass:"f_left"},[e("QuickTimeRange",{model:{value:t.dateRange,callback:function(e){t.dateRange=e},expression:"dateRange"}})],1),e("div",{staticClass:"f_left"},[e("el-button",{attrs:{loading:t.loading,type:"primary"},on:{click:t.handleQuery}},[t._v(t._s(t.$t("common.query")))])],1),e("div",{staticClass:"f_left"},[e("el-button",{attrs:{type:"primary",loading:t.exportLoading1},on:{click:t.exportData}},[t._v(t._s(t.$t("common.export")))])],1)]),e("div",{staticStyle:{width:"100%",height:"270px","margin-top":"10px"}},[e("TimeWeightEcharts",{ref:"echartsIns"})],1),e("div",{staticClass:"report-form-inner-content",staticStyle:{top:"324px"}},[e("vxe-table",{ref:"xTable",attrs:{"menu-config":t.tableMenu,border:"",resizable:"","auto-resize":"","show-overflow":"","highlight-current-row":"","highlight-hover-row":"",size:"mini",height:"auto",data:t.totalList},on:{"menu-click":t.handleClickTableMenu,"cell-click":t.cellclick,"cell-dblclick":t.cellDblclick}},[e("vxe-table-column",{attrs:{type:"seq",width:"60",title:t.$t("reportForm.index")}}),e("vxe-table-column",{attrs:{field:"devicename",width:"120",title:t.$t("alarm.devName"),sortable:""}}),e("vxe-table-column",{attrs:{field:"deviceid",width:"120",title:t.$t("alarm.devNum"),sortable:""}}),e("vxe-table-column",{attrs:{field:"statisticsday",width:"150",title:t.$t("reportForm.time"),sortable:""}}),e("vxe-table-column",{attrs:{field:"totalMileage",formatter:t.numberToFixed2,align:"right",width:"150",title:t.$t("reportForm.totalMileage")+t.distanceUnit,sortable:""}}),e("vxe-table-column",{attrs:{field:"weight",formatter:t.numberToFixed2,align:"right",width:"120",title:t.$t("reportForm.weight")+t.weightUnit,sortable:""}}),e("vxe-table-column",{attrs:{field:"speed",formatter:t.numberToFixed2,align:"right",width:"120",title:t.$t("reportForm.speed")+t.speedUnit,sortable:""}}),e("vxe-table-column",{attrs:{field:"strstatus",title:t.$t("reportForm.status"),sortable:""}}),e("vxe-table-column",{attrs:{field:"weightStatus",title:t.$t("reportForm.weightStatus"),width:"110",sortable:""}}),e("vxe-table-column",{attrs:{field:"lonLat",title:t.$t("reportForm.lonLat"),width:"130",sortable:""}})],1)],1)]),e("transition",{attrs:{name:"el-zoom-in-bottom"}},[e("div",{directives:[{name:"show",rawName:"v-show",value:t.show,expression:"show"}],staticClass:"transition-box"},[e("el-card",[e("div",{staticStyle:{position:"absolute",right:"10px",top:"0px"}},[e("i",{staticClass:"el-icon-close",staticStyle:{float:"right",padding:"3px 0","font-size":"20px",cursor:"pointer"},on:{click:function(e){t.show=!1}}})]),e("div",{staticStyle:{margin:"10px 0px","white-space":"normal","word-break":"break-all",height:"210px","overflow-y":"auto","font-size":"12px"},domProps:{textContent:t._s(t.messageBody)}})])],1)])],1)},a=[],n=i("5530"),o=(i("14d9"),i("4e82"),i("e9c4"),i("d3b7"),i("159b"),i("2f62")),r=i("d03a"),l=i("d462"),c=i("57c9"),d=function(){var t=this,e=t._self._c;return e("div",{ref:"chartId",staticClass:"full"})},h=[],u=(i("b0c0"),i("43c8")),m=i.n(u),p=i("5aff"),f=i("c276"),g={name:"TimeWeightEcharts",computed:Object(n["a"])({},Object(o["b"])(["isZh","distanceUnit","speedUnit","weightUnit"])),methods:{initChart:function(){var t=this,e=this.$parent;this.disMin=0,this.weights=[],this.veo=[],this.distance=[],this.recvtime=[],this.loadstatuss=[],this.devStates=[],this.chartsIns=m.a.init(this.$refs.chartId),this.chartsIns.setOption(this.getChartsOption(),!0),this.chartsIns.getZr().on("click",(function(i){var s=[i.offsetX,i.offsetY];if(t.chartsIns.containPixel("grid",s)&&t.recvtime.length){var a=t.chartsIns.convertFromPixel({seriesIndex:0},[i.offsetX,i.offsetY])[0];e.scrollToRow(a)}}))},updateChartsOption:function(t){var e=[],i=[],s=[],a=[],n=[],o=[];t.forEach((function(t,r){0==r&&t.totaldistance,e.push(t.weight),a.push(t.statisticsday),s.push(t.totalMileage),i.push(t.speed),n.push(t.weightStatus),o.push(t.strstatus)})),this.weights=e,this.veo=i,this.distance=s,this.recvtime=a,this.loadstatuss=n,this.devStates=o,this.chartsIns.setOption(this.getChartsOption(),!0),this.chartsIns.resize()},getChartsOption:function(){var t=this.$t("reportForm.speed"),e=this.$t("reportForm.mileage"),i=this.$t("reportForm.time"),s=this.$t("reportForm.weight"),a=this.$t("reportForm.status"),o=this.distanceUnit,r=this.speedUnit,l=this.weightUnit;return{title:{text:i+"/"+s,x:"left",textStyle:{fontSize:12,fontWeight:"bolder",color:"#333"}},grid:{x:50,y:40,x2:50,y2:40},tooltip:Object(n["a"])(Object(n["a"])({trigger:"axis"},p["a"]),{},{formatter:function(a){var n="<div>".concat(a[0].name,"</div>");for(var c in a){var d=a[c].seriesName,h=a[c].value;d&&d!=i&&(n+=d==e?Object(f["k"])(p["b"],d,h,o):d==t?Object(f["k"])(p["h"],d,h,r):d==s?Object(f["k"])(p["m"],d,h,l):Object(f["k"])(p["m"],d,h,""))}return'<div style="width:230px">'.concat(n,"</div>")},position:p["j"]}),legend:{data:[t,e,s],x:"center"},toolbox:{show:!1,feature:{magicType:{show:!0,type:["line","bar"]},restore:{show:!0},saveAsImage:{show:!0}},itemSize:14},dataZoom:[{show:!0,realtime:!0,start:0,end:100,height:20,backgroundColor:"#EDEDED",fillerColor:"rgb(54, 72, 96,0.5)",bottom:0},{type:"inside",realtime:!0,start:0,end:100,height:20,bottom:0}],xAxis:{type:"category",boundaryGap:!1,axisLine:{onZero:!1,show:!0},data:this.recvtime,axisPointer:{type:"line",value:"",snap:!1,lineStyle:{color:"#7581BD",width:2},handle:{show:!0,color:"transparent"}}},yAxis:[{name:s+"/"+t,type:"value",nameTextStyle:10,nameGap:5},{name:e,type:"value",nameTextStyle:10,nameGap:2,min:this.disMin,axisLabel:{formatter:"{value}"+o},axisTick:{show:!1}}],series:[{name:i,type:"line",symbol:"none",yAxisIndex:1,color:"#F0805A",smooth:!0,data:this.recvtime},{name:t,type:"line",symbol:"none",yAxisIndex:0,smooth:!0,color:p["h"],data:this.veo},{name:e,type:"line",symbol:"none",yAxisIndex:1,color:p["b"],smooth:!0,data:this.distance},{smooth:!0,name:s,type:"line",symbol:"none",color:p["m"],data:this.weights},{smooth:!0,name:a,type:"line",symbol:"none",color:p["m"],data:this.devStates},{smooth:!0,name:this.$t("reportForm.weightStatus"),type:"line",symbol:"none",color:p["m"],data:this.loadstatuss}]}}},mounted:function(){var t=this;this.$nextTick((function(){t.initChart()}))}},v=g,b=i("2877"),y=Object(b["a"])(v,d,h,!1,null,null,null),w=y.exports,x=i("1c31"),k=i("5101"),F=i("6e52"),$=i("a05b"),C={name:"timeWeight",data:function(){return{deviceid:"",loading:!1,exportLoading1:!1,dateRange:[new Date(Date.now()-864e6),new Date],totalList:[],show:!1,messageBody:""}},mixins:[$["a"]],components:{SingleChoiceVehicle:r["a"],SelectDate:l["a"],QuickTimeRange:c["a"],TimeWeightEcharts:w},computed:Object(n["a"])({},Object(o["b"])(["isZh","singleDeviceid","distanceUnit","speedUnit","weightUnit"])),watch:{dateRange:function(){this.loading||this.handleQuery()},deviceid:function(t){this.setSingleDeviceid(t)}},methods:Object(n["a"])(Object(n["a"])({},Object(o["c"])(["setSingleDeviceid"])),{},{numberToFixed2:f["qb"],scrollToRow:function(t){var e=this.totalList[this.totalList.length-1-t];this.$refs.xTable.setCurrentRow(e),this.$refs.xTable.scrollToRow(e,null)},cellclick:function(t){this.show&&this.cellDblclick(t);var e=t.row,i=t.rowIndex,s=e.updatetimeStr;this.$refs.echartsIns.chartsIns.setOption({xAxis:{axisPointer:{value:s}}});var a=this.totalList.length-i-1;a>0&&this.$refs.echartsIns.chartsIns.dispatchAction({type:"showTip",seriesIndex:2,dataIndex:a})},cellDblclick:function(t){var e=this,i=t.row,s={deviceid:this.deviceid,updatetime:i.updatetime,trackid:i.trackid};Object(x["u"])(s).then((function(t){e.messageBody=JSON.stringify(t.track),e.show=!0}))},handleQuery:function(){var t=this,e=this.deviceid;if(e){var i=this.dateRange,s=k["a"].format(i[0],"yyyy-MM-dd"),a=k["a"].format(i[1],"yyyy-MM-dd"),n={startday:s,endday:a,offset:8,devices:[e]};this.loading=!0,Object(x["qb"])(n).then((function(e){var i=e.records;t.loading=!1;var s=[],a=[];if(i){var n=0;i.forEach((function(t){var e=t.deviceid,i=F["a"].deviceInfos[e].devicename,o=t.records;t.independent;o&&o.sort((function(t,e){return t.updatetime-e.updatetime})),o.forEach((function(t,o){t.deviceid=e,t.devicename=i,0==o&&(n=t.totaldistance),t.lonLat=Object(f["Vb"])(t.callon)+","+Object(f["Vb"])(t.callat),t.speed=Object(f["e"])(t.speed),t.statisticsday=k["a"].longToLocalDateTimeStr(t.updatetime),t.weightStatus=Object(f["H"])(t.loadstatus),t.totalMileage=Object(f["d"])(t.totaldistance-n),t.weight=Object(f["g"])(t.weight/10),s.push(t),a.push(t)}))}))}t.totalList=s.reverse(),t.$refs.echartsIns.updateChartsOption(a)}))}else this.$XModal.message({message:this.$t("tips.selectDevice"),status:"error",zIndex:9999})},exportData:function(){if(this.totalList.length){var t=[[this.$t("reportForm.index"),this.$t("alarm.devName"),this.$t("alarm.devNum"),this.$t("reportForm.time"),this.$t("reportForm.totalMileage")+this.distanceUnit,this.$t("reportForm.weight")+this.weightUnit,this.$t("reportForm.speed")+this.speedUnit,this.$t("reportForm.status"),this.$t("reportForm.weightStatus"),this.$t("reportForm.lonLat")]],e="";this.totalList.forEach((function(i,s){0==s&&(e=i.deviceid);var a=[];a.push(s+1),a.push(i.devicename),a.push(i.deviceid),a.push(i.statisticsday),a.push(Object(f["qb"])(i.totalMileage)),a.push(Object(f["qb"])(i.weight)),a.push(Object(f["qb"])(i.speed)),a.push(i.strstatus),a.push(i.weightStatus),a.push(i.lonLat),t.push(a)}));var i={title:this.$t("reportForm.timeWeight")+"-"+e,data:t};this.exportLoading1=!0,new ExcelCls(i).exportExcel(this)}}}),mounted:function(){this.singleDeviceid&&(this.deviceid=this.singleDeviceid)}},D=C,T=(i("0f70"),Object(b["a"])(D,s,a,!1,null,null,null)),S=T.exports;e["default"]=S},"8d09":function(t,e,i){"use strict";i("a818")},a818:function(t,e,i){}}]);