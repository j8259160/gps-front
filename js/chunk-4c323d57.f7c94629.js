(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4c323d57"],{"0595":function(t,e,a){"use strict";var i=function(){var t=this,e=t._self._c;return e("div",{staticClass:"quick-time-range"},[e("div",{staticClass:"quick-time-range-wrapper"},t._l(t.list,(function(a){return e("div",{key:a.type,style:{color:a.type==t.type?"#409EFF":""},on:{click:function(e){return t.selectDate(a.type)}}},[t._v(t._s(a.label))])})),0),e("div",{staticClass:"quick-time-range-space"}),e("div",{staticClass:"quick-time-range-btn",on:{click:function(e){t.isCollapse=!t.isCollapse}}},[t.isCollapse?e("i",{staticClass:"el-icon-arrow-right"}):e("i",{staticClass:"el-icon-arrow-left"})])])},r=[],s=a("5101"),n={name:"QuickTimeRange",props:{value:{type:Array,default:function(){return[]}},dateType:{type:String,default:"date"}},watch:{isCollapse:function(){this.setList()}},data:function(){return{isCollapse:!0,type:0,list:[]}},methods:{setList:function(){this.isCollapse?this.list=[{label:this.$t("reportForm.toDay"),type:0},{label:this.$t("reportForm.yesterDay"),type:1},{label:this.$t("reportForm.recent3Days"),type:3}]:this.list=[{label:this.$t("reportForm.recent7Days"),type:7},{label:this.$t("reportForm.recent10Days"),type:10},{label:this.$t("reportForm.recent30Days"),type:30}]},selectDate:function(t){var e="datetimerange"==this.dateType,a=[],i=new Date,r=new Date;switch(e&&(i=new Date(s["a"].format(new Date,"yyyy-MM-dd")+" 00:00:00"),r=new Date(s["a"].format(new Date,"yyyy-MM-dd")+" 23:59:59")),t){case 0:a=[new Date(s["a"].format(i,"yyyy-MM-dd")+" 00:00:00"),new Date(s["a"].format(r,"yyyy-MM-dd")+" 23:59:59")];break;case 1:i.setTime(i.getTime()-864e5),r.setTime(r.getTime()-864e5),a=[i,r];break;case 3:i.setTime(i.getTime()-2592e5),a=[i,r];break;case 7:i.setTime(i.getTime()-6048e5),a=[i,r];break;case 10:i.setTime(i.getTime()-864e6),a=[i,r];break;case 30:i.setTime(i.getTime()-2592e6),a=[i,r];break}this.type=t,this.$emit("input",a)}},mounted:function(){var t=this;this.$nextTick((function(){t.setList()}))}},o=n,l=(a("8d09"),a("2877")),c=Object(l["a"])(o,i,r,!1,null,null,null);e["a"]=c.exports},3260:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t._self._c;return e("div",{staticClass:"report-form full"},[e("div",{staticClass:"report-form-inner"},[e("div",{staticClass:"report-form-inner-header",staticStyle:{height:"35px"}},[e("div",{staticClass:"f_left"},[e("MultiChoiceVehicle",{on:{onSelectDevice:t.onSelectDevice}})],1),e("div",{staticClass:"f_left"},[e("SelectDate",{attrs:{dateType:"datetimerange"},model:{value:t.dateRange,callback:function(e){t.dateRange=e},expression:"dateRange"}})],1),e("div",{staticClass:"f_left"},[e("el-button",{attrs:{loading:t.loading,type:"primary"},on:{click:t.handleQuery}},[t._v(t._s(t.$t("common.query")))])],1),e("div",{staticClass:"f_left"},[e("el-popover",{attrs:{placement:"bottom",width:"236",trigger:"click"}},[e("div",[e("el-button",{staticStyle:{width:"100px"},attrs:{slot:"reference",type:"primary",loading:t.exportLoading1,plain:""},on:{click:t.exportData},slot:"reference"},[t._v(t._s(t.$t("common.summary")))]),e("el-button",{staticStyle:{width:"100px"},attrs:{slot:"reference",type:"primary",loading:t.exportLoading2,plain:""},on:{click:t.exportDetailData},slot:"reference"},[t._v(t._s(t.$t("reportForm.detailed")))])],1),e("el-button",{attrs:{slot:"reference",type:"primary"},slot:"reference"},[t._v(t._s(t.$t("common.export")))])],1)],1)]),e("div",{staticClass:"report-form-inner-content",staticStyle:{top:"39px"}},[e("vxe-table",{ref:"xTable",staticClass:"mytable-scrollbar",attrs:{"sort-config":t.sortConfig,"menu-config":t.tableMenu,border:"",resizable:"","auto-resize":"","show-overflow":"","highlight-hover-row":"",size:"mini",height:"auto",data:t.totalList},on:{"menu-click":t.handleClickTableMenu}},[e("vxe-table-column",{attrs:{type:"seq",width:"60",title:t.$t("reportForm.index")}}),e("vxe-table-column",{attrs:{type:"expand",width:"36"},scopedSlots:t._u([{key:"content",fn:function(a){var i=a.row;a.rowIndex;return[[e("div",{staticStyle:{"padding-left":"60px"}},[e("vxe-table",{attrs:{border:"",resizable:"","auto-resize":"","menu-config":t.tableMenu,height:i.tableHeight,"show-overflow":"","highlight-hover-row":"",size:"mini",data:i.days},on:{"menu-click":t.handleClickTableMenu}},[e("vxe-table-column",{attrs:{field:"statisticsday",title:t.$t("reportForm.date"),width:"100",sortable:""}}),e("vxe-table-column",{attrs:{field:"totaldistance",align:"right",formatter:t.numberToFixed2,title:t.$t("reportForm.totalMileage"),width:"120",sortable:""}}),e("vxe-table-column",{attrs:{field:"starttimeStr",title:t.$t("reportForm.startTime"),width:"155",sortable:""}}),e("vxe-table-column",{attrs:{field:"endtimeStr",title:t.$t("reportForm.endTime"),width:"155",sortable:""}}),e("vxe-table-column",{attrs:{field:"mintotaldistance",align:"right",formatter:t.numberToFixed2,title:t.$t("reportForm.startDistance")+t.distanceUnit,sortable:""}}),e("vxe-table-column",{attrs:{field:"maxtotaldistance",align:"right",formatter:t.numberToFixed2,title:t.$t("reportForm.endDistance")+t.distanceUnit,sortable:""}})],1)],1)]]}}])}),e("vxe-table-column",{attrs:{field:"devicename",width:"140",title:t.$t("alarm.devName"),sortable:""}}),e("vxe-table-column",{attrs:{field:"deviceid",width:"140",title:t.$t("alarm.devNum"),sortable:""}}),e("vxe-table-column",{attrs:{field:"creater",title:t.$t("reportForm.creater"),width:"90",sortable:""},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-popover",{attrs:{placement:"bottom",trigger:"click"}},[e("div",{staticClass:"parents-wrapper"},t._l(t.parentsList,(function(a){return e("div",{key:a.username},[t._v(t._s(a.username)+"("+t._s(a.usertypeStr)+")")])})),0),e("el-button",{staticStyle:{color:"#000000"},attrs:{slot:"reference",type:"text"},on:{click:function(e){return t.queryParents(a.row.creater)}},slot:"reference"},[t._v(t._s(a.row.creater))])],1)]}}])}),e("vxe-table-column",{attrs:{field:"groupname",title:t.$t("reportForm.groupName"),width:"90",sortable:""}}),e("vxe-table-column",{attrs:{field:"totaldistance",align:"right",formatter:t.numberToFixed2,width:"102",title:t.$t("reportForm.totalMileage"),sortable:""}}),e("vxe-table-column",{attrs:{field:"useDay",align:"right",title:t.$t("reportForm.usageDay"),width:"110",sortable:""}}),e("vxe-table-column",{attrs:{field:"usageRate",align:"right",title:t.$t("reportForm.usageRate"),width:"102",sortable:""}}),e("vxe-table-column",{attrs:{field:"starttimeStr",title:t.$t("reportForm.startTime"),width:"155",sortable:""}}),e("vxe-table-column",{attrs:{field:"endtimeStr",title:t.$t("reportForm.endTime"),width:"155",sortable:""}}),e("vxe-table-column",{attrs:{field:"startdistance",align:"right",width:"125",formatter:t.numberToFixed2,title:t.$t("reportForm.startDistance")+t.distanceUnit,sortable:""}}),e("vxe-table-column",{attrs:{field:"enddistance",align:"right",width:"125",formatter:t.numberToFixed2,title:t.$t("reportForm.endDistance")+t.distanceUnit,sortable:""}})],1)],1)])])},r=[],s=a("5530"),n=(a("14d9"),a("a9e3"),a("b680"),a("d3b7"),a("159b"),a("4795"),a("e561")),o=a("d462"),l=a("57c9"),c=a("1c31"),d=a("5101"),m=a("6e52"),u=a("2f62"),h=a("4c3c"),p=a("a05b"),f=a("0c87"),b=a("c276"),v={name:"mileageSummary",data:function(){return{loading:!1,exportLoading1:!1,exportLoading2:!1,dateRange:[new Date(d["a"].format(new Date,"yyyy-MM-dd")+" 00:00:00"),new Date(d["a"].format(new Date,"yyyy-MM-dd")+" 23:59:59")],totalList:[]}},mixins:[h["a"],p["a"],f["a"]],components:{MultiChoiceVehicle:n["a"],SelectDate:o["a"],QuickTimeRange:l["a"]},watch:{dateRange:function(){this.loading||this.handleQuery()}},computed:Object(s["a"])({},Object(u["b"])(["isZh","distanceUnit"])),methods:{numberToFixed2:b["qb"],onSelectDevice:function(t){this.deviceids=t},handleQuery:function(){var t=this,e=this.deviceids,a=this.dateRange;if(0!=e.length)if(0!=a.length){var i=d["a"].format(a[0],"yyyy-MM-dd HH:mm:ss"),r=d["a"].format(a[1],"yyyy-MM-dd HH:mm:ss"),s={deviceids:e,begintime:i,endtime:r,offset:d["a"].getOffset()};this.loading=!0,this.queryDetailDateRange=i+"  -  "+r,Object(c["T"])(s).then((function(e){var a=e.records;t.loading=!1;var i=[];a&&a.length>0&&a.forEach((function(t,e){t.index=e+1,0==t.starttime?t.starttimeStr="-":t.starttimeStr=d["a"].longToLocalDateTimeStr(t.starttime),0==t.endtime?t.endtimeStr="-":t.endtimeStr=d["a"].longToLocalDateTimeStr(t.endtime);var a=m["a"].deviceInfos[t.deviceid],r=a?a.devicename:t.deviceid;t.devicename=r,t.creater=m["a"].getShowName(a.creater),t.groupname=a?a.groupname:"",t.enddistance=Object(b["d"])(t.enddistance),t.startdistance=Object(b["d"])(t.startdistance),t.totaldistance=Object(b["d"])(t.totaldistance);var s=0,n=0;t.days.forEach((function(t){t.devicename=r,0==t.starttime?t.starttimeStr="-":t.starttimeStr=d["a"].longToLocalDateTimeStr(t.starttime),0==t.endtime?t.endtimeStr="-":t.endtimeStr=d["a"].longToLocalDateTimeStr(t.endtime),t.maxtotaldistance=Object(b["d"])(t.maxtotaldistance),t.mintotaldistance=Object(b["d"])(t.mintotaldistance),t.totaldistance=Object(b["d"])(t.totaldistance),t.totaldistance>0&&s++,n++})),0==n&&(n=1),t.useDay=s,t.usageRate=(100*Number((s/n).toFixed(2))).toFixed(0)+"%",t.tableHeight=t.days.length>0?36*t.days.length+36:72,i.push(t)})),t.totalList=i,1==i.length&&setTimeout((function(){t.$refs.xTable.setRowExpand(i[0],!0)}),500)}))}else this.$XModal.message({message:this.$t("tips.selectTime"),status:"error",zIndex:9999});else this.$XModal.message({message:this.$t("tips.selectDevice"),status:"error",zIndex:9999})},exportData:function(){if(0!=this.totalList.length){var t=[[this.$t("reportForm.index"),this.$t("alarm.devName"),this.$t("alarm.devNum"),this.$t("reportForm.creater"),this.$t("reportForm.groupName"),this.$t("reportForm.totalMileage")+this.distanceUnit,this.$t("reportForm.usageDay"),this.$t("reportForm.usageRate"),this.$t("reportForm.startTime"),this.$t("reportForm.endTime"),this.$t("reportForm.startDistance")+this.distanceUnit,this.$t("reportForm.endDistance")+this.distanceUnit]];this.totalList.forEach((function(e,a){var i=[];i.push(a+1),i.push(e.devicename),i.push(e.deviceid),i.push(e.creater),i.push(e.groupname),i.push(Object(b["qb"])(e.totaldistance)),i.push(e.useDay),i.push(e.usageRate),i.push(e.starttimeStr),i.push(e.endtimeStr),i.push(Object(b["qb"])(e.startdistance)),i.push(Object(b["qb"])(e.enddistance)),t.push(i)}));var e={title:this.$t("reportForm.mileageSummary"),data:t,dateRange:this.queryDetailDateRange};this.exportLoading1=!0,new ExcelCls(e).exportExcel(this)}},exportDetailData:function(){if(0!=this.totalList.length){var t=[[this.$t("reportForm.index"),this.$t("alarm.devName"),this.$t("alarm.devNum"),this.$t("reportForm.creater"),this.$t("reportForm.groupName"),this.$t("reportForm.totalMileage")+this.distanceUnit,this.$t("reportForm.startTime"),this.$t("reportForm.endTime"),this.$t("reportForm.startDistance")+this.distanceUnit,this.$t("reportForm.endDistance")+this.distanceUnit]],e="",a=this.totalList.length;this.totalList.forEach((function(i){var r=i.devicename,s=i.deviceid,n=i.creater,o=i.groupname,l=i.days;if(1==a&&(e=i.devicename),l.length>0){var c=0;l.forEach((function(e,a){var i=[];c+=Number(e.totaldistance),i.push(a+1),i.push(r),i.push(s),i.push(n),i.push(o),i.push(Object(b["qb"])(e.totaldistance)),i.push(e.starttimeStr),i.push(e.endtimeStr),i.push(Object(b["qb"])(e.mintotaldistance)),i.push(Object(b["qb"])(e.maxtotaldistance)),t.push(i)}));var d=[];d.push(""),d.push(""),d.push(""),d.push(""),d.push(""),d.push(c.toFixed(2)),d.push(""),d.push(""),d.push(""),d.push(""),t.push(d)}}));var i={title:this.$t("missing.mileageList")+(e?" - "+e:""),data:t,dateRange:this.queryDetailDateRange};this.exportLoading2=!0,new ExcelCls(i).exportExcel(this)}}},mounted:function(){this.deviceids=[]}},g=v,y=(a("82f7"),a("2877")),x=Object(y["a"])(g,i,r,!1,null,null,null),D=x.exports;e["default"]=D},"3b13":function(t,e,a){},"57c9":function(t,e,a){"use strict";var i=a("0595");e["a"]=i["a"]},"5fdb":function(t,e,a){},7031:function(t,e,a){"use strict";a("3b13")},"82f7":function(t,e,a){"use strict";a("5fdb")},"8d09":function(t,e,a){"use strict";a("a818")},a818:function(t,e,a){},e561:function(t,e,a){"use strict";var i=a("ea22");e["a"]=i["a"]},ea22:function(t,e,a){"use strict";var i=function(){var t=this,e=t._self._c;return e("div",{staticClass:"multi-choice multi-choice-vehicle"},[e("div",{staticClass:"multi-choice-input"},[e("ZtreeDeviceDropdown",{ref:"ztreeDevice",attrs:{disableShare:t.disableShare,isCheck:"",placeholder:this.$t("tips.selectDevice"),isQueryInitData:t.isQueryInitData,selectDeviceIds:t.multipleDeviceids},on:{onTreeCheck:t.onTreeCheck}})],1)])},r=[],s=a("5530"),n=(a("4795"),a("2f62")),o=a("2df7"),l={name:"MultiChoiceVehicle",props:{disableShare:{type:Boolean,default:!1}},data:function(){return{}},computed:Object(s["a"])({},Object(n["b"])(["isQueryInitData","multipleDeviceids"])),components:{ZtreeDeviceDropdown:o["a"]},methods:Object(s["a"])(Object(s["a"])({},Object(n["c"])(["setMultipleDeviceids"])),{},{onTreeCheck:function(t){this.$emit("onSelectDevice",t),this.setMultipleDeviceids(t)},clearText:function(){var t=this;setTimeout((function(){t.$refs.ztreeDevice.clearText()}),300)}})},c=l,d=(a("7031"),a("2877")),m=Object(d["a"])(c,i,r,!1,null,null,null);e["a"]=m.exports}}]);