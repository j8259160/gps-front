(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7fd6a9cc"],{"1b56":function(e,t,n){},3455:function(e,t,n){"use strict";n("662b")},"662b":function(e,t,n){},"7c4b9":function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e._self._c;return t("div",{staticClass:"report-form full"},[t("div",{staticClass:"report-form-inner"},[t("div",{staticClass:"report-form-inner-header",staticStyle:{height:"35px"}},[t("div",{staticClass:"f_left"},[t("MultiChoiceUserGroup",{attrs:{label:e.$t("common.userGroup")},on:{onSelect:e.onSelect}})],1),t("div",{staticClass:"f_left"},[t("SelectDate",{attrs:{dateType:"date"},model:{value:e.date,callback:function(t){e.date=t},expression:"date"}})],1),t("div",{staticClass:"f_left"},[t("el-button",{attrs:{loading:e.loading,type:"primary"},on:{click:e.handleQuery}},[e._v(e._s(e.$t("common.query")))])],1),t("div",{staticClass:"f_left"},[t("el-button",{attrs:{type:"primary"},on:{click:e.exportData}},[e._v(e._s(e.$t("common.export")))])],1)]),t("div",{staticClass:"report-form-inner-content",staticStyle:{top:"39px"}},[t("vxe-table",{staticClass:"mytable-scrollbar",attrs:{"sort-config":e.sortConfig,"menu-config":e.tableMenu,border:"",resizable:"","auto-resize":"","show-overflow":"","highlight-hover-row":"",size:"mini",height:"auto",data:e.totalList},on:{"menu-click":e.handleClickTableMenu}},[t("vxe-table-column",{attrs:{type:"seq",width:"60",title:e.$t("reportForm.index")}}),t("vxe-table-column",{attrs:{field:"username",title:e.$t("reportForm.creater"),sortable:""}}),t("vxe-table-column",{attrs:{field:"groupname",title:e.$t("reportForm.groupName"),sortable:""}}),t("vxe-table-column",{attrs:{field:"onlineCountAanTotalCount",title:e.$t("reportForm.onlineCountAanTotalCount"),sortable:""}}),t("vxe-table-column",{attrs:{field:"onlineRate",title:e.$t("reportForm.onlineRate"),sortable:""}})],1)],1)])])},i=[],r=(n("14d9"),n("a9e3"),n("b680"),n("d3b7"),n("159b"),n("b0c0"),function(){var e=this,t=e._self._c;return t("LabelWrap",{attrs:{label:e.label}},[t("div",{directives:[{name:"clickoutside",rawName:"v-clickoutside",value:e.handleClickOutside,expression:"handleClickOutside"}],staticClass:"full",staticStyle:{position:"relative"}},[t("div",{staticStyle:{overflow:"hidden"}},[t("el-input",{staticStyle:{height:"31px","line-height":"31px"},attrs:{clearable:"",placeholder:e.placeholder},on:{input:e.onChange},nativeOn:{click:function(t){e.show=!0}},model:{value:e.textVal,callback:function(t){e.textVal=t},expression:"textVal"}})],1),t("div",{directives:[{name:"show",rawName:"v-show",value:e.show,expression:"show"}],staticClass:"el-popover el-popper",staticStyle:{width:"240px",position:"absolute",top:"32px","z-index":"3029"},attrs:{"x-placement":"bottom"}},[t("div",{staticClass:"drop-down-vxetree noselect",staticStyle:{height:"280px",width:"100%"}},[t("vxe-table",{ref:"xTable",staticClass:"mytree-scrollbar",attrs:{height:"100%",size:"mini","show-overflow":"","highlight-hover-row":"","highlight-current-row":"","row-config":e.rowConfig,"auto-resize":!0,border:"none","checkbox-config":{checkStrictly:!1,showHeader:!0},"tree-config":e.treeConfig,"show-header":!1,"scroll-y":{enabled:!0,gt:0},data:e.treeData},on:{"cell-click":e.onClickRow}},[t("vxe-table-column",{attrs:{width:"100%",field:"id"},scopedSlots:e._u([{key:"default",fn:function(n){var a=n.row;return[t("div",{staticClass:"fence-checkbox-cell",style:{paddingLeft:e.getIndent(a)+"px"},on:{contextmenu:function(e){e.preventDefault()}}},[a.children.length?t("span",{staticStyle:{position:"relative",top:"1.5px","padding-right":"3px"},on:{dblclick:function(e){e.stopPropagation()},click:function(t){return t.stopPropagation(),e.onExpandNode(a)}}},[(0==a.children.length?a.expand:e.$refs.xTable.isTreeExpandByRow(a))?t("img",{attrs:{src:e.bihe,width:"12",height:"12"}}):t("img",{attrs:{src:e.zhankai,width:"12",height:"12"}})]):t("span",{staticStyle:{position:"relative",top:"1.5px","padding-right":"3px"}},[t("img",{staticStyle:{visibility:"hidden"},attrs:{src:e.zhankai,width:"12",height:"12"}})]),t("span",{on:{click:function(e){e.stopPropagation()},dblclick:function(e){e.stopPropagation()}}},[t("el-checkbox",{staticStyle:{margin:"0px 3px 0px 2px"},attrs:{indeterminate:a.indeterminate},on:{change:function(t){return e.handleCheckboxChange(a)}},model:{value:a.checked,callback:function(t){e.$set(a,"checked",t)},expression:"row.checked"}})],1),"user"==a.nodeType?t("img",{staticStyle:{width:"16px",height:"16px",border:"0px",position:"relative",top:"3.5px"},attrs:{src:a.icon}}):e._e(),"group"==a.nodeType?t("img",{staticStyle:{width:"15px",height:"14px",border:"0px",position:"relative",top:"2.5px"},attrs:{src:a.icon}}):e._e(),t("span",{staticStyle:{"padding-left":"3px"},domProps:{textContent:e._s(a.name)}})])]}}])})],1)],1),t("div",{staticClass:"popper__arrow",staticStyle:{left:"112.5px"},attrs:{"x-arrow":""}})])])])}),o=[],s=n("b85c"),l=n("5530"),c=(n("99af"),n("4de4"),n("caad"),n("c975"),n("3c65"),n("2532"),n("498a"),n("4795"),n("0139")),d=n("6e52"),h=n("c276"),u=n("2ef0"),p=n("6406"),f=n("9169"),v=n("2f62"),m=n("0d33"),g=n("7fa8"),b=n("0d27"),x=n("8130"),y={name:"MultiChoiceUserGroup",props:{label:{type:String,default:""}},data:function(){return{show:!1,textVal:"",placeholder:"",zhankai:b,bihe:x,rowConfig:{height:24,useKey:"id",keyField:"id"},treeConfig:{transform:!0,showLine:!0,rowField:"id",parentField:"parentId",expandRowKeys:[]},treeData:[]}},components:{LabelWrap:c["a"]},computed:Object(l["a"])(Object(l["a"])({},Object(v["b"])(["isQueryInitData"])),{},{ztreeId:function(){return"ztreeEl_".concat(this._uid)}}),directives:{Clickoutside:f["a"]},methods:{getIndent:function(e){var t=18;return e.level*t},onClickRow:function(e){var t=e.row;t.nodeType==d["a"].NodeType_User?this.onExpandNode(t):(t.checked=!0,this.handleCheckboxChange(t))},handleCheckboxChange:function(e){e.indeterminate=!1,e.children&&this.updateChildren(e,e.checked),this.updateParent(e),this.onTreeCheck(e)},updateChildren:function(e,t){var n=this;e.children.forEach((function(e){(e.checked!==t||e.indeterminate)&&(e.checked=t,e.indeterminate=!1,e.children&&n.updateChildren(e,t))}))},updateParent:function(e){var t=this.findParent(e);if(t){var n=t.children.every((function(e){return e.checked})),a=t.children.every((function(e){return!e.checked&&!e.indeterminate}));n?(t.checked=!0,t.indeterminate=!1):a?(t.checked=!1,t.indeterminate=!1):(t.checked=!1,t.indeterminate=!0),this.updateParent(t)}},findParent:function(e){var t,n=Object(s["a"])(this.treeData);try{for(n.s();!(t=n.n()).done;){var a=t.value,i=this.findParentRecursive(a,e);if(i)return i}}catch(r){n.e(r)}finally{n.f()}return null},findParentRecursive:function(e,t){if(e.children&&e.children.includes(t))return e;if(e.children){var n,a=Object(s["a"])(e.children);try{for(a.s();!(n=a.n()).done;){var i=n.value,r=this.findParentRecursive(i,t);if(r)return r}}catch(o){a.e(o)}finally{a.f()}}return null},onExpandNode:function(e){var t=this.$refs.xTable,n=null;0==e.children.length?(n=!e.expand,e.expand=n):n=!t.isTreeExpandByRow(e),t.setTreeExpand(e,n)},handleClickOutside:function(){this.show=!1},onChange:function(e){""==e&&this.$emit("onSelect",[]),this.searchUser(this,e.trim())},searchUser:Object(u["debounce"])((function(e,t){0==e.show&&(e.show=!0);var n=e.$refs.xTable;if(0==t.length)e.treeData=Object(p["h"])(e.treeNodes),n.reloadData(e.treeData),n.setTreeExpand(e.treeNodes[0],!0);else{e.expandIds={};var a=e.variableDeepSearch(e.treeNodes,t);e.treeData=Object(p["h"])(a);var i=e.treeData.filter((function(t){return e.expandIds[t.id]}));setTimeout((function(){n.setTreeExpand(i,!0)}),100)}}),300),onTreeCheck:function(e){this.placeholder=e.name;var t=[],n="";this.treeData.forEach((function(e){var a=e.nodeType;a==d["a"].NodeType_Group&&e.checked&&(n+=e.name+",",t.push({username:e.username,groupid:e.groupid,groupname:e.name}))})),this.textVal=n,this.$emit("onSelect",t)},ininZtree:function(){var e=this.castUsersTreeToDevicesTree(d["a"].rootuser);this.treeNodes=e,this.treeData=Object(p["h"])(e),this.$refs.xTable.setTreeExpand(e[0],!0)},variableDeepSearch:function(e,t){t=t.toLowerCase();for(var n=[],a=this,i=0;i<e.length;i++){var r=null,o=e[i];if(null!=o){var s=!1;if(-1!=o.name.toLowerCase().indexOf(t)&&(r=Object(u["cloneDeep"])(o),r.open=!1,s=!0),0==s&&o.children&&o.children.length>0){var l=[];o.children.forEach((function(e){l.push(e)}));var c=a.variableDeepSearch(o.children,t);c&&c.length>0&&(r=Object(u["cloneDeep"])(o),r.children=c,r.open=!0,s=!0)}1==s&&(a.expandIds[r.parentId]=!0,n.push(r))}}return n},getDeviceListGroups:function(e,t,n){var a=[],i={groupid:0,name:this.$t("common.defaultGroup"),groupname:this.$t("common.defaultGroup"),icon:g,username:t,id:t+"-0",parentId:t,nodeType:d["a"].NodeType_Group,shared:l,level:n,checked:!1};if(e){for(var r=0;r<e.length;++r){var o=e[r],s=o.groupid>0;if(s){var l=void 0===o.shared?0:o.shared,c=o.groupname,u={groupid:o.groupid,name:c,groupname:c,icon:g,username:t,id:t+"-"+o.groupid,parentId:t,nodeType:d["a"].NodeType_Group,shared:l,level:n,checked:!1};if(this.disableShare&&1==o.shared)continue;a.push(u)}}Object(h["Kb"])(a)}return a.unshift(i),a},castUsersTreeToDevicesTree:function(e){var t={name:"",icon:m,open:!0,nodeType:d["a"].NodeType_User,level:0,checked:!1};if(null!=e){var n=e.username,a=e.subusers,i=e.showname;t.name=n,t.username=n,t.showname=i,t.id=n,t.parentId=null;var r=this.getDeviceListGroups(e.groups,n,t.level+1);if(null!=n&&null!=a&&a.length>0){var o=this.doCastUsersTreeToDevicesTree(a,n,t.level+1);o.length>0&&(t.children=o)}if(r.length){var s=r.concat(t.children?t.children:[]);t.children=s}}return[t]},doCastUsersTreeToDevicesTree:function(e,t,n){var a=[];if(null!=e&&e.length>0)for(var i=0;i<e.length;++i){var r=e[i],o=r.username,s=r.subusers,l=r.showname,c={name:l||o,icon:m,nodeType:d["a"].NodeType_User,username:o,showname:l,id:o,parentId:t,level:n,checked:!1},u=this.getDeviceListGroups(r.groups,o,n+1);if(null!=o&&null!=s&&s.length>0){var p=this.doCastUsersTreeToDevicesTree(s,o,n+1);p.length>0&&(c.children=p)}var f=u.concat(c.children?c.children:[]);f.length>0&&(c.children=f),a.push(c)}return Object(h["Kb"])(a),a}},watch:{isQueryInitData:function(e){e&&this.ininZtree()},value:function(e){this.textVal=e.name}},mounted:function(){var e=this;this.isQueryInitData&&this.ininZtree(),this.$nextTick((function(){e.placeholder=e.$t("bgManage.editUserTitle1")}))}},C=y,w=(n("3455"),n("2877")),k=Object(w["a"])(C,r,o,!1,null,null,null),T=k.exports,D=T,S=n("d462"),$=n("1c31"),_=n("5101"),O=n("4c3c"),R=n("a05b"),N={name:"fleetDayOnline",data:function(){return{loading:!1,date:new Date,totalList:[]}},components:{MultiChoiceUserGroup:D,SelectDate:S["a"]},mixins:[O["a"],R["a"]],methods:{onSelect:function(e){this.userGroups=e},handleQuery:function(){var e=this,t=this.userGroups;if(0!=t.length){this.loading=!0;var n={groups:t,offset:_["a"].getOffset(),daystr:_["a"].format(this.date,"yyyy-MM-dd")};Object($["O"])(n).then((function(t){var n=t.records;n&&n.length?(n.forEach((function(e){0==e.totalcount?(e.onlineCountAanTotalCount="0/0",e.onlineRate="0%"):(e.onlineCountAanTotalCount=e.onlinecount+"/"+e.totalcount,e.onlineRate=100*Number((e.onlinecount/e.totalcount).toFixed(2))+"%")})),e.totalList=n):e.totalList=[],e.loading=!1}))}else this.$XModal.message({message:this.$t("tips.selectDevice"),status:"error",zIndex:9999})},exportData:function(){var e=[[vRoot.$t("reportForm.index"),vRoot.$t("reportForm.creater"),vRoot.$t("monitor.groupName"),vRoot.$t("reportForm.onlineCountAanTotalCount"),vRoot.$t("reportForm.onlineRate")]];this.tableData.forEach((function(t,n){var a=[];a.push(n+1),a.push(t.creater),a.push(t.groupname),a.push(t.onlineCountAanTotalCount),a.push(t.onlineRate),e.push(a)}));var t={title:vRoot.$t("reportForm.vehicleMonthOnline"),data:e,dateRange:this.queryDateRange};new ExcelCls(t).exportExcel(this)}},mounted:function(){this.userGroups=[],this.queryDateRange=null}},E=N,j=(n("96c6"),Object(w["a"])(E,a,i,!1,null,null,null)),I=j.exports;t["default"]=I},"96c6":function(e,t,n){"use strict";n("1b56")}}]);