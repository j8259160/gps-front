(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-fa1f3736"],{"3d3d":function(t,e,i){"use strict";i.r(e);i("498a");var s=function(){var t=this,e=t._self._c;return e("div",{staticClass:"batch-manage set-price full"},[e("div",{staticClass:"batch-manage-left"},[e("div",{staticClass:"batch-manage-inner full"},[e("div",{staticClass:"batch-manage-inner-title"},[e("i",{staticClass:"circle"}),e("b",[t._v(" "+t._s(t.$t("reportForm.selectUser")))])]),e("div",{staticClass:"batch-manage-inner-content"},[e("SearchUserTree",{model:{value:t.username,callback:function(e){t.username=e},expression:"username"}})],1)])]),e("div",{staticClass:"batch-manage-right"},[e("div",{staticClass:"batch-manage-inner-title"},[e("i",{staticClass:"circle"}),e("b",{domProps:{textContent:t._s(t.$t("bgManage.setPrice"))}}),e("b",{domProps:{textContent:t._s(t.username+" ("+t.priceList.length+")")}}),e("div",{staticClass:"batch-manage-btns"},[e("el-button",{directives:[{name:"show",rawName:"v-show",value:!t.isDisabled,expression:"!isDisabled"}],attrs:{type:"primary",size:"mini"},on:{click:t.showBatchSetPrice}},[t._v(t._s(t.$t("bgManage.batchAdjustmentPrices")))])],1)]),e("div",{staticClass:"batch-manage-inner-content",style:{zIndex:t.isDisabled?99:1}},[e("vxe-table",{staticClass:"mytable-scrollbar",attrs:{align:"center",loading:t.loading,border:"",resizable:"","auto-resize":"","show-overflow":"","highlight-current-row":"","highlight-hover-row":"",size:"mini",height:"auto",data:t.priceList}},[e("vxe-table-column",{attrs:{field:"typename",title:t.$t("reportForm.deviceType"),sortable:"",width:"120"}}),e("vxe-table-column",{attrs:{field:"typecode",title:t.$t("bgManage.protocolType"),sortable:"",width:"120"}}),e("vxe-table-column",{attrs:{field:"remark",align:"left",title:t.$t("reportForm.remarks"),sortable:"",width:"200"}}),e("vxe-table-colgroup",{attrs:{title:t.$t("reportForm.oneYear")}},[e("vxe-table-column",{attrs:{field:"price",width:"60"}},[e("template",{slot:"header"},[e("span",{staticStyle:{"font-weight":"400"},domProps:{textContent:t._s(t.$t("common.cost"))}})])],2)],1),e("vxe-table-colgroup",{attrs:{title:t.$t("reportForm.threeYear")}},[e("vxe-table-column",{attrs:{field:"price3",width:"60"}},[e("template",{slot:"header"},[e("span",{staticStyle:{"font-weight":"400"},domProps:{textContent:t._s(t.$t("common.cost"))}})])],2)],1),e("vxe-table-colgroup",{attrs:{title:t.$t("reportForm.fiveYear")}},[e("vxe-table-column",{attrs:{field:"price5",width:"60"}},[e("template",{slot:"header"},[e("span",{staticStyle:{"font-weight":"400"},domProps:{textContent:t._s(t.$t("common.cost"))}})])],2)],1),e("vxe-table-colgroup",{attrs:{title:t.$t("reportForm.tenYear")}},[e("vxe-table-column",{attrs:{field:"price10",width:"60"}},[e("template",{slot:"header"},[e("span",{staticStyle:{"font-weight":"400"},domProps:{textContent:t._s(t.$t("common.cost"))}})])],2)],1),e("vxe-table-column",{attrs:{title:t.$t("common.functions"),width:"300",align:"left"},scopedSlots:t._u([{key:"default",fn:function(i){return t._l(i.row.functionsCheck,(function(i){return e("el-checkbox",{key:i.mask,attrs:{value:!0,label:i.functionname}},[e("span",[t._v(t._s(i.functionname))])])}))}}])})],1)],1),e("div",{staticClass:"batch-manage-inner-content",style:{zIndex:t.isDisabled?1:99}},[e("vxe-table",{staticClass:"mytable-scrollbar",attrs:{align:"center","highlight-current-row":"","highlight-hover-row":"",loading:t.loading,border:"",resizable:"","auto-resize":"","show-overflow":"",size:"mini",height:"auto",data:t.priceList},on:{"cell-dblclick":t.cellDblclick,"checkbox-all":t.selectAllEvent,"checkbox-change":t.selectChangeEvent}},[e("vxe-table-column",{attrs:{type:"checkbox",width:"50",fixed:"left"}}),e("vxe-table-column",{attrs:{title:t.$t("reportForm.action"),width:"70"},scopedSlots:t._u([{key:"default",fn:function(i){return[e("el-button",{attrs:{type:"text"},on:{click:function(e){return t.handleClickRow(i.row)}}},[t._v(t._s(t.$t("common.edit")))])]}}])}),e("vxe-table-column",{attrs:{field:"typename",title:t.$t("reportForm.deviceType"),sortable:"",width:"120"}}),e("vxe-table-column",{attrs:{field:"typecode",title:t.$t("bgManage.protocolType"),sortable:"",width:"120"}}),e("vxe-table-column",{attrs:{field:"remark",align:"left",title:t.$t("reportForm.remarks"),sortable:"",width:"200"}}),e("vxe-table-colgroup",{attrs:{title:t.$t("reportForm.oneYear")}},[e("vxe-table-column",{attrs:{field:"price",width:"70",sortable:""},scopedSlots:t._u([{key:"default",fn:function(i){return[e("span",{domProps:{textContent:t._s(i.row.price)}})]}}])},[e("template",{slot:"header"},[e("span",{staticStyle:{"font-weight":"400"},domProps:{textContent:t._s(t.$t("common.cost"))}})])],2),e("vxe-table-column",{attrs:{field:"customprice",width:"70",sortable:""},scopedSlots:t._u([{key:"default",fn:function(i){return[e("span",{style:{color:i.row.customprice!=i.row.price?"red":"#409EFF"},domProps:{textContent:t._s(i.row.customprice)}})]}}])},[e("template",{slot:"header"},[e("span",{staticStyle:{"font-weight":"400"},domProps:{textContent:t._s(t.$t("common.price"))}})])],2)],1),e("vxe-table-colgroup",{attrs:{title:t.$t("reportForm.threeYear")}},[e("vxe-table-column",{attrs:{field:"price3",width:"70",sortable:""},scopedSlots:t._u([{key:"default",fn:function(i){return[e("span",{domProps:{textContent:t._s(i.row.price3)}})]}}])},[e("template",{slot:"header"},[e("span",{staticStyle:{"font-weight":"400"},domProps:{textContent:t._s(t.$t("common.cost"))}})])],2),e("vxe-table-column",{attrs:{field:"customprice3",width:"70",sortable:""},scopedSlots:t._u([{key:"default",fn:function(i){return[e("span",{style:{color:i.row.customprice3!=i.row.price3?"red":"#409EFF"},domProps:{textContent:t._s(i.row.customprice3)}})]}}])},[e("template",{slot:"header"},[e("span",{staticStyle:{"font-weight":"400"},domProps:{textContent:t._s(t.$t("common.price"))}})])],2)],1),e("vxe-table-colgroup",{attrs:{title:t.$t("reportForm.fiveYear")}},[e("vxe-table-column",{attrs:{field:"price5",width:"70",sortable:""},scopedSlots:t._u([{key:"default",fn:function(i){return[e("span",{domProps:{textContent:t._s(i.row.price5)}})]}}])},[e("template",{slot:"header"},[e("span",{staticStyle:{"font-weight":"400"},domProps:{textContent:t._s(t.$t("common.cost"))}})])],2),e("vxe-table-column",{attrs:{field:"customprice5",width:"70",sortable:""},scopedSlots:t._u([{key:"default",fn:function(i){return[e("span",{style:{color:i.row.customprice5!=i.row.price5?"red":"#409EFF"},domProps:{textContent:t._s(i.row.customprice5)}})]}}])},[e("template",{slot:"header"},[e("span",{staticStyle:{"font-weight":"400"},domProps:{textContent:t._s(t.$t("common.price"))}})])],2)],1),e("vxe-table-colgroup",{attrs:{title:t.$t("reportForm.tenYear")}},[e("vxe-table-column",{attrs:{field:"price10",width:"70",sortable:""},scopedSlots:t._u([{key:"default",fn:function(i){return[e("span",{domProps:{textContent:t._s(i.row.price10)}})]}}])},[e("template",{slot:"header"},[e("span",{staticStyle:{"font-weight":"400"},domProps:{textContent:t._s(t.$t("common.cost"))}})])],2),e("vxe-table-column",{attrs:{field:"customprice10",width:"70",sortable:""},scopedSlots:t._u([{key:"default",fn:function(i){return[e("span",{style:{color:i.row.customprice10!=i.row.price10?"red":"#409EFF"},domProps:{textContent:t._s(i.row.customprice10)}})]}}])},[e("template",{slot:"header"},[e("span",{staticStyle:{"font-weight":"400"},domProps:{textContent:t._s(t.$t("common.price"))}})])],2)],1),e("vxe-table-column",{attrs:{title:t.$t("common.functions"),width:"300",align:"left"},scopedSlots:t._u([{key:"default",fn:function(i){return t._l(i.row.functionsCheck,(function(i){return e("el-checkbox",{key:i.mask,attrs:{value:!0,label:i.functionname}},[e("span",[t._v(t._s(i.functionname))])])}))}}])})],1)],1),e("vxe-modal",{attrs:{title:t.$t("common.adjustPrice")+"-"+t.username+"-"+t.deviceType,value:t.dialogVisible,width:"390px",className:"modal-padding0"},on:{hide:function(e){t.dialogVisible=!1},close:function(e){t.dialogVisible=!1}}},[e("div",{staticClass:"margin_b10"},[e("LabelWrap",{attrs:{label:t.$t("reportForm.oneYear")}},[e("el-row",[e("el-col",{staticStyle:{height:"31px","line-height":"30px","background-color":"#fafafa","border-right":"1px solid #dcdfe6","text-align":"center"},attrs:{span:12}},[t._v(" "+t._s(t.$t("common.cost"))+":"+t._s(t.cost)+" ")]),e("el-col",{attrs:{span:12}},[e("el-input-number",{staticStyle:{width:"100%"},attrs:{min:1,"controls-position":"right"},model:{value:t.price,callback:function(e){t.price=t._n("string"===typeof e?e.trim():e)},expression:"price"}})],1)],1)],1)],1),e("div",{staticClass:"margin_b10"},[e("LabelWrap",{attrs:{label:t.$t("reportForm.threeYear")}},[e("el-row",[e("el-col",{staticStyle:{height:"31px","line-height":"30px","background-color":"#fafafa","border-right":"1px solid #dcdfe6","text-align":"center"},attrs:{span:12}},[t._v(" "+t._s(t.$t("common.cost"))+":"+t._s(t.cost3)+" ")]),e("el-col",{attrs:{span:12}},[e("el-input-number",{staticStyle:{width:"100%"},attrs:{min:1,"controls-position":"right"},model:{value:t.price3,callback:function(e){t.price3=t._n("string"===typeof e?e.trim():e)},expression:"price3"}})],1)],1)],1)],1),e("div",{staticClass:"margin_b10"},[e("LabelWrap",{attrs:{label:t.$t("reportForm.fiveYear")}},[e("el-row",[e("el-col",{staticStyle:{height:"31px","line-height":"30px","background-color":"#fafafa","border-right":"1px solid #dcdfe6","text-align":"center"},attrs:{span:12}},[t._v(" "+t._s(t.$t("common.cost"))+":"+t._s(t.cost5)+" ")]),e("el-col",{attrs:{span:12}},[e("el-input-number",{staticStyle:{width:"100%"},attrs:{min:1,"controls-position":"right"},model:{value:t.price5,callback:function(e){t.price5=t._n("string"===typeof e?e.trim():e)},expression:"price5"}})],1)],1)],1)],1),e("div",{staticClass:"margin_b10"},[e("LabelWrap",{attrs:{label:t.$t("reportForm.tenYear")}},[e("el-row",[e("el-col",{staticStyle:{height:"31px","line-height":"30px","background-color":"#fafafa","border-right":"1px solid #dcdfe6","text-align":"center"},attrs:{span:12}},[t._v(" "+t._s(t.$t("common.cost"))+":"+t._s(t.cost10)+" ")]),e("el-col",{attrs:{span:12}},[e("el-input-number",{staticStyle:{width:"100%"},attrs:{min:1,"controls-position":"right"},model:{value:t.price10,callback:function(e){t.price10=t._n("string"===typeof e?e.trim():e)},expression:"price10"}})],1)],1)],1)],1),e("div",{staticClass:"margin_b10"},[e("el-button-group",[e("el-button",{on:{click:function(e){return t.increaseCost(0)}}},[t._v(t._s(t.$t("common.cost")))]),e("el-button",{on:{click:function(e){return t.increaseCost(1)}}},[t._v(t._s(t.$t("common.cost"))+" +1")]),e("el-button",{on:{click:function(e){return t.increaseCost(2)}}},[t._v(t._s(t.$t("common.cost"))+" +2")]),e("el-button",{on:{click:function(e){return t.increaseCost(3)}}},[t._v(t._s(t.$t("common.cost"))+" +3")]),e("el-button",{on:{click:function(e){return t.increaseCost(4)}}},[t._v(t._s(t.$t("common.cost"))+" +4")])],1)],1),e("div",{staticStyle:{"text-align":"center"}},[e("el-button",{staticStyle:{width:"200px"},attrs:{type:"primary"},on:{click:t.editCustomPrices}},[t._v(t._s(t.$t("common.determine")))])],1)]),e("vxe-modal",{attrs:{title:t.$t("common.adjustPrice")+"-"+t.username+"-"+t.selectList.length,value:t.showBatchdialog,className:"modal-padding0",width:"306px"},on:{hide:function(e){t.showBatchdialog=!1},close:function(e){t.showBatchdialog=!1}}},[e("div",{staticClass:"margin_b10"},[e("LabelWrap",{attrs:{label:t.$t("reportForm.oneYear")}},[e("el-row",[e("el-col",{attrs:{span:24}},[e("el-input-number",{staticStyle:{width:"100%"},attrs:{min:1,"controls-position":"right"},model:{value:t.price,callback:function(e){t.price=t._n("string"===typeof e?e.trim():e)},expression:"price"}})],1)],1)],1)],1),e("div",{staticClass:"margin_b10"},[e("LabelWrap",{attrs:{label:t.$t("reportForm.threeYear")}},[e("el-row",[e("el-col",{attrs:{span:24}},[e("el-input-number",{staticStyle:{width:"100%"},attrs:{min:1,"controls-position":"right"},model:{value:t.price3,callback:function(e){t.price3=t._n("string"===typeof e?e.trim():e)},expression:"price3"}})],1)],1)],1)],1),e("div",{staticClass:"margin_b10"},[e("LabelWrap",{attrs:{label:t.$t("reportForm.fiveYear")}},[e("el-row",[e("el-col",{attrs:{span:24}},[e("el-input-number",{staticStyle:{width:"100%"},attrs:{min:1,"controls-position":"right"},model:{value:t.price5,callback:function(e){t.price5=t._n("string"===typeof e?e.trim():e)},expression:"price5"}})],1)],1)],1)],1),e("div",{staticClass:"margin_b10"},[e("LabelWrap",{attrs:{label:t.$t("reportForm.tenYear")}},[e("el-row",[e("el-col",{attrs:{span:24}},[e("el-input-number",{staticStyle:{width:"100%"},attrs:{min:1,"controls-position":"right"},model:{value:t.price10,callback:function(e){t.price10=t._n("string"===typeof e?e.trim():e)},expression:"price10"}})],1)],1)],1)],1),e("div",{staticStyle:{"text-align":"center"}},[e("el-button",{staticStyle:{width:"200px"},attrs:{type:"primary"},on:{click:t.batchEditCustomPrices}},[t._v(t._s(t.$t("common.determine")))])],1)])],1)])},r=[],o=i("5530"),c=(i("14d9"),i("d3b7"),i("159b"),i("2f62")),a=i("201d"),n=i("28d9"),l=i("e285"),p=i("b562"),u={name:"SetPrice",data:function(){return{loading:!1,dialogVisible:!1,showBatchdialog:!1,username:"",deviceType:"",priceList:[],selectList:[],cost:1,cost3:1,cost5:1,cost10:1,price:1,price3:1,price5:1,price10:1}},components:{LabelWrap:a["a"],SearchUserTree:n["a"]},computed:Object(o["a"])(Object(o["a"])({},Object(c["b"])(["isZh","isQueryInitData","userName"])),{},{ztreeId:function(){return"ztreeEl_".concat(this._uid)},isDisabled:function(){return this.username==this.userName}}),watch:{isQueryInitData:function(t){t&&(this.username=this.userName)},username:function(t){var e=this;null==this.functionsDesc?Object(p["U"])().then((function(i){var s=i.records;e.functionsDesc=s||[],e.queryCustomPrices(t)})):this.queryCustomPrices(t)}},mounted:function(){this.functionsDesc=null,this.isQueryInitData&&(this.username=this.userName)},methods:{batchEditCustomPrices:function(){var t=this,e=this.selectList,i=this.priceList;if(e.length>0){var s={customprices:[]},r=this.price,o=this.price3,c=this.price5,a=this.price10;e.forEach((function(e){s.customprices.push({username:t.username,devicetypeid:e.devicetypeid,price:r,price3:o,price5:c,price10:a})})),Object(l["l"])(s).then((function(e){var s=e.respcustomprices,n=0,l=0;s.forEach((function(e){var s=e.status,p=e.devicetypeprice;0==s?(n++,i.forEach((function(t){t.devicetypeid==p.devicetypeid&&(t.customprice=r,t.customprice3=o,t.customprice5=c,t.customprice10=a)}))):l++,t.showBatchdialog=!1})),t.$XModal.message({message:t.$t("bgManage.adjustSucc")+n+","+t.$t("bgManage.adjustFail")+l,status:s.length==n?"success":"error",zIndex:9999})}))}else this.$XModal.message({message:this.$t("bgManage.selectDeviceTypeBePriced"),status:"error",zIndex:9999})},selectAllEvent:function(t){t.checked;var e=t.records;this.selectList=e},selectChangeEvent:function(t){t.checked;var e=t.records;this.selectList=e},showBatchSetPrice:function(){this.showBatchdialog=!0;var t=this.priceList[0];this.price=t.price,this.price3=t.price3,this.price5=t.price5,this.price10=t.price10},increaseCost:function(t){this.price=this.cost+t,this.price3=this.cost3+t,this.price5=this.cost5+t,this.price10=this.cost10+t},cellDblclick:function(t){this.isEnabled||this.handleClickRow(t.row)},handleClickRow:function(t){this.row=t,this.deviceType=t.typename,this.cost=t.price,this.cost3=t.price3,this.cost5=t.price5,this.cost10=t.price10,this.price=t.customprice,this.price3=t.customprice3,this.price5=t.customprice5,this.price10=t.customprice10,this.dialogVisible=!0},editCustomPrices:function(){var t=this,e=this.row,i={username:this.username,devicetypeid:e.devicetypeid,price:this.price,price3:this.price3,price5:this.price5,price10:this.price10};Object(l["O"])(i).then((function(s){var r=s.status;switch(r){case 0:e.customprice=i.price,e.customprice3=i.price3,e.customprice5=i.price5,e.customprice10=i.price10,t.dialogVisible=!1,t.$XModal.message({message:t.$t("tips.editSucc"),status:"success",zIndex:9999});break;case 1:t.$XModal.message({message:t.$t("tips.editFail")+",1年售价不能低于成本价",status:"error",zIndex:9999});break;case 3:t.$XModal.message({message:t.$t("tips.editFail")+",3年售价不能低于成本价",status:"error",zIndex:9999});break;case 5:t.$XModal.message({message:t.$t("tips.editFail")+",5年售价不能低于成本价",status:"error",zIndex:9999});break;case 10:t.$XModal.message({message:t.$t("tips.editFail")+",10年售价不能低于成本价",status:"error",zIndex:9999});break}})).catch((function(e){t.dialogVisible=!1}))},queryCustomPrices:function(t){var e=this;this.selectList=[],this.priceList=[],this.loading=!0;var i=this.isZh,s={subusername:t},r=!0;Object(l["mb"])(s).then((function(t){var s=t.devicetypeprices;if(s){var o=[];s.forEach((function(t){0==i&&(t.remark=t.remarken),t.priceStr=t.price+"→"+t.customprice,t.priceStr3=t.price3+"→"+t.customprice3,t.priceStr5=t.price5+"→"+t.customprice5,t.priceStr10=t.price10+"→"+t.customprice10,t.functionsCheck=e.getFunctionsLong(t.functionslong),r?99999!=t.price&&o.push(t):o.push(t)})),e.priceList=o}e.loading=!1})).catch((function(){e.loading=!0}))},getFunctionsLong:function(t){for(var e=this.isZh,i=[],s=this.functionsDesc,r=0;r<s.length;++r){var o=s[r],c=o.mask;(c&t)==c&&(0==e&&(o.functionname=o.functionnameen),i.push(o))}return i}}},m=u,d=(i("d764"),i("2877")),h=Object(d["a"])(m,s,r,!1,null,"e5c5d6ae",null),b=h.exports;e["default"]=b},"87e5":function(t,e,i){},d764:function(t,e,i){"use strict";i("87e5")}}]);