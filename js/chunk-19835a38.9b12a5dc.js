(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-19835a38"],{"0f34":function(t,e,a){"use strict";a("67b9")},"202f":function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t._self._c;return e("div",{staticClass:"api-record full"},[e("div",{staticClass:"api-record-header"},[e("div",{staticClass:"f_left",staticStyle:{width:"280px"}},[e("DropdownZtreeUser",{ref:"ztreeUser",attrs:{label:t.$t("reportForm.selectUser")},model:{value:t.searchText,callback:function(e){t.searchText=e},expression:"searchText"}})],1),e("div",{staticClass:"f_left"},[e("div",{staticStyle:{"padding-top":"8px"}},[e("el-checkbox",{model:{value:t.isSub,callback:function(e){t.isSub=e},expression:"isSub"}},[t._v(t._s(t.$t("missing.hasSubordinate")))])],1)]),e("div",{staticClass:"f_left"},[e("LabelWrap",{attrs:{label:t.$t("bgManage.responseTime"),labelWidth:"120px"}},[e("el-select",{staticStyle:{width:"80px"},model:{value:t.duration,callback:function(e){t.duration=e},expression:"duration"}},[e("el-option",{attrs:{label:"0s",value:0}}),e("el-option",{attrs:{label:"1s",value:1}}),e("el-option",{attrs:{label:"2s",value:2}}),e("el-option",{attrs:{label:"3s",value:3}}),e("el-option",{attrs:{label:"4s",value:4}}),e("el-option",{attrs:{label:"5s",value:5}})],1)],1)],1),e("div",{staticClass:"f_left"},[e("SelectDate",{attrs:{label:t.$t("common.selectDate")},model:{value:t.dateRange,callback:function(e){t.dateRange=e},expression:"dateRange"}})],1),e("div",{staticClass:"f_left"},[e("el-button",{staticStyle:{width:"90px"},attrs:{type:"primary",loading:t.loading},on:{click:t.handleClickQuery}},[t._v(t._s(t.$t("common.query")))])],1)]),e("div",{staticClass:"api-record-content",staticStyle:{top:"39px"}},[e("vxe-table",{attrs:{border:"",resizable:"","auto-resize":"","show-overflow":"","highlight-current-row":"",size:"mini",height:"auto",data:t.tableList}},[e("vxe-table-column",{attrs:{type:"seq",width:"60",title:t.$t("reportForm.index")}}),e("vxe-table-column",{attrs:{type:"expand",width:"36"},scopedSlots:t._u([{key:"content",fn:function(a){var s=a.row;a.rowIndex;return[[e("div",{staticStyle:{"padding-left":"60px"}},[e("vxe-table",{staticClass:"mytable-scrollbar",attrs:{border:"",resizable:"","auto-resize":"","show-overflow":"","highlight-hover-row":"",size:"mini",height:s.tableHeight,data:s.detailsList}},[e("vxe-table-column",{attrs:{field:"loginfrom",title:t.$t("bgManage.loginSource"),width:"100"}}),e("vxe-table-column",{attrs:{field:"ip",title:"Ip",width:"120",sortable:""}}),e("vxe-table-column",{attrs:{field:"action",title:"Api",width:"160",sortable:""}}),e("vxe-table-column",{attrs:{field:"version",title:t.$t("bgManage.version"),width:"160",sortable:""}}),e("vxe-table-column",{attrs:{field:"duration",title:t.$t("missing.millisecond"),width:"80",sortable:""}}),e("vxe-table-column",{attrs:{field:"starttimeStr",title:t.$t("reportForm.startTime"),width:"158",sortable:""}}),e("vxe-table-column",{attrs:{field:"params",title:t.$t("missing.params"),sortable:""}})],1)],1)]]}}])}),e("vxe-table-column",{attrs:{field:"username",title:t.$t("login.username"),sortable:""},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-popover",{attrs:{placement:"bottom",trigger:"click"}},[e("div",{staticClass:"parents-wrapper"},t._l(t.parentsList,(function(a){return e("div",{key:a.username},[t._v(t._s(a.username)+"("+t._s(a.usertypeStr)+")")])})),0),e("el-button",{attrs:{slot:"reference",type:"text"},on:{click:function(e){return t.queryParents(a.row.username)}},slot:"reference"},[t._v(t._s(a.row.username))])],1)]}}])}),e("vxe-table-column",{attrs:{field:"queryCount",title:t.$t("missing.queryCount"),sortable:""}})],1)],1)])},r=[],i=a("5530"),l=(a("14d9"),a("4e82"),a("d3b7"),a("159b"),a("2f62")),n=a("e285"),o=a("201d"),c=a("d462"),u=a("c7bc"),d=a("5101"),b=a("c276"),h={name:"ApiRecord",data:function(){return{loading:!1,isSub:!0,searchText:"",dateRange:[new Date,new Date],duration:1,tableList:[],parentsList:[]}},components:{LabelWrap:o["a"],DropdownZtreeUser:u["a"],SelectDate:c["a"]},computed:Object(i["a"])({},Object(l["b"])(["isZh","userName","isQueryInitData"])),watch:{isQueryInitData:function(t){t&&this.$refs.ztreeUser.selectedUser(this.userName)}},methods:{queryParents:function(t){var e=this;this.parentsList=[],Object(n["Bb"])(t).then((function(t){var a=t.status,s=t.records;0==a&&(s.forEach((function(t){t.usertypeStr=Object(b["cb"])(e.isZh,t.usertype)})),e.parentsList=s)}))},handleClickQuery:function(){var t=this;this.cacheObject={};var e=this.dateRange,a=d["a"].format(e[0],"yyyy-MM-dd"),s=d["a"].format(e[1],"yyyy-MM-dd"),r=this.searchText,i=this.cacheObject;if(r){var l={username:r,includesub:this.isSub?1:0,duration:this.duration,offset:d["a"].getOffset(),startday:a,endday:s};this.loading=!0;var o=(document.body.clientHeight||documentElement.clientHeight)-240;Object(n["cc"])(l).then((function(e){var a=e.status,s=e.records,r=e.cause;t.loading=!1;var l=[];if(0==a){if(s){for(var n in s.forEach((function(t){var e=t.username;void 0==i[e]&&(i[e]=[]),t.starttimeStr=d["a"].longToLocalDateTimeStr(t.starttime),i[e].push(t)})),i){var c=i[n],u=0==c.length?72:36*c.length+72;u>o&&(u=o),l.push({username:n,queryCount:c.length,detailsList:c,tableHeight:u})}l.sort((function(t,e){return e.queryCount-t.queryCount}))}}else 1==a?t.$XModal.message({message:t.$t("tips.noPermission"),status:"error",zIndex:9999}):t.$XModal.message({message:t.$t("tips.queryFail")+":"+r,status:"error",zIndex:9999});t.tableList=l}))}else this.$XModal.message({message:this.$t("tips.selectUser"),status:"error",zIndex:9999})}},mounted:function(){var t=this;this.cacheObject={},this.$nextTick((function(){t.isQueryInitData&&t.$refs.ztreeUser.selectedUser(t.userName)}))}},f=h,p=(a("0f34"),a("2877")),m=Object(p["a"])(f,s,r,!1,null,null,null),v=m.exports;e["default"]=v},"67b9":function(t,e,a){}}]);