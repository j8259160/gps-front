(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3ad44d3b"],{"0595":function(t,e,a){"use strict";var i=function(){var t=this,e=t._self._c;return e("div",{staticClass:"quick-time-range"},[e("div",{staticClass:"quick-time-range-wrapper"},t._l(t.list,(function(a){return e("div",{key:a.type,style:{color:a.type==t.type?"#409EFF":""},on:{click:function(e){return t.selectDate(a.type)}}},[t._v(t._s(a.label))])})),0),e("div",{staticClass:"quick-time-range-space"}),e("div",{staticClass:"quick-time-range-btn",on:{click:function(e){t.isCollapse=!t.isCollapse}}},[t.isCollapse?e("i",{staticClass:"el-icon-arrow-right"}):e("i",{staticClass:"el-icon-arrow-left"})])])},r=[],o=a("5101"),l={name:"QuickTimeRange",props:{value:{type:Array,default:function(){return[]}},dateType:{type:String,default:"date"}},watch:{isCollapse:function(){this.setList()}},data:function(){return{isCollapse:!0,type:0,list:[]}},methods:{setList:function(){this.isCollapse?this.list=[{label:this.$t("reportForm.toDay"),type:0},{label:this.$t("reportForm.yesterDay"),type:1},{label:this.$t("reportForm.recent3Days"),type:3}]:this.list=[{label:this.$t("reportForm.recent7Days"),type:7},{label:this.$t("reportForm.recent10Days"),type:10},{label:this.$t("reportForm.recent30Days"),type:30}]},selectDate:function(t){var e="datetimerange"==this.dateType,a=[],i=new Date,r=new Date;switch(e&&(i=new Date(o["a"].format(new Date,"yyyy-MM-dd")+" 00:00:00"),r=new Date(o["a"].format(new Date,"yyyy-MM-dd")+" 23:59:59")),t){case 0:a=[new Date(o["a"].format(i,"yyyy-MM-dd")+" 00:00:00"),new Date(o["a"].format(r,"yyyy-MM-dd")+" 23:59:59")];break;case 1:i.setTime(i.getTime()-864e5),r.setTime(r.getTime()-864e5),a=[i,r];break;case 3:i.setTime(i.getTime()-2592e5),a=[i,r];break;case 7:i.setTime(i.getTime()-6048e5),a=[i,r];break;case 10:i.setTime(i.getTime()-864e6),a=[i,r];break;case 30:i.setTime(i.getTime()-2592e6),a=[i,r];break}this.type=t,this.$emit("input",a)}},mounted:function(){var t=this;this.$nextTick((function(){t.setList()}))}},n=l,s=(a("8d09"),a("2877")),c=Object(s["a"])(n,i,r,!1,null,null,null);e["a"]=c.exports},"06e9":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t._self._c;return e("div",{staticClass:"report-form full"},[e("div",{staticClass:"report-form-inner"},[e("div",{staticClass:"report-form-inner-header",staticStyle:{height:"35px"}},[e("div",{staticClass:"f_left"},[e("MultiChoiceVehicle",{on:{onSelectDevice:t.onSelectDevice}})],1),e("div",{staticClass:"f_left",staticStyle:{width:"170px"}},[e("LabelWrap",{attrs:{label:t.$t("reportForm.parkingDuration")}},[e("el-select",{model:{value:t.interval,callback:function(e){t.interval=e},expression:"interval"}},t._l(t.optionList,(function(t){return e("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1)],1),e("div",{staticClass:"f_left"},[e("SelectDate",{attrs:{dateType:"datetimerange"},model:{value:t.dateRange,callback:function(e){t.dateRange=e},expression:"dateRange"}})],1),e("div",{staticClass:"f_left"},[e("el-button",{attrs:{loading:t.loading,type:"primary"},on:{click:t.handleQuery}},[t._v(t._s(t.$t("common.query")))])],1),e("div",{staticClass:"f_left"},[e("el-popover",{attrs:{placement:"bottom",width:"236",trigger:"click"}},[e("div",[e("el-button",{staticStyle:{width:"100px"},attrs:{slot:"reference",type:"primary",plain:"",loading:t.exportLoading1},on:{click:t.exportData},slot:"reference"},[t._v(t._s(t.$t("common.summary")))]),e("el-button",{staticStyle:{width:"100px"},attrs:{slot:"reference",type:"primary",loading:t.exportLoading2,plain:""},on:{click:t.exportDetailData},slot:"reference"},[t._v(t._s(t.$t("reportForm.detailed")))])],1),e("el-button",{attrs:{slot:"reference",type:"primary"},slot:"reference"},[t._v(t._s(t.$t("common.export")))])],1)],1)]),e("div",{staticClass:"report-form-inner-content",staticStyle:{top:"40px"}},[e("vxe-table",{ref:"xTable",staticClass:"mytable-scrollbar",attrs:{"cell-style":t.cellStyle,border:"","expand-config":{accordion:!1},"sort-config":t.sortConfig,"menu-config":t.tableMenu,data:t.totalList,height:"auto",size:"mini"},on:{"menu-click":t.handleClickTableMenu,"cell-dblclick":t.cellDblclick}},[e("vxe-table-column",{attrs:{type:"seq",width:"60"}}),e("vxe-table-column",{attrs:{type:"expand",width:"36"},scopedSlots:t._u([{key:"content",fn:function(a){var i=a.row;a.rowIndex;return[[e("div",{staticStyle:{"padding-left":"60px"}},[e("vxe-table",{attrs:{"cell-style":t.cellStyle,"sort-config":t.sortConfig,"menu-config":t.tableMenu,"header-cell-style":t.headerCellStyle,border:"",resizable:"","auto-resize":"",height:i.tableHeight,"show-overflow":"","highlight-hover-row":"",size:"mini",data:i.records},on:{"menu-click":t.handleClickTableMenu}},[e("vxe-table-column",{attrs:{type:"seq",width:"60"}}),e("vxe-table-column",{attrs:{field:"date",width:"90",title:t.$t("reportForm.date"),sortable:""}}),e("vxe-table-column",{attrs:{field:"startDate",width:"90",title:t.$t("reportForm.startTime"),sortable:""}}),e("vxe-table-column",{attrs:{field:"endDate",width:"90",title:t.$t("reportForm.endTime"),sortable:""}}),e("vxe-table-column",{attrs:{field:"parkTimeStrNoDay",align:"right",title:t.$t("reportForm.parkingDuration"),width:"120",sortable:""}}),e("vxe-table-column",{attrs:{field:"durationidleStrNoDay",align:"right",title:t.$t("home.idleDuration"),width:"100",sortable:""}}),e("vxe-table-column",{attrs:{field:"outdistance",align:"right",formatter:t.numberToFixed2,title:t.$t("reportForm.outDistance")+t.distanceUnit,width:"120",sortable:""}}),e("vxe-table-column",{attrs:{field:"region",align:"right",title:t.$t("monitor.area"),width:"111"}}),e("vxe-table-column",{attrs:{title:t.$t("reportForm.address")},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-button",{staticStyle:{color:"#000000"},attrs:{type:"text",size:"mini"},on:{click:function(e){return t.handleClickRow(a.row)}}},[t._v(t._s(a.row.address))])]}}],null,!0)})],1)],1)]]}}])}),e("vxe-table-column",{attrs:{field:"devicename",title:t.$t("alarm.devName"),width:"142",sortable:""}}),e("vxe-table-column",{attrs:{field:"deviceid",title:t.$t("alarm.devNum"),width:"142",sortable:""}}),e("vxe-table-column",{attrs:{field:"totalParkTimeNoDay",align:"right",title:t.$t("reportForm.parkingDuration"),width:"120",sortable:""}}),e("vxe-table-column",{attrs:{field:"gTotalDurationIdleNoDay",align:"right",title:t.$t("home.idleDuration"),width:"100",sortable:""}}),e("vxe-table-column",{attrs:{field:"gTotalDistance",align:"right",formatter:t.numberToFixed2,title:t.$t("monitor.mileage")+t.distanceUnit,width:"100",sortable:""}}),e("vxe-table-column",{attrs:{field:"gTotalOil",align:"right",formatter:t.numberToFixed2,title:t.$t("common.oilConsumption"),width:"110",sortable:""}}),e("vxe-table-column",{attrs:{field:"creater",title:t.$t("reportForm.creater"),sortable:""},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-popover",{attrs:{placement:"bottom",trigger:"click"}},[e("div",{staticClass:"parents-wrapper"},t._l(t.parentsList,(function(a){return e("div",{key:a.username},[t._v(t._s(a.username)+"("+t._s(a.usertypeStr)+")")])})),0),e("el-button",{staticStyle:{color:"#000000"},attrs:{slot:"reference",type:"text"},on:{click:function(e){return t.queryParents(a.row.creater)}},slot:"reference"},[t._v(t._s(a.row.creater))])],1)]}}])}),e("vxe-table-column",{attrs:{field:"groupname",title:t.$t("reportForm.groupName"),sortable:""}})],1)],1),e("vxe-modal",{attrs:{title:t.$t("reportForm.seeMap"),className:"modal-padding0",value:t.dialogMap,width:"500"},on:{hide:function(e){t.dialogMap=!1},close:function(e){t.dialogMap=!1}}},[e("div",{staticStyle:{width:"100%",height:"400px"}},[e("ReportMap",{ref:"mapIns"})],1)])],1)])},r=[],o=a("5530"),l=(a("14d9"),a("4e82"),a("a9e3"),a("d3b7"),a("159b"),a("4795"),a("2f62")),n=a("e561"),s=a("d462"),c=a("80f4"),d=a("57c9"),u=a("1c31"),p=a("c276"),m=a("201d"),h=a("5101"),f=a("6e52"),v=a("a05b"),g=a("0c87"),b={name:"parkingReport",data:function(){return{loading:!1,exportLoading1:!1,exportLoading2:!1,tableTitle:"",totalParkTime:"",dialogMap:!1,interval:"3",optionList:[],dateRange:[new Date(h["a"].format(new Date,"yyyy-MM-dd")+" 00:00:00"),new Date(h["a"].format(new Date,"yyyy-MM-dd")+" 23:59:59")],totalList:[],detailsList:[],sortConfig:{sortMethod:function(t){var e=t.data,a=t.sortList,i=a[0],r=i.property,o=i.order,l=[];return l="totalParkTimeNoDay"==r?"desc"===o?e.sort((function(t,e){return e.gTotalParkTime-t.gTotalParkTime})):"asc"===o?e.sort((function(t,e){return t.gTotalParkTime-e.gTotalParkTime})):e.sort():"gTotalDurationIdleNoDay"==r?"desc"===o?e.sort((function(t,e){return e.gtotaldurationidle-t.gtotaldurationidle})):"asc"===o?e.sort((function(t,e){return t.gtotaldurationidle-e.gtotaldurationidle})):e.sort():"durationidleStr"==r?"desc"===o?e.sort((function(t,e){return e.durationidle-t.durationidle})):"asc"===o?e.sort((function(t,e){return t.durationidle-e.durationidle})):e.sort():"parkTimeStr"==r?"desc"===o?e.sort((function(t,e){return e.parktime-t.parktime})):"asc"===o?e.sort((function(t,e){return t.parktime-e.parktime})):e.sort():"totalParkTime"==r?"desc"===o?e.sort((function(t,e){return e.gTotalParkTime-t.gTotalParkTime})):"asc"===o?e.sort((function(t,e){return t.gTotalParkTime-e.gTotalParkTime})):e.sort():"gTotalDurationIdle"==r?"desc"===o?e.sort((function(t,e){return e.gtotaldurationidle-t.gtotaldurationidle})):"asc"===o?e.sort((function(t,e){return t.gtotaldurationidle-e.gtotaldurationidle})):e.sort():"desc"===o?e.sort((function(t,e){var a=e[r]+"";return a.localeCompare(t[r])})):"asc"===o?e.sort((function(t,e){var a=t[r]+"";return a.localeCompare(e[r])})):e.sort(),l}}}},watch:{dateRange:function(){this.loading||this.handleQuery()}},computed:Object(o["a"])({},Object(l["b"])(["singleDeviceid","distanceUnit"])),mixins:[v["a"],g["a"]],components:{MultiChoiceVehicle:n["a"],SelectDate:s["a"],ReportMap:c["a"],QuickTimeRange:d["a"],LabelWrap:m["a"]},methods:{numberToFixed2:p["qb"],cellDblclick:function(t){var e=t.row,a=this.$refs.xTable.isRowExpandByRow(e);this.$refs.xTable.setRowExpand(e,!a)},cellStyle:function(t){var e=t.row,a=(t.rowIndex,t.column),i={};return"gTotalOil"!==a.property&&"outdistance"!==a.property&&"durationidleStr"!==a.property&&"parkTimeStr"!==a.property&&"gTotalDistance"!==a.property||(i.textAlign="right"),void 0!=e.startDate||"outdistance"!==a.property&&"durationidleStr"!==a.property&&"parkTimeStr"!==a.property||(i.color="#275BCF",i.fontWeight="bold"),i},headerCellStyle:function(){return{fontWeight:"400"}},onSelectDevice:function(t){this.deviceids=t},exportDetailData:function(){var t=[[this.$t("alarm.devName"),this.$t("alarm.devNum"),this.$t("reportForm.date"),this.$t("reportForm.startTime"),this.$t("reportForm.endTime"),this.$t("reportForm.parkingDuration")+"(H)",this.$t("reportForm.parkingDuration"),this.$t("home.idleDuration")+"(H)",this.$t("home.idleDuration"),this.$t("reportForm.outDistance")+this.distanceUnit,this.$t("monitor.area"),this.$t("reportForm.address"),this.$t("monitor.coordinate")]];if(0!=this.totalList.length){var e="",a=this.totalList.length;this.totalList.forEach((function(i){if(i.records.forEach((function(i){1==a&&(e=i.devicename);var r=[];r.push(void 0!=i.devicename?i.devicename:""),r.push(void 0!=i.deviceid?i.deviceid:""),r.push(void 0!=i.deviceid?i.date:""),r.push(void 0!=i.startDate?i.startDate:""),r.push(void 0!=i.endDate?i.endDate:""),r.push(void 0!=i.parkTimeStr?i.parkTimeStr:""),r.push(void 0!=i.parkTimeStrNoDay?i.parkTimeStrNoDay:""),r.push(void 0!=i.durationidleStr?Object(p["qb"])(i.durationidleStr):""),r.push(void 0!=i.durationidleStrNoDay?i.durationidleStrNoDay:""),r.push(void 0!=i.outdistance?Object(p["qb"])(i.outdistance):""),r.push(void 0!=i.region?i.region:""),r.push(void 0!=i.address?i.address:""),void 0!=i.callon?r.push(i.callon+","+i.callat):r.push(""),t.push(r)})),0==i.records.length){var r=[];r.push(i.devicename),r.push(i.deviceid),r.push(""),r.push(""),r.push(""),r.push("0"),r.push(""),r.push(""),r.push(""),r.push(""),r.push(""),r.push(""),t.push(r)}r=[];r.push(""),r.push(""),r.push(""),r.push(""),r.push(""),r.push(""),r.push(""),r.push(""),r.push(""),r.push(""),r.push(""),r.push(""),r.push(""),t.push(r)}));var i={title:this.$t("reportForm.parkingReport")+"_"+this.$t("reportForm.detailed")+(e?" - "+e:""),data:t,dateRange:this.queryDetailDateRange};this.exportLoading2=!0,new ExcelCls(i).exportExcel(this)}},exportData:function(){var t=[[this.$t("reportForm.index"),this.$t("alarm.devName"),this.$t("alarm.devNum"),this.$t("reportForm.parkingDuration"),this.$t("home.idleDuration"),this.$t("monitor.mileage")+this.distanceUnit,this.$t("common.oilConsumption"),this.$t("reportForm.creater"),this.$t("reportForm.groupName")]];if(0!=this.totalList.length){this.totalList.forEach((function(e,a){var i=[];i.push(a+1),i.push(e.devicename),i.push(e.deviceid),i.push(e.totalParkTimeNoDay),i.push(e.gTotalDurationIdleNoDay),i.push(Object(p["qb"])(e.gTotalDistance)),i.push(Object(p["qb"])(e.gTotalOil)),i.push(e.creater),i.push(e.groupname),t.push(i)}));var e={title:this.$t("reportForm.parkingReport")+"_"+this.$t("common.summary"),data:t,dateRange:this.queryDetailDateRange};this.exportLoading1=!0,new ExcelCls(e).exportExcel(this)}},handleClickRow:function(t){var e=this;this.dialogMap=!0,setTimeout((function(){e.$refs.mapIns.singleMarkerToMap(t)}),300)},handleQuery:function(){var t=this,e=this.deviceids,a=this.dateRange;if(0!=e.length)if(0!=a.length){var i=h["a"].longToLocalDateTimeStr(a[0].getTime()),r=h["a"].longToLocalDateTimeStr(a[1].getTime()),o={begintime:i,endtime:r,offset:h["a"].getOffset(),deviceids:e,interval:Number(this.interval),needaddress:1};this.loading=!0,this.queryDetailDateRange=null,Object(u["ib"])(o).then((function(e){var a=e.status,o=e.records,l=e.addressmap;t.queryDetailDateRange=i+"  "+r,t.loading=!1;var n=[];0==a?null!=o&&(o.forEach((function(t){var e=t.deviceid,a=f["a"].deviceInfos[e],i=(a.hasFunctions.isHasOil,f["a"].getDeviceNameByDeviceId(e)),r=t.days,o=0,n=0,s=0,c=0;t.devicename=i,t.groupname=a.groupname,t.creater=f["a"].getShowName(a.creater);var d=[];r.forEach((function(t){var a=t.records,r=t.dailydetail,u=r.totaldistance,m=r.totaloil,f=0,v=0,g="";a.forEach((function(t,a){f+=t.durationidle,g=h["a"].format(new Date(t.starttime),"MM-dd");var r=Object(p["L"])(l,t.callat,t.callon),n=Object(p["Vb"])(t.callon),s=Object(p["Vb"])(t.callat),c=t.endtime-t.starttime,u=c/1e3/3600,m=c/1e3/3600;o+=c,v+=c,t.index=a+1,t.devicename=i,t.deviceid=e,t.durationidleStr=t.durationidle/1e3/3600,t.durationidleStrNoDay=Object(p["Qb"])(t.durationidle,!0),t.date=g,t.startDate=h["a"].longToLocalDateTimeStr(t.starttime).split(" ")[1],t.endDate=h["a"].longToLocalDateTimeStr(t.endtime).split(" ")[1],t.parkTime=u,t.parkTimeStr=m,t.parkTimeStrNoDay=Object(p["Qb"])(c,!0),t.parktime=c,t.callon_callat=n+","+s,t.callon=n,t.callat=s,t.address=r,t.outdistance=Object(p["d"])(t.outdistance),d.push(t)})),n+=f,s+=u,c+=m,d.push({devicename:i,deviceid:e,date:g,outdistance:Object(p["d"])(u),parkTimeStr:v/1e3/3600,durationidleStr:f/1e3/3600,parkTimeStrNoDay:Object(p["Qb"])(v,!0),durationidleStrNoDay:Object(p["Qb"])(f,!0)})})),t.records=d,t.count=d.length,0==t.count?t.tableHeight=72:t.tableHeight=36*t.count+36,t.gTotalParkTime=o,t.totalParkTime=o/1e3/3600,t.totalParkTimeNoDay=Object(p["Qb"])(o,!0),t.gtotaldurationidle=n,t.gTotalDurationIdle=n/1e3/3600,t.gTotalDurationIdleNoDay=Object(p["Qb"])(n,!0),t.gTotalDistance=Object(p["d"])(s),t.gTotalOil=c/100})),n=o):1==a?t.$XModal.message({message:t.$t("tips.deviceExceeds100"),status:"error",zIndex:9999}):2==a&&t.$XModal.message({message:t.$t("tips.dayExceeds2"),status:"error",zIndex:9999}),t.totalList=n,1==n.length&&setTimeout((function(){t.$refs.xTable.setRowExpand(n[0],!0)}),500)}))}else this.$XModal.message({message:this.$t("tips.selectTime"),status:"error",zIndex:9999});else this.$XModal.message({message:this.$t("tips.selectDevice"),status:"error",zIndex:9999})}},mounted:function(){var t=this;this.deviceids=[],this.$nextTick((function(){t.optionList=[{label:"1"+t.$t("monitor.minute"),value:"1"},{label:"3"+t.$t("monitor.minute"),value:"3"},{label:"5"+t.$t("monitor.minute"),value:"5"},{label:"10"+t.$t("monitor.minute"),value:"10"},{label:"20"+t.$t("monitor.minute"),value:"20"},{label:"30"+t.$t("monitor.minute"),value:"30"},{label:"40"+t.$t("monitor.minute"),value:"40"},{label:"50"+t.$t("monitor.minute"),value:"50"},{label:"1"+t.$t("monitor.hour"),value:"60"},{label:"2"+t.$t("monitor.hour"),value:"120"}],t.singleDeviceid&&(t.deviceid=t.singleDeviceid)}))}},y=b,D=(a("66ef"),a("2877")),T=Object(D["a"])(y,i,r,!1,null,null,null),k=T.exports;e["default"]=k},"2a7c":function(t,e,a){},"3b13":function(t,e,a){},"57c9":function(t,e,a){"use strict";var i=a("0595");e["a"]=i["a"]},"66ef":function(t,e,a){"use strict";a("2a7c")},7031:function(t,e,a){"use strict";a("3b13")},"80f4":function(t,e,a){"use strict";var i=a("32eb");e["a"]=i["a"]},"8d09":function(t,e,a){"use strict";a("a818")},a818:function(t,e,a){},e561:function(t,e,a){"use strict";var i=a("ea22");e["a"]=i["a"]},ea22:function(t,e,a){"use strict";var i=function(){var t=this,e=t._self._c;return e("div",{staticClass:"multi-choice multi-choice-vehicle"},[e("div",{staticClass:"multi-choice-input"},[e("ZtreeDeviceDropdown",{ref:"ztreeDevice",attrs:{disableShare:t.disableShare,isCheck:"",placeholder:this.$t("tips.selectDevice"),isQueryInitData:t.isQueryInitData,selectDeviceIds:t.multipleDeviceids},on:{onTreeCheck:t.onTreeCheck}})],1)])},r=[],o=a("5530"),l=(a("4795"),a("2f62")),n=a("2df7"),s={name:"MultiChoiceVehicle",props:{disableShare:{type:Boolean,default:!1}},data:function(){return{}},computed:Object(o["a"])({},Object(l["b"])(["isQueryInitData","multipleDeviceids"])),components:{ZtreeDeviceDropdown:n["a"]},methods:Object(o["a"])(Object(o["a"])({},Object(l["c"])(["setMultipleDeviceids"])),{},{onTreeCheck:function(t){this.$emit("onSelectDevice",t),this.setMultipleDeviceids(t)},clearText:function(){var t=this;setTimeout((function(){t.$refs.ztreeDevice.clearText()}),300)}})},c=s,d=(a("7031"),a("2877")),u=Object(d["a"])(c,i,r,!1,null,null,null);e["a"]=u.exports}}]);