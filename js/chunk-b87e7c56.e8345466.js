(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-b87e7c56"],{"0595":function(e,t,a){"use strict";var i=function(){var e=this,t=e._self._c;return t("div",{staticClass:"quick-time-range"},[t("div",{staticClass:"quick-time-range-wrapper"},e._l(e.list,(function(a){return t("div",{key:a.type,style:{color:a.type==e.type?"#409EFF":""},on:{click:function(t){return e.selectDate(a.type)}}},[e._v(e._s(a.label))])})),0),t("div",{staticClass:"quick-time-range-space"}),t("div",{staticClass:"quick-time-range-btn",on:{click:function(t){e.isCollapse=!e.isCollapse}}},[e.isCollapse?t("i",{staticClass:"el-icon-arrow-right"}):t("i",{staticClass:"el-icon-arrow-left"})])])},r=[],s=a("5101"),o={name:"QuickTimeRange",props:{value:{type:Array,default:function(){return[]}},dateType:{type:String,default:"date"}},watch:{isCollapse:function(){this.setList()}},data:function(){return{isCollapse:!0,type:0,list:[]}},methods:{setList:function(){this.isCollapse?this.list=[{label:this.$t("reportForm.toDay"),type:0},{label:this.$t("reportForm.yesterDay"),type:1},{label:this.$t("reportForm.recent3Days"),type:3}]:this.list=[{label:this.$t("reportForm.recent7Days"),type:7},{label:this.$t("reportForm.recent10Days"),type:10},{label:this.$t("reportForm.recent30Days"),type:30}]},selectDate:function(e){var t="datetimerange"==this.dateType,a=[],i=new Date,r=new Date;switch(t&&(i=new Date(s["a"].format(new Date,"yyyy-MM-dd")+" 00:00:00"),r=new Date(s["a"].format(new Date,"yyyy-MM-dd")+" 23:59:59")),e){case 0:a=[new Date(s["a"].format(i,"yyyy-MM-dd")+" 00:00:00"),new Date(s["a"].format(r,"yyyy-MM-dd")+" 23:59:59")];break;case 1:i.setTime(i.getTime()-864e5),r.setTime(r.getTime()-864e5),a=[i,r];break;case 3:i.setTime(i.getTime()-2592e5),a=[i,r];break;case 7:i.setTime(i.getTime()-6048e5),a=[i,r];break;case 10:i.setTime(i.getTime()-864e6),a=[i,r];break;case 30:i.setTime(i.getTime()-2592e6),a=[i,r];break}this.type=e,this.$emit("input",a)}},mounted:function(){var e=this;this.$nextTick((function(){e.setList()}))}},n=o,l=(a("8d09"),a("2877")),c=Object(l["a"])(n,i,r,!1,null,null,null);t["a"]=c.exports},"34d6":function(e,t,a){"use strict";a("53e8")},"53e8":function(e,t,a){},"57c9":function(e,t,a){"use strict";var i=a("0595");t["a"]=i["a"]},"8d09":function(e,t,a){"use strict";a("a818")},a749:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e._self._c;return t("div",{staticClass:"report-form full"},[t("div",{staticClass:"report-form-inner"},[t("div",{staticClass:"report-form-inner-header",staticStyle:{height:"35px"}},[t("div",{staticClass:"f_left"},[t("SingleChoiceVehicle",{attrs:{placeholder:this.$t("tips.selectSingleDevice"),width:"230px"},model:{value:e.deviceid,callback:function(t){e.deviceid=t},expression:"deviceid"}})],1),t("div",{staticClass:"f_left"},[t("SelectDate",{model:{value:e.dateRange,callback:function(t){e.dateRange=t},expression:"dateRange"}})],1),t("div",{staticClass:"f_left"},[t("QuickTimeRange",{model:{value:e.dateRange,callback:function(t){e.dateRange=t},expression:"dateRange"}})],1),t("div",{staticClass:"f_left"},[t("el-button",{attrs:{loading:e.loading,type:"primary"},on:{click:e.handleQuery}},[e._v(e._s(e.$t("common.query")))])],1),t("div",{staticClass:"f_left"},[t("el-button",{attrs:{type:"primary",loading:e.exportLoading1},on:{click:e.exportData}},[e._v(e._s(e.$t("common.export")))])],1)]),t("div",{staticClass:"report-form-inner-content",staticStyle:{top:"39px"}},[t("vxe-table",{attrs:{"sort-config":e.sortConfig,"menu-config":e.tableMenu,border:"",resizable:"","auto-resize":"","show-overflow":"","highlight-hover-row":"",size:"mini",height:"auto",data:e.totalList},on:{"menu-click":e.handleClickTableMenu}},[t("vxe-table-column",{attrs:{type:"seq",width:"60",title:e.$t("reportForm.index")}}),t("vxe-table-column",{attrs:{field:"devicename",width:"140",title:e.$t("alarm.devName"),sortable:""}}),t("vxe-table-column",{attrs:{field:"deviceid",width:"140",title:e.$t("alarm.devNum"),sortable:""}}),t("vxe-table-column",{attrs:{field:"creater",title:e.$t("reportForm.creater"),width:"100",sortable:""},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-popover",{attrs:{placement:"bottom",trigger:"click"}},[t("div",{staticClass:"parents-wrapper"},e._l(e.parentsList,(function(a){return t("div",{key:a.username},[e._v(e._s(a.username)+"("+e._s(a.usertypeStr)+")")])})),0),t("el-button",{staticStyle:{color:"#000000"},attrs:{slot:"reference",type:"text"},on:{click:function(t){return e.queryParents(a.row.creater)}},slot:"reference"},[e._v(e._s(a.row.creater))])],1)]}}])}),t("vxe-table-column",{attrs:{field:"groupname",title:e.$t("reportForm.groupName"),width:"100",sortable:""}}),t("vxe-table-column",{attrs:{field:"fileext",title:e.$t("reportForm.fileType"),sortable:""}}),t("vxe-table-column",{attrs:{field:"channelid",title:e.$t("reportForm.channel"),width:"80",sortable:""}}),t("vxe-table-column",{attrs:{field:"eventcodeStr",title:e.$t("alarm.alarmType"),sortable:""}}),t("vxe-table-column",{attrs:{field:"endtimeStr",title:e.$t("reportForm.time"),sortable:""}}),t("vxe-table-column",{attrs:{field:"address",title:e.$t("reportForm.address"),sortable:""}}),t("vxe-table-column",{attrs:{field:"usertype",title:e.$t("reportForm.action"),width:"150",sortable:""},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{attrs:{type:"text"},on:{click:function(t){return e.handleSeeMap(a)}}},[e._v(e._s(e.$t("reportForm.seeMap")))]),t("el-button",{attrs:{type:"text"},on:{click:function(t){return e.handleSeeImages(a)}}},[e._v(e._s(e.$t("reportForm.seeImg")))])]}}])})],1)],1)]),t("vxe-modal",{attrs:{title:e.$t("reportForm.seeMap"),className:"modal-padding0",value:e.mapDialog,width:"560px"},on:{hide:function(t){e.mapDialog=!1},close:function(t){e.mapDialog=!1}}},[t("div",{staticStyle:{width:"100%",height:"400px"}},[t("ReportMap",{ref:"mapIns"})],1)]),t("PhotographDialog",{attrs:{imageUrl:e.imageUrl,deviceName:e.deviceName},model:{value:e.photographDialog,callback:function(t){e.photographDialog=t},expression:"photographDialog"}})],1)},r=[],s=a("5530"),o=(a("99af"),a("14d9"),a("4e82"),a("d3b7"),a("159b"),a("4795"),a("2f62")),n=a("d03a"),l=a("d462"),c=a("57c9"),d=a("5101"),u=a("6e52"),m=a("32eb"),p=a("1c31"),h=a("ec6a"),f=a("c276"),v=a("4c3c"),g=a("a05b"),y=a("0c87"),b={name:"multiMedia",data:function(){return{loading:!1,mapDialog:!1,exportLoading1:!1,deviceid:"",photographDialog:!1,dateRange:[new Date,new Date],totalList:[],imageUrl:"",deviceName:""}},mixins:[v["a"],g["a"],y["a"]],components:{SingleChoiceVehicle:n["a"],SelectDate:l["a"],QuickTimeRange:c["a"],ReportMap:m["a"],PhotographDialog:h["a"]},computed:Object(s["a"])({},Object(o["b"])(["isZh","singleDeviceid"])),watch:{dateRange:function(){this.loading||this.handleQuery()},deviceid:function(e){this.setSingleDeviceid(e)}},methods:Object(s["a"])(Object(s["a"])({},Object(o["c"])(["setSingleDeviceid"])),{},{handleSeeMap:function(e){var t=this,a=e.row;this.mapDialog=!0,setTimeout((function(){t.$refs.mapIns.singleMarkerToMap(a)}),300)},handleSeeImages:function(e){var t=e.row;this.deviceName=t.devicename,this.imageUrl=t.url,this.photographDialog=!0},onSelectDevice:function(e){this.deviceids=e},exportData:function(){if(0!=this.totalList.length){var e=[[this.$t("reportForm.index"),this.$t("alarm.devName"),this.$t("alarm.devNum"),this.$t("reportForm.creater"),this.$t("reportForm.groupName"),this.$t("reportForm.fileType"),this.$t("reportForm.channel"),this.$t("alarm.alarmType"),this.$t("reportForm.time"),this.$t("reportForm.address"),this.$t("monitor.coordinate")]],t="",a="";this.totalList.forEach((function(i,r){var s=[];t=i.devicename,a=i.deviceid,s.push(i.index),s.push(i.devicename),s.push(i.deviceid),s.push(i.creater),s.push(i.groupname),s.push(i.fileext),s.push(i.channelid),s.push(i.eventcodeStr),s.push(i.endtimeStr),s.push(i.address),s.push(i.callon+","+i.callat),e.push(s)}));var i={title:this.$t("reportForm.multiMedia")+" ".concat(t,"-").concat(a),data:e,dateRange:this.queryDateRange};this.exportLoading1=!0,new ExcelCls(i).exportExcel(this)}},handleQuery:function(){var e=this,t=this.deviceid;if(""!=t){var a=this.dateRange;if(0==a.length)return void this.$XModal.message({message:this.$t("tips.selectTime"),status:"error",zIndex:9999});this.loading=!0;var i=d["a"].format(a[0],"yyyy-MM-dd"),r=d["a"].format(a[1],"yyyy-MM-dd"),s={startday:i,endday:r,offset:d["a"].getOffset(),deviceids:[t]};Object(p["U"])(s).then((function(t){var a=t.status,s=t.records,o=t.addressmap;e.queryDateRange=i+" "+r;var n=[];if(0==a){var l=0;s.forEach((function(t,a){var i=t.deviceid,r=u["a"].deviceInfos[i];t.records.forEach((function(t){t.index=++l,t.deviceid=i,t.address=Object(f["L"])(o||{},t.callat,t.callon),t.endtimeStr=d["a"].longToLocalDateTimeStr(t.endtime),t.eventcodeStr=e.getEventcodeStr(t),t.devicename=r.devicename,t.creater=u["a"].getShowName(r.creater),t.groupname=r.groupname,n.push(t)}))})),n.sort((function(e,t){return t.endtime-e.endtime})),e.totalList=n}else e.totalList=[];e.loading=!1})).catch((function(t){console.log(t),e.loading=!1}))}else this.$XModal.message({message:this.$t("tips.selectDevice"),status:"error",zIndex:9999})},getEventcodeStr:function(e){var t=e.eventcode,a="";switch(t){case 0:a=this.$t("alarm.terraceIssued");break;case 1:a=this.$t("alarm.timingAction");break;case 2:a=this.$t("alarm.robberyReport");break;case 3:a=this.$t("alarm.impactRollover");break;default:a=this.$t("alarm.retain")}return a}}),mounted:function(){this.deviceids=[],this.singleDeviceid&&(console.log(this.singleDeviceid),this.deviceid=this.singleDeviceid)}},w=b,x=(a("34d6"),a("2877")),$=Object(x["a"])(w,i,r,!1,null,null,null),D=$.exports;t["default"]=D},a818:function(e,t,a){},ec6a:function(e,t,a){"use strict";var i=function(){var e=this,t=e._self._c;return t("vxe-modal",{attrs:{title:e.dialogTitle,value:e.value,className:"modal-padding0",width:"480px"},on:{hide:e.handleClose,close:e.handleClose}},[t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.show,expression:"show"}],staticStyle:{height:"290px"}},[e.show?e._e():t("img",{staticStyle:{width:"100%",height:"280px"},attrs:{src:e.imageUrl}})]),t("el-row",[t("el-col",{attrs:{span:6,offset:4}},[t("el-button",{staticStyle:{width:"100%"},attrs:{size:"mini",type:"primary"},on:{click:e.downloadImg}},[e._v(e._s(e.$t("videoback.download")))])],1),t("el-col",{attrs:{span:6,offset:4}},[t("el-button",{staticStyle:{width:"100%"},attrs:{size:"mini"},on:{click:e.handleClose}},[e._v(e._s(e.$t("device.close")))])],1)],1)],1)},r=[],s=(a("99af"),{name:"PhotographDialog",props:{value:{type:Boolean,default:!1},imageUrl:{type:String,default:""},deviceName:{type:String,default:""}},data:function(){return{show:!0}},watch:{value:function(e){var t=this;if(e){var a=new Image;a.onload=function(){t.show=!1},a.src=this.imageUrl}else this.show=!0}},computed:{dialogTitle:function(){return"".concat(this.$t("monitor.photograph")," - ").concat(this.deviceName)}},methods:{handleClose:function(){this.$emit("input",!1)},downloadImg:function(){this.imageUrl&&window.open(this.imageUrl)}}}),o=s,n=a("2877"),l=Object(n["a"])(o,i,r,!1,null,null,null);t["a"]=l.exports}}]);