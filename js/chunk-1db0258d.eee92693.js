(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1db0258d"],{1141:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t._self._c;return e("div",{staticClass:"stock-devices full"},[e("div",{staticClass:"stock-devices-header"},[e("div",{staticClass:"f_left",staticStyle:{width:"210px"}},[e("LabelWrap",{attrs:{label:t.$t("bgManage.queryDevice")}},[e("el-input",{attrs:{clearable:"",placeholder:this.$t("bgManage.pleaseEnterSearchDeviceid")},model:{value:t.queryText,callback:function(e){t.queryText=e},expression:"queryText"}})],1)],1),e("div",{staticClass:"f_left",staticStyle:{"margin-left":"10px"}},[e("el-button",{attrs:{type:"primary",loading:t.loading},on:{click:t.handleQuery}},[t._v(t._s(t.$t("common.query")))])],1),e("div",{staticClass:"f_left",staticStyle:{"margin-left":"10px"}},[e("el-button",{attrs:{type:"primary",loading:t.exportLoading},on:{click:t.exportAll}},[t._v(t._s(t.$t("device.exportAllDevice")))])],1),e("div",{staticClass:"f_right",staticStyle:{"margin-left":"10px"}},[e("el-button",{attrs:{type:"danger"},on:{click:function(e){t.isAdd=!1,t.dialog=!0}}},[t._v(t._s(t.$t("missing.batchDelete")))])],1),e("div",{staticClass:"f_right",staticStyle:{"margin-left":"10px"}},[e("el-button",{attrs:{type:"primary"},on:{click:function(e){t.isAdd=!0,t.dialog=!0}}},[t._v(t._s(t.$t("bgManage.batchAdd")))])],1)]),e("div",{staticClass:"stock-devices-body"},[e("div",{staticClass:"stock-devices-body-table"},[e("vxe-table",{staticClass:"mytable-scrollbar",attrs:{border:"","menu-config":t.tableMenu,resizable:"","auto-resize":"","show-overflow":"","highlight-current-row":"","highlight-hover-row":"",size:"mini",height:"auto",data:t.tableList},on:{"menu-click":t.handleClickTableMenu}},[e("vxe-table-column",{attrs:{title:t.$t("reportForm.action"),width:"80",align:"center"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("div",{staticStyle:{"padding-top":"6px"}},[e("el-popconfirm",{attrs:{placement:"top",icon:"el-icon-info","icon-color":"red","confirm-button-text":t.$t("common.confirm"),"cancel-button-text":t.$t("common.cancel"),title:t.$t("tips.confirmDelete")},on:{confirm:function(e){return t.handleDelete(a)}}},[e("span",{attrs:{slot:"reference"},slot:"reference"},[e("img",{staticStyle:{width:"16px",cursor:"pointer"},attrs:{src:t.deleteIcon}})])])],1)]}}])}),e("vxe-table-column",{attrs:{type:"seq",width:"60",title:t.$t("reportForm.index")}}),e("vxe-table-column",{attrs:{field:"deviceid",title:t.$t("alarm.devNum")}}),e("vxe-table-column",{attrs:{field:"addtimeStr",title:t.$t("reportForm.addTime")}})],1)],1),e("div",{staticClass:"stock-devices-body-page"},[e("el-pagination",{attrs:{currentPage:t.currentPage,"current-page":t.currentChangePage,"page-sizes":[20,40,60,80,100],"page-size":t.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:t.totalcount},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1)]),e("vxe-modal",{attrs:{title:t.isAdd?t.$t("bgManage.batchAdd"):t.$t("missing.batchDelete"),className:"modal-padding0",value:t.dialog,width:"620px"},on:{hide:function(e){t.dialog=!1},close:function(e){t.dialog=!1}}},[e("TextareaIds",{ref:"textareaIds",attrs:{showTips:"",textPlaceholder:t.$t("tips.textareaidsOneid")},on:{"on-change":t.onChangeIds}}),e("el-row",[e("el-col",{staticStyle:{"text-align":"center"},attrs:{span:8,offset:8}},[t.isAdd?e("el-button",{staticStyle:{width:"200px"},attrs:{type:"primary",loading:t.addLoading},on:{click:t.handleSubmit}},[t._v(t._s(t.$t("common.add")))]):e("el-button",{staticStyle:{width:"200px"},attrs:{type:"primary",loading:t.addLoading},on:{click:t.handleBatchDelete}},[t._v(t._s(t.$t("common.delete")))])],1)],1)],1)],1)},n=[],s=(a("d81d"),a("14d9"),a("d3b7"),a("159b"),a("4795"),a("9c0e1")),o=a("0139"),r=a("e285"),c=a("5101"),d=a("a05b"),l=a("e173"),u={name:"StockDevices",data:function(){return{deleteIcon:l,isAdd:!1,dialog:!1,loading:!1,addLoading:!1,exportLoading:!1,queryText:"",currentPage:1,pageSize:20,totalcount:0,tableList:[]}},components:{TextareaIds:s["a"],LabelWrap:o["a"]},mounted:function(){this.deviceids=[],this.queryStockDevices()},watch:{dialog:function(t){0==t&&this.$refs.textareaIds.handleClear()}},mixins:[d["a"]],methods:{exportAll:function(){var t=this,e=[[this.$t("reportForm.index"),this.$t("alarm.devNum"),this.$t("reportForm.addTime")]];this.exportLoading=!0,Object(r["Ob"])({all:!0}).then((function(a){var i=a.devices;i.forEach((function(t,a){t.addtimeStr=c["a"].longToLocalDateTimeStr(t.addtime);var i=[];i.push(++a),i.push(t.deviceid),i.push(t.addtimeStr),e.push(i)}));var n={title:t.$t("bgManage.deviceList"),data:e,dateRange:null,exportMaxLength:1e5};new ExcelCls(n).exportExcel(t),t.exportLoading=!1}))},handleSubmit:function(){var t=this,e=this.$refs.textareaIds;e.immediatelyMatching();var a=this.deviceids;this.addLoading=!0,Object(r["h"])(a).then((function(a){0==a.status&&setTimeout((function(){t.addLoading=!1;var i=a.errorrecords;if(0==i.length)e.isOk=!0,e.errorTips=t.$t("tips.addSucc"),t.queryStockDevices();else{e.isOk=!1;var n="";i.forEach((function(t){n+=t.deviceid+": "+t.cause+"\n"})),e.errorTips=n}}),1e3)}))},handleDelete:function(t){var e=this;Object(r["J"])([t.row.deviceid]).then((function(a){var i=a.status,n=a.cause;0==i?(e.$delete(e.tableList,t.rowIndex),e.totalcount--):e.$XModal.message({message:n,status:"error",zIndex:9999})}))},handleBatchDelete:function(){var t=this,e=this.$refs.textareaIds,a=this.deviceids;a.length&&(this.addLoading=!0,Object(r["J"])(a).then((function(a){var i=a.status,n=a.cause;0==i?(t.$XModal.message({message:t.$t("tips.deleteSucc"),status:"success",zIndex:9999}),t.dialog=!1,e.handleClear(),t.queryStockDevices()):t.$XModal.message({message:n,status:"error",zIndex:9999}),t.addLoading=!1})))},handleQuery:function(){this.currentPage=1,this.queryStockDevices()},queryStockDevices:function(){var t=this,e={offset:this.currentPage-1,count:this.pageSize,keyword:this.queryText,all:!1};this.loading=!0,Object(r["Ob"])(e).then((function(e){var a=e.devices,i=e.totalcount;t.loading=!1,t.tableList=a.map((function(t){return t.addtimeStr=c["a"].longToLocalDateTimeStr(t.addtime),t})),t.totalcount=i}))},onChangeIds:function(t){this.deviceids=t},handleSizeChange:function(t){this.pageSize=t,this.queryStockDevices()},handleCurrentChange:function(t){this.currentPage=t,this.queryStockDevices()},currentChangePage:function(t){this.queryStockDevices()}}},h=u,g=(a("66af"),a("2877")),p=Object(g["a"])(h,i,n,!1,null,"355d1a4a",null),m=p.exports;e["default"]=m},"66af":function(t,e,a){"use strict";a("a6b3")},a6b3:function(t,e,a){}}]);