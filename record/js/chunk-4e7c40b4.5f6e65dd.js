(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4e7c40b4"],{2503:function(t,e,i){},"2e3b":function(t,e,i){"use strict";i("2503")},"8a79":function(t,e,i){"use strict";var a=i("23e7"),s=i("06cf").f,c=i("50c4"),r=i("5a34"),n=i("1d80"),o=i("ab13"),d=i("c430"),l="".endsWith,u=Math.min,h=o("endsWith"),f=!d&&!h&&!!function(){var t=s(String.prototype,"endsWith");return t&&!t.writable}();a({target:"String",proto:!0,forced:!f&&!h},{endsWith:function(t){var e=String(n(this));r(t);var i=arguments.length>1?arguments[1]:void 0,a=c(e.length),s=void 0===i?a:u(c(i),a),o=String(t);return l?l.call(e,o,s):e.slice(s-o.length,s)===o}})},ad2d:function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"mileage full"},[i("div",{staticClass:"mileage-wrap full"},[i("page-frame",{attrs:{headerTitle:t.$t("record.mileageReport"),queryTime:t.queryTime,listLength:t.dataList.length,isCustomTime:"",isTime:"",showSwitch:""},on:{"select-day":t.onSelectTime}},[i("div",{staticClass:"data-list"},[0==t.dataList.length?i("div",{staticClass:"full",staticStyle:{"background-color":"#fff"}},[i("van-empty",{staticClass:"custom-image",attrs:{description:t.$t("tips.noData"),image:t.imageSrc}})],1):t._e(),t._l(t.dataList,(function(e,a){return[i("mileage-item",{key:a,attrs:{data:e},nativeOn:{click:function(i){return t.handleClick(e)}}})]}))],2)])],1),i("router-view")],1)},s=[],c=i("5530"),r=(i("8a79"),i("5319"),i("ac1f"),i("159b"),i("2f62")),n=i("b562"),o=i("c276"),d=i("5101"),l=i("d503"),u=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"record-item"},[i("div",{staticClass:"record-item-title"},[i("div",{staticClass:"item-icon"},[i("img",{attrs:{src:t.data.imgSrc}})]),i("div",{staticClass:"item-title"},[i("div",{staticClass:"item-device-name"},[i("b",[t._v(t._s(t.data.devicename))])]),i("div",{staticClass:"item-device-id",style:t.textSty},[t._v(t._s(t.$t("record.deviceId"))+": "+t._s(t.data.deviceid))])])]),i("div",{staticClass:"record-item-content"},[i("div",[i("div",{staticClass:"ellipsis",style:t.textSty},[t._v(t._s(t.$t("record.creater"))+": "+t._s(t.data.creater))]),i("div",{style:t.textSty},[t._v(t._s(t.$t("record.travelMileage"))+": "+t._s(t.data.distance)+t._s(t.distanceUnit))])])])])},h=[],f=i("ae60"),m={name:"MileageItem",components:{Icon:f["a"]},props:{data:{type:Object,default:function(){return{}}},textColor:{type:String,default:"#000000"}},computed:Object(c["a"])(Object(c["a"])({},Object(r["c"])(["distanceUnit"])),{},{textSty:function(){return{color:this.textColor}}})},v=m,g=(i("2e3b"),i("2877")),p=Object(g["a"])(v,u,h,!1,null,null,null),b=p.exports,y=b,D={name:"Mileage",components:{PageFrame:l["a"],MileageItem:y},beforeRouteUpdate:function(t,e,i){if(i(),e.path.endsWith("/search")){var a=this.$route.query.updated;1==a&&this.queryMileageRecord()}},data:function(){return{imageSrc:i("6095"),queryTime:0,dataList:[]}},methods:Object(c["a"])(Object(c["a"])({},Object(r["d"])(["setSelectedRecords"])),{},{back:function(){this.$router.push("/home")},onSelectTime:function(t){if("number"==typeof t)this.queryTime=t,this.dataList=[],this.queryMileageRecord();else{this.queryTime=t.queryTime;var e=t.startDate,i=t.endDate;if(e.indexOf("/")>-1&&(e=e.replace("/","-"),e=e.replace("/","-"),i=i.replace("/","-"),i=i.replace("/","-")),t.isQuery)if(e<=i){this.clearData();var a={begintime:e,endtime:i,offset:d["a"].getOffset()};this.queryMileageRecord(a)}else this.$toast(this.$t("tips.startDateAndEndDateTips"))}},handleClick:function(t){var e=t.records,i=t.deviceid,a=this.deviceNames[i].devicename;0==e.length?this.$toast(this.$t("tips.noDataToast")):(this.setSelectedRecords({devicename:a,deviceid:i,records:e}),this.$router.push("/mileage/mileageDetail?queryTime=".concat(this.queryTime)))},clearData:function(){this.dataList=[],this.cacheList=[]},getStartAndEndDate:function(t){var e=864e5,i=d["a"].getOffset(),a=null;if(1==t){var s=d["a"].longToDateStr(Date.now()-e,i);a={begintime:s+" 00:00:00",endtime:s+" 23:59:59"}}else{0!=t&&(t-=1);var c=d["a"].longToDateStr(Date.now(),i);a={begintime:d["a"].longToDateStr(Date.now()-e*t,i)+" 00:00:00",endtime:c+" 23:59:59"}}return a.offset=i,a},queryMileageRecord:function(t){var e=this,i=null;i=t||this.getStartAndEndDate(this.queryTime),i.deviceids=this.selectedList,i.deviceids.length>0?Object(n["j"])(i).then((function(t){var i=t.status,a=t.records;0===i&&null!=a?(e.cacheList=e.getDataList(a),e.filterData()):e.clearData(),e.$toast.clear()})).catch((function(t){e.clearData(),e.$toast(e.$t("tips.networkError"))})):this.$toast(this.$t("record.selecteDevicetip"),{duration:1e4})},filterData:function(){if(this.isShowAllData)this.dataList=this.cacheList;else{var t=[];this.cacheList.forEach((function(e){e.distance>0&&t.push(e)})),this.dataList=t}},getDataList:function(t){var e=this,i=[];return t.forEach((function(t){var a=t.deviceid,s=t.totaldistance,c=t.days,r=e.deviceNames[a],n=r.devicename,d=r.creater;c.sort((function(t,e){return e.starttime-t.starttime})),i.push({devicename:n,deviceid:a,creater:d,distance:Object(o["b"])(s),imgSrc:Object(o["h"])(e.lastPositon[a]),records:c})})),i}}),watch:{isShowAllData:function(){this.filterData()}},computed:Object(c["a"])(Object(c["a"])({},Object(r["e"])(["groups","selectedList","deviceNames","isShowAllData"])),{},{lastPositon:function(){return this.$store.state.lastPositon}}),beforeDestroy:function(){this.$toast.clear()},mounted:function(){this.queryMileageRecord()}},S=D,$=(i("d5fb"),Object(g["a"])(S,a,s,!1,null,null,null));e["default"]=$.exports},bcbc:function(t,e,i){},d5fb:function(t,e,i){"use strict";i("bcbc")}}]);